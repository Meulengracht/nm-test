2005-10-19  Robert Love  <rml@novell.com>

	* gnome/vpn-properties/nm-vpn-properties.c: Correctly set the
	  sensitivity of the buttons.  Specificaly, do the right thing if
	  there are no entries.

2005-10-19  Christopher Aillon  <caillon@redhat.com>

	* configure.in: Update check for adequate wireless-tools
	with an AC_TRY_COMPILE for the new symbols we use.

2005-10-19  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (process_scan_results): don't drop the last (or only)
			access point we see

2005-10-19  Christopher Aillon  <caillon@redhat.com>

	* src/backends/NetworkManagerSlackware.c:
	Patch from Nico <lordllucifer@gmail.com>
		- Update the Slackware backend.

2005-10-18  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/other-network-dialog.c: Use g_get_host_name ()
	if we've got GLib 2.8.0

2005-10-18  Robert Love  <rml@novell.com>

	* src/NetworkManagerDevice.c: invoke the long-in-the-tooth named
	  function nm_schedule_state_change_signal_broadcast() when we
	  deactivate a device, too.

2005-10-18  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: nmwa_context_menu_update(): 'iface' could
	  be used uninitialized.

2005-10-18  Christopher Aillon  <caillon@redhat.com>

	* test/libnm_glib_test.c: Test unregistering, too.

2005-10-17  Christopher Aillon  <caillon@redhat.com>

	* configure.in: Bump to 0.5.0

2005-10-17  Dan Williams  <dcbw@redhat.com>

	* NetworkManager.h
		- Remove WPA-related constants so they aren't part of the
			upcoming release.

2005-10-17  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c:
	* gnome/applet/applet.h:
	Desensitize the 'Connection Information' menu item when there is
	no active connection.

2005-10-17  Christopher Aillon  <caillon@redhat.com>

	* gnome/libnm_glib/libnm_glib.c:
	Make libnm_glib_unregister_callback () actually unregister the callback

2005-10-17  Robert Love  <rml@novell.com>

	* src/NetworkManagerDevice.c: Actually wait 20s, as we intend, not
	  two seconds -- tries is updated every 1/10 of a second, not every
	  second..

2005-10-17  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet-dbus-info.c:
	Let D-BUS know that we haven't handled a message when we haven't.

2005-10-17  Robert Love  <rml@novell.com>

	* src/nm-ip4-config.c: use GPOINTER_TO_UINT and not a straight cast
	  in order to remain 64-bit clean.

2005-10-17  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet-dbus-info.c:
	Find network encryption keys asynchronously

2005-10-17  Robert Love  <rml@novell.com>

	* src/backends/NetworkManagerDebian.c,
	  src/backends/NetworkManagerRedHat,
	  src/backends/NetworkManagerSuSE.c: allow '#' as a valid resolv.conf
	  comment delimiter.

2005-10-17  Robert Love  <rml@novell.com>

	* src/backends/NetworkManagerSuSE.c: use SYSCONFDIR not open-coded
	  "/etc"

2005-10-17  Christopher Aillon  <caillon@redhat.com>

	* src/NetworkManagerDevice.c: (process_scan_results)
	Fix logic that checks to see whether we have an ESSID.

2005-10-15  Dan Williams  <dcbw@redhat.com>

	Move scanning code into NetworkManager rather than use iwlib's
	iw_scan() function, so that we can figure out AP capabilities.

	* NetworkManager.h
		- Add AP capability bits

	* src/NetworkManagerAP.[ch]
		- Add capability field to NMAccessPoint structure
		- Add WPA & RSN Information Element fields and accessor
			functions to NMAccessPoint

	* src/NetworkManagerDevice.c
		- Remove usage of iw_scan
		- Add scanning code to NetworkManager rather than use
			iw_scan() from iwlib

	* src/NetworkManagerUtils.[ch]
		- (nm_dispose_scan_results): remove, unused

2005-10-14  Christopher Aillon  <caillon@redhat.com>

	* gnome/libnm_glib/libnm_glib.c:
	* gnome/libnm_glib/libnm_glib.h:
	Use guint instead of gint for callback IDs.

2005-10-12  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c:
	Fix icon animation smoothness issues.  nmwa_redraw_timeout gets called
	every 1000ms.  It will unconditionally call nmwa_update_state which
	kills the existing animation timeout and registers a new one with a
	callback to draw a new frame every 100ms.  There are 11 connecting
	icon frames, so the last 2 frames kept getting dropped.  Only reset
	the animation timeout if we aren't animating.

2005-10-11  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-devices.c
		- (nmwa_dbus_update_device_info_from_hal), (hal_net_physdev_cb):
			We want to grab the product & vendor from net.physical_dev
			rather than info.parent.

2005-10-11  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Use the driver's WE version for scanning rather than
			the WE version NM was compiled with.  Fixes random
			crashes in iw_scan () in iwlib.

2005-10-10  Dan Williams  <dcbw@redhat.com>

	* Remove nm_system_load_device_modules() from backend files
		and from NetworkManager.c

2005-10-10  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerPolicy.c
		- Fix some bugs introduced by the capabilities patch

2005-10-10  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-info.c
		- (nmi_dbus_get_network_key): hide the menu when putting up
			the keyring dialog.  (not sure if the code is right...)

2005-10-09  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss <bmoss@clemson.edu>
	* src/NetworkManagerDevice.c
		- (nm_device_set_user_key_for_network): don't try to set auth
			mode on the AP from the allowed list if it's NULL

2005-10-09  Dan Williams  <dcbw@redhat.com>

	* Replace the "driver support level" stuff with capabilities.  The
		capability field is a bitfield that is more flexible than the
		old driver support level thing.  It's mostly so we can easily
		figure out what supports WPA and what doesn't, but should be
		quite useful later.

2005-10-09  Dan Williams  <dcbw@redhat.com>

	* test/nmtest.c
		- Removed

	* test/nm-tool.c
	  test/Makefile.am
		- Added new "nm-tool" tool that gives quite a bit more
			information

2005-10-07  Robert Love  <rml@novell.com>

	* gnome/applet/applet-dbus-info.c, gnome/applet/applet.c,
	  gnome/applet/applet.h, gnome/vpn-properties/nm-vpn-properties.c,
	  src/dhcp-manager/nm-dhcp-manager.c, test/libnm_glib_test.c,
	  test/nmtest.c test/nmtestdevices.c: mark functions 'static' as
	  appropriate

2005-10-07  Robert Love  <rml@novell.com>

	* configure.in: Change our compile flags for the betterment of mankind.
	  Add "-Wstrict-prototypes" because we comply anyhow and missing a
	  prototype is very bad on 64-bit platforms as types default to int but
	  sizeof(int) != sizeof(long) and add "-Wmissing-prototypes" &
	  "-Wmissing-declarations" to warn if we define an exported function
	  but fail to put it in a header.

2005-10-07  Robert Love  <rml@novell.com>

	* src/NetworkManagerWireless.c: remove stale, unused function, who goes
	  by the name nm_update_device_wireless_timeouts() and once tried,
	  without success, to steal my pet turtle.

2005-10-07  Robert Love  <rml@novell.com>

	* Cleanup prototypes: put some functions in header files and mark
	  others as 'static' -- feel free to invert
	* src/vpn-manager/nm-dbus-vpn.c: remove prototype of
	  nm_vpn_manager_vpn_connection_list_copy()
	* src/vpn-manager/nm-vpn-act-request.c: remove prototype of
	  nm_vpn_service_get_dbus_connection()
	* src/vpn-manager/nm-vpn-manager.h: add prototypes for
	  nm_vpn_manager_vpn_connection_list_copy()
	* src/vpn-manager/nm-vpn-service.c: make
	  nm_vpn_service_act_request_failed() and
	  nm_vpn_service_stage2_daemon_wait() static
	* src/vpn-manager/nm-vpn-service.h: add prototype for
	  nm_vpn_service_get_dbus_connection()

2005-10-06  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c:
	* gnome/applet/applet.h:
	* gnome/applet/icons/Makefile.am:
	Convey information about the current connection stage in the
	icons themselves instead of creating a separate progress bar.

2005-10-04  Robert Love  <rml@novell.com>

	* src/nm-dbus-device.c: Use iw_ether_ntop(), not ether_ntoa_r(), to
	  convert an ether_addr structure's MAC into a string, because the
	  latter will drop leading zero's and uses lower-case, e.g. 7:3b:4
	  versus 07:3B:04, while the former will not.

2005-10-04  Robert Love  <rml@novell.com>

	* gnome/applet/applet-dbus-devices.c, gnome/applet/applet.c,
	  gnome/applet/nm-device.c, gnome/applet/nm-device.h,
	  gnome/applet/wireless-applet.glade, src/nm-dbus-device.c: Display
	  default route in the 'Connection Information' dialog, send primary
	  and secondary name servers in in "getProperties" DBUS method, add
	  network_device_{get,set}_{primary,secondary}_dns(),  The primary and
	  secondary domain name servers are crucial pieces of information
	  that a user might need in debugging a network problem.

2005-10-04  Robert Love  <rml@novell.com>

	* gnome/applet/applet-dbus-devices.c, gnome/applet/applet.c,
	  gnome/applet/nm-device.c, gnome/applet/nm-device.h,
	  gnome/applet/wireless-applet.glade, src/nm-dbus-device.c: Display
	  default route in the 'Connection Information' dialog, send default
	  route in "getProperties" DBUS method, add network_device_set_route(),
	  and network_device_get_route().  The Gateway is a crucial piece of
	  connection-related information that a user might need in debugging a
	  network problem.

2005-10-03  Robert Love  <rml@novell.com>

	* src/backends/NetworkManagerSuSE.c: Fix Glib error, GError must be
	  NULL.

2005-10-02  Dan Williams  <dcbw@redhat.com>

	* Shorten time taken to sleep by fastpathing bits of device deactivation
		necessary for sleep.

	* Fix issue where deactivating a device might deactivate the active
		VPN connection, even if the VPN was not using the device.

2005-10-02  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet.c
		- Adjust signal strength -> icon mapping values slightly
			(so that 51% signal doesn't show a 75% icon) by adding
			5% to the values. ex: > 5% now shows 25% icon, > 30%
			shows 50% icon, etc.

2005-09-29  Robert Love  <rml@novell.com>

	* src/NetworkManager.c: removed unused variable.

2005-09-28  Dan Williams  <dcbw@redhat.com>

	Support for named + DBus, using Red Hat DBus patches for named.  You
	can find those patches here, with "dbus" in the patch's filename:

		http://cvs.fedora.redhat.com/viewcvs/devel/bind/

	Don't forget the named dbus service file either.

	Instead of writing a config file and spawing a named process, NM will
	use an already-running dbus-enabled named if it finds one.  NM will
	update named's forwarder configuration on the fly using dbus.

	If there is no dbus-enabled named running, NM will automatically fall
	back to writing the most-recent DNS server information to /etc/resolv.conf
	and calling nm_system_update_dns() to kick the system's resolver.

	Accordingly, all named-related configure-time options have been removed.

2005-09-26  Robert Love  <rml@novell.com>

	* src/backends/NetworkManagerSuSE.c, (nm_system_get_dialup_config): Add
	  ISDN support!
	* src/backends/NetworkManagerSuSE.c, (verify_and_return_provider): Fix
	  bug in error path if "ASKPASSWORD" is "no".

2005-09-26  Robert Love  <rml@novell.com>

	* src/named-manager/nm-named-manager.c: only '#' is officially a valid
	  comment in /etc/resolv.conf -- ';' is not.

2005-09-19  Dan Williams  <dcbw@redhat.com>

	* src/backends/NetworkManagerRedHat.c:
	* src/backends/NetworkManagerDebian.c:
	* src/backends/NetworkManagerSlackware.c:
	* src/backends/NetworkManagerGentoo.c:
	* src/backends/NetworkManagerSUSE.c:
	Fix invocations of "/sbin/ip address" to use short form instead

2005-09-19  Christopher Aillon  <caillon@redhat.com>

	* src/nm-dbus-device.c: Don't assert when getting
	addresses of a not yet connected interface.

	* gnome/applet/applet.c: Free icons if loading fails.
	Use translator-credits so translators can make themselves known.

2005-09-15  Christopher Aillon  <caillon@redhat.com>

	* src/NetworkManagerAP.c:
	* src/NetworkManagerAP.h:
	* src/NetworkManagerDevice.c:
	Set a blacklist for certain common manufacturer default ESSIDs:
	APs with these ESSIDs are extremely likely to be completely
	different networks: connecting to one should not make NM
	auto-connect to every other AP with the same default ESSID.

2005-09-12  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/wireless-applet.glade:
	The passphrase entry should also activate the default

	* src/gnome-keyring-md5.c: Updated code from gnome-keyring

	* gnome/applet/applet-dbus-devices.c:
	* gnome/applet/applet.c:
	* gnome/applet/nm-device.c:
	* gnome/applet/nm-device.h:
	* src/NetworkManagerUtils.c:
	* src/NetworkManagerUtils.h:
	* src/nm-dbus-device.c:
	I've got a fever, and the only cure for it is less ioctl.
	Make NM push IP data rather than make the applet open a socket
	to the device.

2005-09-10  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c:
	* gnome/applet/applet-dbus-devices.c:
	* gnome/applet/applet-dbus-info.c:
	* gnome/applet/passphrase-dialog.c:
	* gnome/libnm_glib/libnm_glib.c:
	* gnome/vpn-properties/nm-vpn-properties.c:
	* src/autoip.c:
	* src/backends/NetworkManagerRedHat.c:
	* src/named-manager/nm-named-manager.c:
	* src/NetworkManagerAPList.c:
	* src/NetworkManager.c:
	* src/NetworkManagerDbus.c:
	* src/NetworkManagerDevice.c:
	* src/NetworkManagerPolicy.c:
	* src/NetworkManagerSystem.c:
	* src/nm-dbus-device.c:
	* src/nm-dbus-nm.c:
	* src/vpn-manager/nm-vpn-manager.c:
	* src/vpn-manager/nm-vpn-service.c:
	* test/libnm_glib_test.c:
	* test/nminfotest.c:
	* test/nmtestdevices.c:
	Fix a bunch of 'unused variable' compiler warnings

	* NetworkManager.h:
	* gnome/applet/applet-dbus-info.c:
	* gnome/applet/applet-dbus-info.h:
	* gnome/applet/applet.c:
	* gnome/applet/applet.h:
	* src/NetworkManager.c:
	* src/NetworkManagerDbus.c:
	* src/NetworkManagerDbus.h:
	* src/NetworkManagerDevice.c:
	* src/NetworkManagerDevice.h:
	* src/NetworkManagerMain.h:
	* src/NetworkManagerWireless.c:
	* src/NetworkManagerWireless.h:
	* src/nm-dbus-nm.c:
	Make NetworkManager be smart about how frequently to scan
	based on its current state.  Remove the UI for choosing when
	to scan.  Scanning still may disabled completely by the user
	via the "Wireless Enabled" menu item.

2005-09-09  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c:
	Also overlay the vpn connecting icons onto the wired icon,
	when appropriate.

	* gnome/vpn-properties/nm-vpn-properties.glade:
	Clean up a few strings to use better grammar and proper casing.

2005-09-08  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/vpn-connection.c:
	* gnome/applet/vpn-connection.h:
	Add nmwa_vpn_connection_is_activating ()

	* gnome/applet/applet.c:
	* gnome/applet/applet.h:
	* gnome/applet/icons/nm-vpn-connecting*.png:
	Add new VPN connecting icons from Diana Fong <dfong@redhat.com>, letting
	the user know something's happening between clicking the VPN item and it
	actually being connected.

2005-09-07  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet-dbus-info.c: need to free attributes in the
	failure case as well.

2005-09-07  Rodrigo Moya <rodrigo@novell.com>

	* gnome/panel/eggtrayicon.[ch]:
	* examples/python/systray/eggtrayicon.[ch]: updated code from libegg.

2005-09-07  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss <bmoss@clemson.edu>
	* src/applet-dbus.c
		- (nmwa_dbus_filter): strip whitespace from beginning
			and end of VPN login banner

2005-09-07  Dan Williams  <dcbw@redhat.com>

	* The great VPN Manager rewrite of 2005

2005-09-07  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/menu-items.c:
	* gnome/applet/nm-device.c:
	* gnome/applet/wireless-network.c:
	* gnome/libnm_glib/libnm_glib.c:
	* src/NetworkManagerDbusUtils.c:
	* vpn-daemons/vpnc/src/nm-vpnc-service.c:
	g_malloc0 doesn't return NULL

2005-09-06  Dan Williams  <dcbw@redhat.com>

	Patch from Tomislav Vujec <tvujec@redhat.com>
	* src/NetworkManagerDevice.c
		- (nm_get_device_by_udi): don't return a device when we
			actually didn't find what we were looking for

2005-09-06  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet-dbus-devices.c:
	* gnome/applet/applet-dbus-devices.h:
	* gnome/applet/applet-dbus.c:
	* src/NetworkManagerDbus.c:
	* src/NetworkManagerDbus.h:
	* src/NetworkManagerDevice.c:
	* src/nm-dbus-device.c:
	Make NM push updates about active device strength when it changes,
	rather than having the applet poll every 2s.

2005-09-05  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet-dbus-devices.c: Remove duplicate call to
	network_device_set_strength

2005-09-04  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Nottingham <notting@redhat.com>
	* src/NetworkManagerDevice.c
		- (nm_device_activation_cancel): reset the quit_activation flag

2005-09-04  Dan Williams  <dcbw@redhat.com>

	* src/nm-activation-request.c
		- (nm_act_request_unref): actually free the structure,
			which we didn't seem to be doing before

2005-09-04  Dan Williams  <dcbw@redhat.com>

	Patch from John Palmieri <johnp@redhat.com>
	* gnome/applet/applet-dbus-devices.c
		- Fix up unreffing of DBusMessage objects

2005-09-04  Dan Williams  <dcbw@redhat.com>

	Patch from John Palmieri <johnp@redhat.com>
	* gnome/applet/nm-device.c
		- (nm_device_unref): clear network_device's memory _before_ freeing it

2005-09-02  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c: Use a check menu item for Wireless Enabled

2005-09-02  Bill Nottingham  <notting@redhat.com>

	* src/backends/NetworkManagerRedHat.c: use nm_warning, not nm_error

2005-09-01  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManager.c
		- (nm_remove_device_from_list): rename to nm_remove_device
		- (nm_hal_device_removed): call nm_remove_device()

	* src/NetworkManagerDevice.c
		- Change the NMWirelessScanCB member 'reschedule' which
			wasn't used to 'force' to indicate that we need to
			force a scan when adding a device

	* src/nm-dbus-nm.c
		- (nm_dbus_nm_sleep): Deactivate all devices and remove them
			from the device list
		- (nm_dbus_nm_wake): Re-add all devices to the device list

2005-09-01  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: nmwa_update_info: iface is used uninitialized
	  and the check "!iface" in the error case is probably never true.

2005-09-01  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Nottingham <notting@redhat.com>
	* src/backends/NetworkManagerRedHat.c
		- Add initial dialup support to Red Hat/Fedora backend

2005-09-01  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-devices.c
		- Sort both wireless networks and devices again, which got
			broken when removing threading

2005-09-01  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c:
	Only show the "Stop/Start All Wireless Devices" menuitem
	if we actually have wireless devices.

	* gnome/applet/applet-dbus-info.c:
	* gnome/applet/applet.c:
	* gnome/applet/other-network-dialog.c:
	* gnome/applet/vpn-password-dialog.c:
	Drop the gtk_dialog_run () calls in favor of connecting to
	"response" signals, needed now that the applet is not threaded.

2005-08-31  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss <bmoss@clemson.edu>
	* src/NetworkManagerDevice.c
		- (nm_device_wireless_scan): fix scan timeout values

2005-08-30  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/wireless-applet.glade
		- HIG-ify the Other Wireless Networks dialog a bit more
		- Fix some potential segfaults in the info dialog

2005-08-30  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-devices.c
		- Remove nmwa_dbus_get_hal_device_string_property(); unused

2005-08-30  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus.[ch]
		- Remove all the nmwa_dbus_call_method_xxxx functions since
			they weren't being used anyway

2005-08-30  Bastien Nocera  <hadess@hadess.net>

	* test/nmtestdevices.c: (print_usage), (main):
	Check the number of arguments, and fix a typo

2005-08-29  Dan Williams  <dcbw@redhat.com>

	Patch from Dumitru Ciobarcianu <Dumitru.Ciobarcianu@iNES.RO>
	* gnome/applet/applet.c
		- Define GTK_STOCK_INFO for GTK 2.6 and lower

2005-08-29  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/*
		- Don't use threads any more.  Anything that blocks
			(like gtk_dialog_run()) will  have to get fixed up which
			should happen quickly.  We really only had threads to make
			the animation smooth, and when everything got converted over
			to DBus Pending Calls, the need for threads kind of went away

2005-08-29  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c: Draw VPN connections as radio items
	since we don't yet support multiple VPNs.
	* gnome/applet/other-network-dialog.c: Use stock icon for Connect
	* gnome/vpn-properties/nm-vpn-properties.c: Use stock icon for Delete

2005-08-29  Dan Williams  <dcbw@redhat.com>

	Patch from j@bootlab.org
	- Make --without-named work
	- Make --with-dhcdbd work correctly

2005-08-27  Josep Puigdemont i Casamajó  <josep.puigdemont@gmail.com>

	* configure.in: Added "ca" to ALL_LINGUAS.

2005-08-26  Christopher Aillon  <caillon@redhat.com>

	* Fix up VPN state handling between the applet and NetworkManager,
		so that the applet doesn't show a VPN as connected when one
		really is not
			- The applet no longer has a pointer to the active VPN's
				name, but tracks each VPNs state individually
			- NM no longer has a "getActiveVPNConnection" method
			- NM no longer broadcasts the "VPNConnectionChange" signal
			- NM now broadcasts a "VPNConnectionStateChange" signal
				whenever the state of a VPN changes

2005-08-26  Dan Williams <dcbw@redhat.com>

	* gnome/applet/applet-dbus-devices.c
	  gnome/applet/applet-dbus-vpn.c
		- Remove calls to dbus_pending_call_ref() because we already
			"own" the pending call
		- Remove calls to dbus_pending_call_get_completed() because
			when we are in the callback, the pending call is completed
			by definition

2005-08-22  Dan Williams <dcbw@redhat.com>

	Patch by Bill Moss <bmoss@clemson.edu>
	* src/dhcp-manager/nm-dhcp-manager.c
		- (nm_dhcp_manager_cancel_transaction): Give dhcdbd/dhclient
			some time to send out a RELEASE if they like

2005-08-22  Dan Williams <dcbw@redhat.com>

	Noticed by Bill Moss <bmoss@clemson.edu>
	* src/NetworkManagerDbus.c
		- (nm_dbus_get_user_key_for_network_cb): deactivate the device
			instead of just cancelling its activation

	* src/NetworkManagerDevice.c
		- (nm_device_deactivate): some small cleanups
		- (nm_device_set_user_key_for_network): deactivate the device
			instead of just cancelling its activation

2005-08-22  Dan Williams <dcbw@redhat.com>

	Noticed by Bill Moss <bmoss@clemson.edu>
	* src/NetworkManagerDevice.c
		- (nm_device_wireless_scan): fix scan timeout, we were
			waiting way too long for scans to complete

2005-08-22  Dan Williams <dcbw@redhat.com>

	Patch from j@bootlab.org:
	* src/backends/NetworkManagerDebian.c
		- Make the Debian backend work for static IP again

2005-08-20  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/other-network-dialog.c:
	The "Create New Network" and "Connect to Other Network"
	dialogs share alot of code, but shouldn't share a window
	title.  Give them different ones.

	* gnome/applet/wireless-applet.glade:
	* vpn-daemons/vpnc/auth-dialog/gnome-two-password-dialog.c:
	Some more minor UI tweaks.

2005-08-19  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/other-network-dialog.c:
	* gnome/applet/wireless-applet.glade:
	Also need mnemonic widgets, and underline enabled.

2005-08-19  Dan Williams <dcbw@redhat.com>

	* vpn-daemons/vpnc/nm-vpnc-service.c
		- (vpnc_watch_cb): remove no-longer-relevant comment
		- (write_config_option): new function, helper to write
			config options to vpnc's stdin
		- (nm_vpnc_config_write): use the new helper, make the
			code shorter

2005-08-19  Christopher Aillon <caillon@redhat.com>

	* gnome/applet/passphrase-dialog.c:
	* gnome/applet/wireless-applet.glade:
	Make the passphrase dialog response based, and treat
	responses other than OK (such as Esc, [X]) as a cancel.

2005-08-18  Christopher Aillon <caillon@redhat.com>

	* initscript/Gentoo/NetworkManager:
	* initscript/RedHat/NetworkManager:
	* initscript/RedHat/NetworkManagerDispatcher:
	* initscript/SUSE/networkmanager:
	CVS remove these in place of .in replacements

	* configure.in:
	* initscript/Gentoo/NetworkManager.in:
	* initscript/RedHat/NetworkManager.in:
	* initscript/RedHat/NetworkManagerDispatcher.in:
	* initscript/SUSE/networkmanager.in:
	These scripts now are generated so they work still when
	NM is built using a bindir other than /usr/bin

2005-08-18  Dan Williams <dcbw@redhat.com>

	* gnome/applet/main.c
		- Revert previous change for --no-session since
			--sm-disable does the same thing

2005-08-18  Dan Williams <dcbw@redhat.com>

	* gnome/applet/applet-dbus-info.c
		- (nmi_dbus_create_error_message): new function
		- (nmi_dbus_get_key_for_network): correctly use dbus error creation
			functions.  Also don't check for both device _and_ network before
			asking for a user's key, because we may not have gotten all our
			networks back from NM quite yet (due to the dbus pending calls
			coming in later).  Fixes a hang in NM/nm-applet.

	* src/NetworkManagerDbus.c
		- (nm_dbus_get_user_key_for_network_cb): handle error conditions in a
			slightly more sane manner, even though we are still broken for
			certain other error conditions.
		- (nm_dbus_get_user_key_for_network): need to pass the network's essid
			to the info-daemon too

	* src/NetworkManagerDevice.c
		- Fix some debug messages to be info messages instead

2005-08-18  Dan Williams <dcbw@redhat.com>

	* gnome/applet/main.c
		- Add new "--no-session" parameter that disables applet
			session management, ie for testing

2005-08-18  Christopher Aillon <caillon@redhat.com>

	* gnome/applet/other-network-dialog.c:
	* gnome/applet/wireless-applet.glade: More mnemonics

2005-08-17  Robert Love  <rml@novell.com>

	* initscript/SUSE/networkmanager: update

2005-08-17  Dan Williams  <dcbw@redhat.com>

	* Tag NM_0_4_1_RELEASE

2005-08-17  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c: More translatable string cleanup


2005-08-17  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-info.c
		- (nmi_dbus_get_key_for_network): Grab new "new_key" parameter
			from the dbus message, which tells us to unconditionally
			ask the user for a new key.  Otherwise, we pull the key from
			the keyring and return it.  If we fail to get the key from the
			keyring, we ask the user for a new key.
		- (nmi_dbus_get_network_key): new function to grab the key for
			an essid from the keyring.
		- (nmi_dbus_get_network_properties): don't access the keyring here.
			Also, don't return any key in the dbus message.

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_get_user_key_for_network): Add "new_key" parameter to
			indicate that we unconditionally want a new key.  This function
			is now also used to get keys from the info-daemon which are
			pre-stored, not just for asking the user for a new key.  The
			"new_key" parameter indicates whether or not we wish to ask the
			user for a new key.
		- (nm_dbus_get_network_data_cb): we no longer get a key from the
			info-daemon in the return message, so use NULL instead.  The
			key will be filled in at connect time by calling
			nm_dbus_get_user_key_for_network()

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_configure): update for "new_key" param to
			nm_dbus_get_user_key_for_network().  We initially set new_key
			to FALSE to see if we have a stored key in the info-daemon, but
			if the connection is unsuccessful at this stage we request a
			new one

2005-08-17  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/icons/nm-no-connection.png
	  gnome/applet/icons/nm-device-wired.png
		- Use Diana's new RJ45 connector icons

2005-08-17  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerPolicy.c
		- (nm_policy_device_change_check): clarify switching rules if
			both new and old devices are valid; mainly, don't switch
			away from user-requested wireless connection back to a wired
			one

2005-08-17  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/Makefile.am
		- Relocate the applet to /usr/bin since it is no longer
			executed by anything, but directly by the user

2005-08-17  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss <bmoss@clemson.edu>

	* gnome/applet/applet-dbus-info.[ch]
		- (nmi_save_network_info): save timestamp for network if it
			was a change requested by the user
		- (nmi_dbus_update_network_info): get user_requested from dbus
			message and pass to nmi_save_network_info()

	* gnome/applet/applet.c
		- (nmwa_update_network_timestamp): remove
		- (nmwa_menu_item_activate): don't set timestamp on networks
			here, only after a successful connect in nmi_save_network_info()

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_update_network_info): pass user_requested into the 
			dbus message

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): pass user_requested to
			nm_dbus_update_network_info()

2005-08-16  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: Better "Dial Up" menu item.

2005-08-16  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: use GTK_STOCK_INFO not PROPERTIES for the
	  "Connection Information" menu item.

2005-08-16  Dan Williams  <dcbw@redhat.com>

	Patch from j@bootlab.org
	* vpn-daemons/vpnc/Makefile.am: Fix for autoreconf

	* configure.in: allow specifying the path to dhcdbd

2005-08-16  Robert Love  <rml@novell.com>

	Patch from j@bootlab.org
	* src/backends/NetworkManagerDebian.c, src/backends/interface_parser.c,
	  src/backends/interface_parser.h: Debian dialup support.

2005-08-16  Christopher Aillon  <caillon@redhat.com>

	* vpn-daemons/vpnc/properties/nm-vpnc-dialog.glade:
	* gnome/applet/applet.c: Add some mnemonics for VPNC

	* vpn-daemons/.cvsignore: fix this up a little bit

2005-08-16  Robert Love  <rml@novell.com>

	* src/backends/NetworkManagerSuSE.c: improve the SUSE-backend dial up
	  support.

2005-08-16  Christopher Aillon  <caillon@redhat.com>

	* gnome/applet/applet.c: Split markup out of translatable strings
	and clean up logic a little bit.  (fixes #309012)

2005-08-15  Christopher Aillon  <caillon@redhat.com>

	* gnome/vpn-properties/nm-vpn-properties.c:
	* gnome/vpn-properties/nm-vpn-ui-interface.h:
	* vpn-daemons/vpnc/properties/nm-vpnc.c:
	Makeshift fix to remove newlines from translatable strings.
	Note that we now return an allocated string, so callers of
	get_confirmation_details () must now call g_free () on the
	result. (fixes #309033).

2005-08-12  Robert Love  <rml@novell.com>

	* gnome/applet/applet-dbus.c: remove newlines from translatable
	  strings--not needed here anyway. (fix b.g.o #309011)
	* src/nm-netlink.monitor.c: don't translate "%s" (fix b.g.o #172391)

2005-08-11  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: mark string as translatable.

2005-08-11  Robert Love  <rml@novell.com>

	* initscript/SUSE/networkmanager: update.

2005-08-11  Dan Williams  <dcbw@redhat.com>

	* src/nm-dhcp-manager.c
		- (nm_dhcp_manager_get_ip4_config): if for some reason we don't get
			an gateway returned from DHCP, try to use the address of the DHCP
			server as the gateway instead.  Found by Ralf Ertzinger.

2005-08-10  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: Make applet->dbus_thread joinable so we can
	  wait for it on exit; call exit() in nmwa_destroy() to jump ship.

2005-08-10  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss <bmoss@clemson.edu>
	* Consolidate writes of access point information updates to the info daemon
		so that we only do it when the connection to the access point was
		successful.  Also consolidates updates to GConf in the Gnome applet.

	* src/nm-netlink-monitor.c
		- Silence compile warning when calling g_object_new()

2005-08-08  Dan Williams  <dcbw@redhat.com>

	Patch from Steev <steev@steev.net>:
	* src/backends/NetworkManagerGentoo.c
		- Stub new dialup backend functions

2005-08-08  Dan Williams  <dcbw@redhat.com>

	Patch from Colin Slater:
	* src/backends/NetworkManagerGentoo.c
		- (nm_system_update_dns): Fix exit status check for restarting
			nscd

2005-08-05  Robert Love  <rml@novell.com>

	* NetworkManager.h,
	  gnome/applet/applet-dbus-devices.c,
	  gnome/applet/applet-dbus-devices.h,
	  gnome/applet/applet-dbus.c,
	  gnome/applet/applet.c,
	  gnome/applet/applet.h,
	  src/NetworkManager.c,
	  src/NetworkManagerMain.h,
	  src/NetworkManagerSystem.h,
	  src/backends/NetworkManagerRedHat.c,
	  src/backends/NetworkManagerSuSE.c,
	  src/nm-dbus-nm.c: basic dialup support using distro infrastructure

2005-08-05  Robert Love  <rml@novell.com>

	* gnome/applet/other-network-dialog.c: default the adhoc network to the
	  machine's hostname to make adhoc creation idiot-proof.

2005-08-04  Robert Love  <rml@novell.com>

	* gnome/applet/other-network-dialog.c: fix leak. "label" needs to be
	  freed.

2005-08-04  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-info.c
	  gnome/applet/applet-dbus-info.h
		- (nmi_dbus_update_network_auth_method->nmi_save_network_info): generalize
			to store key, key type, and auth method rather than just auth method
		- (nmi_dbus_update_network_info): new function
		- (nmi_dbus_info_message_handler): updateNetworkAuthMethod -> updateNetworkInfo

	* gnome/applet/passphrase-dialog.c
		- (nmi_passphrase_dialog_ok_clicked): call nmi_save_network_info() instead
			of saving the info ourselves

	* gnome/libnm_glib/libnm_glib.c
		- Remove the stupid version check for dbus

	* src/NetworkManagerAP.c
	  src/NetworkManagerAP.h
		- (nm_ap_get_enc_key_source): return 'const char *' rather than 'char *'

	* src/NetworkManagerDbus.c
	  src/NetworkManagerDbus.h
		- (nm_dbus_update_network_auth_method -> nm_dbus_update_network_info): Update
			more than just the auth method

	* src/NetworkManagerDevice.c
		- Update network info at the appropriate times

2005-07-29  Ray Strode  <rstrode@redhat.com>

	* src/NetworkManager.c (nm_info_handler): don't use input as format
	string (Spotted by Ian Jackson).

2005-07-27  Dan Williams  <dcbw@redhat.com>

	* src/nm-dbus-nm.c
	  src/nm-dbus-net.c
		- Random cleanups of spacing

	* gnome/applet/applet.h
	  gnome/applet/other-network-dialog.c
	  gnome/applet/passphrase-dialog.c
		- Conslidate usage of NMWAEncryptionKeyTypes enum

	Patch from Bill Moss:
		- Make Other Wireless Networks work again with encryption keys

2005-07-26  Dan Williams  <dcbw@redhat.com>

	Patch from Steev <steev@steev.net>:
	* src/backends/NetworkManagerGentoo.c
	  src/backends/Makefile.am
		- Fix up Gentoo backend

2005-07-26  Robert Love  <rml@novell.com>

	* src/backends/NetworkManagerSuSE.c: misc. cleanup

2005-07-25  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: make the "Wired" menu item a radio button,
	  in the same group as the wireless networks, since they are all
	  mutually exclusive.

2005-07-24  Ray Strode  <rstrode@redhat.com>

	* src/nm-netlink-monitor.c (nm_netlink_monitor_new): 
	remove unneeded NULL arg from g_object_new().  Any
	warnings caused by not having the extra NULL are just a
	result of a bug in glib 2.7.0 - 2.7.2.

2005-07-22  Robert Love  <rml@novell.com>

	* gnome/libnm_glib/libnm_glib.c: support D-BUS version 0.35, too

2005-07-22  Robert Love  <rml@novell.com>

	* src/nm-netlink-monitor.c: g_object_new() needs at least three
	  parameters (gcc 4.0.2 warning fix).

2005-07-18  Robert Love  <rml@novell.com>

	Suggested by Aaron Bockover (abockover@novell.com)
	* gnome/applet/other-network-dialog.c: ASCII is an acronym, thus
	  s/Ascii/ASCII
	* gnome/applet/passphrase-dialog.c: ditto
	* gnome/applet/wireless-applet.glade: ditto

2005-07-13  Dan Williams  <dcbw@redhat.com>

	Patch from Ray Strode <halfline@gmail.com>
	* vpn-daemons/vpnc/nm-vpnc-service.c
		- Don't let vpnc daemonize, fixes some races with PID file reading

2005-07-13  Dan Williams  <dcbw@redhat.com>

	Patch from Ray Strode <halfline@gmail.com>
	* Random cleanups for strict CFLAGS

2005-07-07  Dan Williams  <dcbw@redhat.com>

	Patch from Derek Atkins <warlord@MIT.EDU>
	* src/nm-dbus-net.c:
		- (nm_dbus_get_ap_from_object_path): differentiate similar ESSIDs

2005-07-07  Dan Williams  <dcbw@redhat.com>

	Patch from Jos Dehaes <jos_dehaes@fastmail.fm>
	* src/backends/NetworkManagerGentoo.c
		- Gentoo backend Static IP nameserver fixes
		- General Gentoo backend goodness

2005-07-07  Dan Williams  <dcbw@redhat.com>

	Patch from Bastien Nocera:
	* gnome/applet/applet.c
		- Fix up error reporting when icons or glade files are missing

2005-07-07  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: do not draw the VPN menu's seperator if there
	  are not any VPN connections above it.

2005-07-07  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: whoops, left some "dog" debugging code in.

2005-07-05  Robert Love  <rml@novell.com>

	* src/NetworkManagerSystem.c: bail out if asked to set a gateway of
	  zero.

2005-07-05  Robert Love  <rml@novell.com>

	* src/NetworkManagerDevice.c: use link-local (autoip) on DHCP failure
	  on wired or unencrypted wireless.

2005-07-01  Robert Love  <rml@novell.com>

	* src/NetworkManagerSystem.c: Print the error via strerror().

2005-06-30  Robert Love  <rml@novell.com>

	* gnome/vpn-properties/nm-vpn-properties.c: display an error dialog and
	  then exit if the glade file is not found.  currently the application
	  just hangs.

2005-06-30  Robert Love  <rml@novell.com>

	* src/nm-dbus-nm.c: Patch by Bill Moss <bmoss@clemson.edu> to
	  explicitly up all interfaces on wake from sleep.

2005-06-30  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: Add right-click menu item "Connection Info"
	  with information about the currently active connection.
	* gnome/applet/applet.h: (ditto)
	* gnome/applet/wireless-applet.glade: (ditto), new file

2005-06-30  Robert Love  <rml@novell.com>

	* src/NetworkManagerDevice.c: g_malloc0 cannot fail.
	* src/nm-dbus-nm.c: print when we sleep and wake up.
	* gnome/applet/menu-items.c: whitespace, misc. cleanup.
	* configure.in: look in "/usr/sbin" for dhcdbd, too. (it shouldn't be
	  in /sbin unless D-BUS is, folks).
	* README: update to reflect nm-applet replacing NetworkManagerInfo.

2005-06-27  Robert Love  <rml@novell.com>

	* src/nm-dbus-nm.c: fix "setWirelessEnabled" call for the enabling
	  case.

2005-06-27  Robert Love  <rml@novell.com>

	* gnome/applet/applet.c: make the 'Wireless Network Discovery' menu
	  items radios.

2005-06-26  Robert Love  <rml@novell.com>

	* src/NetworkManagerDevice.c: be specific about which device in
	  nm_info() message.

2005-06-23  Adam Weinberger  <adamw@gnome.org>

	* src/nm-netlink-monitor.c: correct spelling error.

2005-06-23  Robert Love  <rml@novell.com>

	* gnome/applet/applet-dbus-info.c: gnome keyring support!
	* gnome/applet/passphrase-dialog.c: more of that keyring!

2005-06-23  Robert Love  <rml@novell.com>

	* configure.in: remove extraneous GNOMEKEYRING directives.
	* gnome/applet/Makefile.am: s/GNOMEKEYRING/GNOME_KEYRING/.
	* gnome/applet/applet.c: nmwa_icons_init: make style local.
	* gnome/applet/passphrase-dialog.c: whitespace.

2005-06-23  Robert Love  <rml@novell.com>

	* src/NetworkManagerDevice.c: division in assignment was flipped.

2005-06-23  David Zeuthen  <david@fubar.dk>

	* gnome/applet/vpn-password-dialog.c (child_stdout_data_cb): Send a
	signal to the child to indicate that we got what we wanted when we
	see two new-lines right after each other.
	(nmwa_vpn_request_password): Pass a structure with several members
	instead of just the passwords

2005-06-23  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
	  src/NetworkManagerMain.h
		- (nm_get_hal_ctx): new function, move Hal initialization code here
		- (nm_hal_init): new function, init libhal context then add devices
		- (nm_hal_deinit): new function, clean up libhal context
		- (nm_data_free): Move Hal cleanup here
		- (main): check whether Hal is running, and if so, get a list of
			network devices from it

	* src/NetworkManagerDbus.c
		- (nm_dbus_signal_filter): trap NameOwnerChanged signals for Hal,
			and when it appears, get a list of network devices from it.  If
			Hal goes away, clean up the libhal context

2005-06-22  Robert Love  <rml@novell.com>

	* dispatcher-daemon/NetworkManagerDispatcher.c: fix FIXME: check
	  permissions of scripts before executing.

2005-06-21  Robert Love  <rml@novell.com>

	* initscript/SUSE/networkmanager: update.
	* src/backends/NetworkManagerSuSE.c: cleanup.

2005-06-21  Robert Love <rml@novell.com>

	* gnome/applet/applet.c: use menu mnemonics.
	* gnome/applet/menu-items.c: (ditto)

2005-06-21  Robert Love  <rml@novell.com>

	* applet/applet-dbus-devices.c: mark non-static functions static.
	* applet/applet-dbus-vpn.c: (ditto)
	* applet/applet.c: (ditto)
	* applet/nm-device.h: (ditto)
	* applet/other-network-dialog.c: (ditto)
	* applet/passphrase-dialog.c: (ditto)
	* NetworkManager.c: (ditto)
	* NetworkManagerDbus.c: (ditto)
	* NetworkManagerDevice.c: (ditto)
	* NetworkManagerPolicy.c: (ditto)
	* NetworkManagerUtils.c: (ditto)
	* NetworkManagerWireless.c: (ditto)
	* NetworkManagerWireless.h: (ditto)
	* nm-netlink-monitor.c: (ditto)
	* applet/applet-dbus-info.c: (ditto), add FIXME's.
	* vpn-manager/nm-dbus-vpn.c: (ditto), remove shadowed variable.
	* autoip.c: include autoip.h.
	* autoip.h: new file.  define get_autoip().
	* nm-netlink-monitor.h: define nm_netlink_close_connection().
	* NetworkManagerDbus.h: remove duplicate definitions.

2005-06-20  Robert Love  <rml@novell.com>

	* Makefile.am: Add missing intltool-foo.in generated files to
	  EXTRA_DIST so that 'distcheck' works.  Also add DISTCLEANFILES
	  with the start of stuff to cleanup on 'distclea'.
	* configure.in: add AC_PROG_INTLTOOL macro so that we do the intltool
	  stuff right and 'distcheck' works.
	* po/POTFILES.in: Remove examples/python/systray/eggtrayicon.c.  If
	  we keep it, we need to add all of examples/* to EXTRA_DIST and do
	  Makefile.am for each.  And systray/Makefile needs to be redone.

2005-06-19  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
	- (nm_device_wireless_process_scan_results): scan every 20s when
	  disconnected and scanning is ALWAYS_SCAN or WHEN_UNASSOCIATED

2005-06-19  Dan Williams <dcbw@redhat.com>

	* WEXT_DEBUG->IOCTL_DEBUG, extend checking to all ioctl() calls

2005-06-18  Ray Strode <rstrode@redhat.com>

	* src/nm-netlink-monitor.c 
	(nm_netlink_monitor_event_handler): check for the presence
	of either error condition not both. 
	
	(nm_netlink_monitor_error_handler): emit error signal if
	error occurs.

	(nm_netlink_monitor_event_handler),
	(nm_netlink_monitor_error_handler),
	(nm_netlink_monitor_disconnect_handler): if an 
	assertion fails disconnect the event handler to prevent 
	infinite loops.

	* src/nm-netlink-monitor.h: add new error condition
	NM_NETLINK_MONITOR_ERROR_WAITING_FOR_SOCKET_DATA

2005-06-18  Ray Strode <rstrode@redhat.com>

	* src/nm-netlink-monitor.c 
	(nm_netlink_monitor_event_handler): remove bogus < 0
	check on unsigned value and return early if the kernel
	didn't send any bytes.

2005-06-17  Robert Love  <rml@novell.com>

	* initscript/SUSE/networkmanager: Change the Provides and default
	run levels

2005-06-16  Dan Williams <dcbw@redhat.com>

	Patch from Robert Love:
	* gnome/applet/applet.c
		- Beautify some applet menu item names

2005-06-17  David Zeuthen  <davidz@redhat.com>

	* gnome/vpn-properties/nm-vpn-ui-interface.h: Require users of this
	API to define NM_VPN_API_SUBJECT_TO_CHANGE to acknowledge API churn.
	Also add new methods can_export, import_file and export.

	* gnome/vpn-properties/nm-vpn-properties.glade: Add an Export button
	to the main UI

	* gnome/vpn-properties/nm-vpn-properties.c:
	Define NM_VPN_API_SUBJECT_TO_CHANGE so we can actually include
	nm-vpn-ui-interface.h.
	(update_edit_del_sensitivity): Also update "Export" sensitivity
	(add_vpn_connection): Also add new SVC_NAME column
	(import_settings): New function
	(retrieve_data_from_selected_connection): New function
	(edit_cb): Use retrieve_data_from_selected_connection to simplify
	this function
	(export_cb): New function
	(init_app): Also setup the "export" widget
	(main): Support the --import-service and --import-file commandline
	arguments

	* gnome/libnm_glib/libnm_glib.c (libnm_glib_dbus_filter): Also support
	D-BUS 0.34

2005-06-16  Dan Williams <dcbw@redhat.com>

	Patch from Robert Love:
	* gnome/applet/menu-items.c
		- (network_menu_item_new): pass -1 as wireless network
			menu items height size request rather than ascent / 2

2005-06-16  Dan Williams <dcbw@redhat.com>

	* Clean up wording in Wireless Scan Methods menu items and constants

2005-06-16  Robert Love  <rml@novell.com>

	* po/POTFILES.in
		- remove gtkcell* files

2005-06-15  Dan Williams <dcbw@redhat.com>

	Patch from Robert Love: make the applet stetic

	* gnome/applet/Makefile.am
		- Don't compile the gtkcellview and gtkcellrendererprogress files

	* gnome/applet/gtkcellview.h
	  gnome/applet/gtkcellview.c
	  gnome/applet/gtkcellrendererprogress.h
	  gnome/applet/gtkcellrendererprogress.c
		- Removed

	* gnome/applet/menu-items.c
		- Progress bars are 5:1 size ratio
		- Use GTK progress bars rather than internal ones

2005-06-15  Dan Williams <dcbw@redhat.com>

	Patch from Robert Love:
	* initscript/SUSE/networkmanager
		- Fix typo

2005-06-15  Dan Williams <dcbw@redhat.com>

	* src/backends/NetworkManagerSuSE.c
	  src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerDebian.c
		- (set_ip4_config_from_resolv_conf): Fix typo I made, '==' -> '='

2005-06-15  Dan Williams <dcbw@redhat.com>

	* src/backends/NetworkManagerDebian.c
		- Add nm_system_device_get_use_dhcp() to debian backend

	Patch from Kay Sievers:
	* src/backends/NetworkManagerSuSE.c
		- Update debian backend for static IP nameservers

	* src/NetworkManagerDevice.c
		- Actually set the device to use static IP or DHCP rather
			than always DHCP

2005-06-15  Dan Williams <dcbw@redhat.com>

	Patch from Thom May:
	* src/backends/NetworkManagerDebian.c
		- Update debian backend for static IP nameservers

2005-06-15  Dan Williams <dcbw@redhat.com>

	Patches from Robert Love:
	* gnome/applet/wireless-applet.glade
		- Tighten up wording

	* src/NetworkManagerDevice.c
		- Remove misplaced ';'

	* configure.in
	  initscript/Makefile.am
	  initscript/SUSE/Makefile.am
	  initscript/SUSE/networkmanager
		- Add SUSE initscript

2005-06-12  David Zeuthen  <davidz@redhat.com>

	* gnome/vpn-properties/nm-vpn-ui-interface.h: New file

	* gnome/vpn-properties/nm-vpn-properties.glade: New file

	* gnome/vpn-properties/nm-vpn-properties.c: New file

	* gnome/vpn-properties/Makefile.am: New file

	* src/vpn-manager/nm-vpn-manager.h: Rework prototypes to take an
	array of passwords

	* src/vpn-manager/nm-vpn-manager.c
	(nm_vpn_manager_activate_vpn_connection): Take an array of passwords
	instead of just a single one

	* src/vpn-manager/nm-dbus-vpn.c:
	(nm_dbus_vpn_get_vpn_connection_properties): Also append service_name
	here
	(nm_dbus_vpn_activate_connection): Rework to take an array of passwords

	* gnome/applet/vpn-password-dialog.h (nmwa_vpn_request_password): 
	Change the interface here to give a list of passwords. Also, don't
	require username, but do require service

	* gnome/applet/vpn-password-dialog.c: Look up the VPN .name files for
	the binary for the auth-dialog and use that instead of putting up a
	dialog asking for a single password

	* gnome/applet/vpn-connection.[ch]: Don't remember the user_name,
	however do remember the service

	* gnome/applet/main.c (main): Setup i18n

	* gnome/applet/applet.c (nmwa_update_state): Add a line "VPN
	connection to '%s'" to the tooltip if we are connected using VPN
	(nmwa_menu_vpn_item_activate): Check last_attempt_success gconf
	key to determine whether we the auth-dialog needs to
	reprompt. Also cope with the fact that the auth-dialog now returns
	an array of passwords.
	(nmwa_menu_configure_vpn_item_activate): New handler for
	"Configure VPN..." menu item
	(nmwa_menu_add_vpn_menu): Add the "Configure VPN..." menu item
	(is_vpn_available): New function to determine if we got any
	NM-compatible VPN software installed
	(nmwa_menu_add_devices): Use is_vpn_available to add VPN menu
	items only if we have NM-compatible VPN software installed
	(nmwa_gconf_vpn_connections_notify_callback): Slightly rework the
	logic for detecting when VPN connections are removed

	* gnome/applet/applet-dbus.h: Removed the prototypes for 
	nmwa_dbus_vpn_activate_connection, nmwa_dbus_vpn_deactivate_connection
	since these are defined elsewhere

	* gnome/applet/applet-dbus.c (set_vpn_last_attempt_status): New
	function used to keep track of whether the last attempt succeded
	(nmwa_dbus_filter): Update last_attempt according to whether the
	VPN connection could be established or not

	* gnome/applet/applet-dbus-vpn.h (nmwa_dbus_vpn_deactivate_connection): 
	Change prototype to take an array of passwords, not just a single
	password

	* gnome/applet/applet-dbus-vpn.c (nmwa_dbus_vpn_properties_cb): Only
	update service, not user
	(nmwa_dbus_vpn_remove_one_vpn_connection): Check that applet->
	dbus_active_vpn_name is not NULL before using it
	(nmwa_dbus_vpn_activate_connection): Send the passwords as a
	string array instead of assuming a single password

	* gnome/applet/applet-dbus-info.c:
	(nmi_dbus_get_vpn_connection_properties): Use the logged in user for
	user name; don't read from gconf

	* gnome/applet/Makefile.am: Also export SYSCONFDIR and 
	VPN_NAME_FILES_DIR

	* gnome/Makefile.am (SUBDIRS): Add vpn-properties

	* configure.in: Add checks for gmodule-2.0.
	Generate gnome/vpn-properties/Makefile. Don't generate any Makefile's
	in vpn-daemons nor vpn-daemons/vpnc. We have separate autotooled
	projects under vpn-daemons now.	 See vpn-daemons/vpnc/Changelog
	for details

	* vpn-daemons/Makefile.am: Removed

	* vpn-daemons/README: New file to describe extensions points for VPN
	software

2005-06-10  Dan Williams <dcbw@redhat.com>

	* src/backends/NetworkManagerRedHat.c
		- (get_current_profile_name): new function, grab current network profile name from
			/etc/sysconfig/network
		- (set_ip4_config_from_resolv_conf): new function, parse a resolv.conf and
			update an IP4 Config structure's settings from it
		- (nm_system_device_get_system_config): if we're using static IP on this device,
			get DNS info from current network profile

2005-06-09  Dan Williams <dcbw@redhat.com>

	Patch from Robert Love:
	* src/NetworkManagerDevice.c
	  src/NetworkManagerUtils.c
		- 64-bit build fixes

2005-06-09  Dan Williams <dcbw@redhat.com>

	Patch from Kay Sievers and Robert Love:
	* configure.in
	  src/backends/Makefile.am
	  src/backends/NetworkManagerSuSE.c
		- Add SuSE support

2005-06-09  Dan Williams <dcbw@redhat.com>

	* NetworkManager.h
		- Add NMWirelessScanMethod enum for scan methods

	* gnome/applet/applet-dbus-devices.c
		- (nmwa_dbus_update_scanning_enabled_cb): remove
		- (nmwa_dbus_update_scanning_enabled): remove
		- (nmwa_dbus_update_devices): don't call nmwa_dbus_update_scanning_enabled() anymore
			since it got removed
		- (nmwa_dbus_enable_scanning): remove

	* gnome/applet/applet-dbus-info.c
		- (nmi_dbus_signal_update_scan_method): new function, signal NetworkManager to
			update the wireless scanning method from NMI
		- (nmi_dbus_get_wireless_scan_method): new function, return wireless scanning
			method value to NetworkManager
		- (nmi_dbus_info_message_handler): respond to the "getWirelessScanMethod" method call

	* gnome/applet/applet-dbus-info.h
		- Add prototype for nmi_dbus_signal_update_scan_method

	* gnome/applet/applet.c
		- (scanning_menu_update): new function, update one GtkCheckMenuItem from the
			Wireless Scanning menu based on current wireless scan method
		- (nmwa_menu_scanning_item_activate): new function, callback for GTK "activate"
			signal for Wireless Scanning menu items, tell NetworkManager the new method
			and update our menu items to make sure the right one is checked
		- (nmwa_set_scanning_enabled_cb): remove
		- (nmwa_context_menu_update): remove references to pause_scanning_item
		- (nmwa_context_menu_create): remove pause_scanning_item, and add new Wireless
			Scanning menu item
		- (nmwa_gconf_get_wireless_scan_method): new method, pull wireless scanning method
			from GConf
		- nmwa_gconf_networks_notify_callback -> nmwa_gconf_info_notify_callback: generalize
			so we get notified of preference values too
		- (nmwa_get_instance): monitor GCONF_PATH_WIRELESS rather than GCONF_PATH_WIRELESS_NETWORKS

	* gnome/applet/applet.h
		- GCONF_PATH_WIRELESS added, one level below GCONF_PATH_WIRELESS_NETWORKS
		- Add wireless scan method member to applet data
		- Remove pause_scanning_item, add Wireless Scanning submenu

	* src/NetworkManager.c
		- (nm_data_new): default to NM_SCAN_METHOD_ON
		- (main): grab scanning method from NMI if we can

	* src/NetworkManagerDbus.c
		- (nm_dbus_update_wireless_scan_method_cb): new function, callback from
			nm_dbus_update_wireless_scan_method()
		- (nm_dbus_update_wireless_scan_method): new function to grab scanning method
			from NMI
		- (nm_dbus_nmi_is_running): redundant function, removed
		- (nm_dbus_signal_filter): trap "WirelessScanMethodUpdate" signal, grab scanning method
			when NMI comes back

	* src/NetworkManagerDevice.c
		- (nm_device_is_activated): return TRUE if the device is activated
		- (nm_device_wireless_scan): don't scan if the scan method is OFF, or if its AUTO
			and we are activated

	* src/nm-dbus-nm.c
		- (nm_dbus_nm_set_scanning_enabled): removed
		- nm_dbus_nm_get_scanning_enabled -> nm_dbus_nm_get_wireless_scan_method
		- (nm_dbus_nm_methods_setup): remove [get | set] ScanningEnabled and add "getWirelessScanMethod"

2005-06-09  Dan Williams <dcbw@redhat.com>

	* NetworkManager.h
	  src/vpn-manager/nm-vpn-service.c
		- NM_VPN_STATE_ERROR -> NM_VPN_STATE_UNKNOWN (more consistent with other enums)

2005-05-27  Dan Williams <dcbw@redhat.com>

	* vpn-daemons/vpnc/nm-vpnc-service.c
		- (vpnc_watch_cb): wait a bit before trying to read vpnc's pidfile.
			Should fix the bug where the VPN connection terminates the first time.

2005-05-20  Dan Williams <dcbw@redhat.com>

	* NetworkManager.h
		- Differentiate VPN config signals between bad VPN config options
			and bad IP config

	* gnome/applet/applet-dbus-info.h
		- Add prototypes for wireless network and vpn connection update functions

	* gnome/applet/applet-dbus.c
		- (nmwa_dbus_filter): trap new VPN config error signals from NetworkManager

	* gnome/applet/applet.c
		- (nmwa_schedule_vpn_failure_dialog): new dialog text for new VPN config
			error signals
		- (nmwa_gconf_networks_notify_cb): re-enable wireless network change notify
			propogation to NetworkManager
		- (nmwa_gconf_vpn_connections_notify_cb): re-enable vpn connection change
			notify propogation to NetworkManager

	* src/NetworkManagerDbus.c
		- (nm_dbus_update_one_allowed_network): make sure to specify which AP list we
			are updating so a network can be removed from it if necessary

	* src/vpn-manager/nm-vpn-manager.c
		- (nm_vpn_manager_process_signal): trap new vpn config error signals

	* vpn-daemons/vpnc/nm-vpnc-service.c
		- (nm_vpnc_dbus_signal_failure): generalize function for all VPN error signals
		- (nm_vpnc_dbus_signal_launch_failed): remove
		- (nm_vpnc_dbus_signal_connect_failed): remove
		- (nm_vpnc_helper_timer_cb): update for new generalized error signal function
		- (nm_vpnc_schedule_helper_timer): increase timeout to 10s
		- (vpnc_watch_cb): don't whine about exit code if vpnc exited cleanly, update
			for new generalized error signal function, remove config file stuff
		- (nm_vpnc_start_vpnc_binary): grab a stdin pipe to vpnc after spawning it so
			we can write configuration options to it
		- (nm_vpnc_config_file_generate): removed
		- (nm_vpnc_config_write): write configuration options to the vpnc stdin pipe
		- (nm_vpnc_config_options_validate): validate the config options we receive
			from NetworkManager to block potential exploits
		- (nm_vpnc_dbus_handle_start_vpn): call option validation function before
			starting vpnc
		- (nm_vpnc_dbus_process_helper_config_error): actually propogate config error
			to NetworkManager

2005-05-16  Dan Williams  <dcbw@redhat.com>

	* vpn-daemons/vpnc/nm-vpnc-service-vpnc-helper.c
		- (main): Work correctly with vpnc 0.3.3 by exiting if the "reason" code
			is not "connect"

2005-05-16  Dan Williams  <dcbw@redhat.com>

	Patch from Tomislav Vujec <tvujec@redhat.com>
	* gnome/applet/applet-dbus-info.c
		- (nmi_dbus_get_vpn_connection_routes): new function, pull routes out of
			GConf and pass them to NetworkManager.  New key is 'routes' under
			the VPN connection, and should be a string list

	* src/NetworkManagerSystem.c
		- (nm_system_vpn_device_set_from_ip4_config): if user-defined routes exist,
			set them on the device when we set the rest of the VPN config.  Ensure
			they are in the correct format since they are passed directly to the
			command line.

	* src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerDebian.c
		- (nm_system_device_add_route_via_device_with_iface): new function

	* src/vpn-manager/nm-dbus-vpn.c
		- (nm_dbus_vpn_get_routes): grab VPN routes from NetworkManagerInfo

	* src/vpn-manager/nm-vpn-manager.c
		- (nm_vpn_manager_handle_ip4_config_signal): grab routes from NMI and pass
			them into the IP4 config functions

2005-05-15  Dan Williams  <dcbw@redhat.com>

	From Filip Miletic:
	* po/sr.po
	  po/sr@Latn.po
	  configure.in
		- Serbian translation added

2005-05-15  Dan Williams  <dcbw@redhat.com>

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- (main): sync arguments with NetworkManager and the applet, now use
			"--no-daemon" rather than "daemon=no"
		- (nmd_print_usage): Fix script path in usage message

2005-05-15  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDevice.[ch]
	  src/NetworkManagerPolicy.c
	  src/NetworkManager.c
	  src/nm-dbus-nm.c
		- Remove the "just_added" parameter from nm_device_deactivate().  We no
			longer send the DeviceNoLongerActive signal unconditionally, but only
			when the device is actually active.

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- (nmd_execute_scripts): convert to GLib directory functions from opendir(),
			and simplify the logic
		- (nmd_get_device_name): copy value from dbus reply so we don't segfault when
			we free it later on

	* initscript/RedHat/Makefile.am
	  initscript/RedHat/NetworkManagerDispatcher
		- Add initscript for NetworkManagerDispatcher


	Patch from Bill Moss:
	* dispatcher-daemon/NetworkManagerDispatcher.c
		- Remove IP4AddressChange signal code including nmd_get_device_ip4_address()

	* src/NetworkManagerDbus.c
		- (nm_dbus_signal_device_ip4_address_change): remove.  If the device goes up,
			and DeviceNowActive gets signaled, then the device has a new IP address
			anyway.  There's no need for a separate signal.

	* src/NetworkManagerDevice.c
		- (nm_device_update_ip4_address): Don't send IP4AddressChange signal

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): Send DeviceNowActive signal when the device
			activates successfully.  This kind of went missing when I reworked the
			activation code.

2005-05-15  Dan Williams  <dcbw@redhat.com>

	* configure.in
		- Check for dhcdbd and error if its not found

	* src/dhcp-manager/Makefile.am
	  src/dhcp-manager/nm-dhcp-manager.c
		- Use path to dhcdbd that configure found

2005-05-14  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/nm-device.c
		- (network_device_sort_wireless_networks, sort_networks_function): New functions to
			sort wireless networks alphabetically

	* gnome/applet/applet-dbus-devices.c
		- (mwa_dbus_devices_lock_and_copy): Sort network device's wireless network lists
			before copying them over to the GUI

2005-05-14  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManager.c
		- (device_stop_and_free): Deactivate VPN connections before deactivating devices,
			fixes a deadlock on shutdown with a VPN connection active.  This function locks
			the device list, as does nm_get_active_device() which is called from
			nm_vpn_manager_deactivate_vpn_connection().

2005-05-14  Dan Williams  <dcbw@redhat.com>

	* NetworkManager.h
		- Add signals for VPN Launch and Connect failures

	* gnome/applet/applet-dbus.c
		- (nmwa_dbus_filter): Trap new VPN launch & connect failure signals

	* gnome/applet/applet.c
		- (nmwa_show_vpn_failure_dialog): generalize old nmwa_show_vpn_login_failure_dialog()
			function to handle all VPN failure messages
		- (nmwa_schedule_vpn_failure_dialog): generalize old  nmwa_schedule_vpn_login_failure_dialog()
			function to hanlde all VPN failure  messages
		- (show_warning_dialog): work around focus-stealing prevention

	* gnome/applet/other-network-dialog.c
	  gnome/applet/passphrase-dialog.c
		- (update_button_cb): Make sure the OK button is enabled when it should be, fixes
			problem where it never enabled for ASCII Key and Hex Key types

	* gnome/applet/wireless-applet.glade
		- Add window title to Other Wireless Network Dialog

	* src/vpn-manager/nm-dbus-vpn.c
		- (nm_dbus_vpn_signal_vpn_failed): generalize old nm_dbus_vpn_signal_vpn_login_failed()
			function to handle all VPN failure messages

	* src/vpn-manager/nm-vpn-manager.c
		- (nm_vpn_manager_process_signal): trap and proxy VPN launch & connect failure signals too

	* vpn-daemons/vpnc/nm-vpnc-service.c
		- (nm_vpnc_dbus_signal_launch_failed): new function
		- (nm_vpnc_dbus_signal_connect_failed): new function
		- (nm_vpnc_helper_timer_cb): signal connect failure on timeout
		- (vpnc_watch_cb): signal connection failure when vpnc exits with connection failure
		- (nm_vpnc_start_vpnc_binary): search a number of locations for vpnc
		- (nm_vpnc_dbus_handle_start): send launch failure signal when we fail to launch vpnc

2005-05-11  Dan Williams  <dcbw@redhat.com>

	* vpn-daemons/vpnc/nm-vpnc-service.c
		- (nm_vpnc_start_vpnc_binary): NULL-ify GError before using it
		- (nm_vpnc_config_file_generate): Attempt to ensure that the path for the config
			file exists before trying to write it out.

2005-05-10  Dan Williams  <dcbw@redhat.com>

    * gnome/applet/applet-dbus-device.c
        - (nmwa_dbus_set_device): remove check for valid key and key type, which 
            prevented just entering ESSID and leaving key and key type up to
            NetworkManager (which should have them already cached)

2005-05-08  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): Don't set NM_ACT_STAGE_ACTIVATED here, instead...
		- (nm_policy_schedule_activation_finish): Set NM_ACT_STAGE_ACTIVATED here to
			fix a situation where NM is told to terminate and the device stops activation,
			but the main thread isn't aware of that because it would never have run
			nm_policy_activation_finish() to set the ACTIVATED flag, because the main loop
			had already quit.

	* src/NetworkManagerDevice.c
		- (nm_device_probe_wired_link_state): cosmetic fixes
		- (nm_device_activate_stage5_ip_config_commit): Don't check link state if
			we've failed to activate or been canceled.
		- (nm_ac_test): nm_debug -> nm_info for "waiting for device to cancel" message

2005-05-08  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerWireless.c
		- (nm_wireless_qual_to_percent): Fix #if -> #ifdef, print out the "updated"
			value of WEXT quality structures, and add a debug message when we cannot
			determine any quality % at all

2005-05-08  Dan Williams  <dcbw@redhat.com>

	* src/dhcp-manager/nm-dhcp-manager.c
		- (nm_dhcp_manager_begin_transaction): Tell dhclient to release leases when
			it goes down.

2005-05-06  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-device.c
	  gnome/applet/applet-dbus-info.c
	  gnome/applet/applet-dbus.c
	  gnome/applet/applet.c
	  gnome/applet/applet.h
		- (nmwa_get_device_for_nm_device) -> (nmwa_get_device_for_nm_path)

	* gnome/applet/applet-dbus.c
		- (nmwa_dbus_filter): trap DeviceCarrierOn/DeviceCarrierOff signals
			so we notice when wired device's carriers come back on.  Should
			fix issue with wired devices being grayed out even if the cable
			is in, for devices that support carrier detection.

	* gnome/applet/applet.c
		- (nmwa_driver_notify): bash focus-stealing prevention in the face
		- (nmwa_act_stage_to_pixbuf): Clarify wireless ACT_STAGE_DEVICE_CONFIG
			tooltip message
		- (nmwa_menu_item_activate, nmwa_menu_add_device_item, nmwa_menu_item_data_free):
			Fix situation where applet wouldn't respond to menu selections

	* src/NetworkManager.c
	  src/NetworkManagerDevice.c
	  src/NetworkManagerDbus.c
	  src/NetworkManagerDbus.h
		- (nm_dbus_signal_device_status_change) -> (nm_dbus_schedule_device_status_change_signal)

	* src/NetworkManagerDbus.c
		- (nm_dbus_send_network_not_found, nm_dbus_schedule_network_not_found_signal):
			Remove, no longer used or relevant
		- (nm_dbus_signal_device_status_change): Better signal enum->string matching
		- (nm_dbus_schedule_device_status_change_signal): add

	* src/NetworkManagerDevice.c
		- (nm_device_worker_thread_stop): don't try to join a NULL worker thread
		- (nm_device_set_link_active): Fix up switching for non-carrier-detect devices,
			ie don't deactivate them unless explicitly told to by the user.  Also send
			CARRIER_OFF / CARRIER_ON signals when link changes
		- (nm_device_set_essid, nm_device_set_enc_key, nm_device_is_up, nm_device_set_mode):
			Don't print error message when device is no longer around
		- (nm_device_deactivate): kill any current DHCP process attached to this device,
			not just during activation

	* src/NetworkManagerPolicy.c
		- (nm_policy_auto_get_best_device): Ignore semi-supported devices completely from
			auto-device-selection.
		- (nm_policy_device_change_check): Don't interrupt semi-supported devices

	* src/NetworkManagerSystem.c
		- (nm_system_device_set_up_down_with_iface): Quiet first warning message when device
			is no longer present (Bill Moss)

	* src/backends/shvar.c
		- (svOpenFile): Open read-only to make SELinux happy

	* src/backends/NetworkManagerRedHat.c
		- (nm_system_device_get_system_config): Use SYSCONFDIR rather than hardcoding
			the path to the ifcfg-* files

2005-05-05  Dan Williams  <dcbw@redhat.com>

	* Expose activation stages to NetworkManager clients, like the applet
	* Add Diana's progress icons to the applet, cued off NM activation stage
	* Use more descriptive tooltips, cued off NM activation stage

2005-05-05  Ray Strode  <rstrode@redhat.com>

	* src/nm-netlink-monitor.c:
		- Use clear_event_source instead of g_nullify_pointer() again.

2005-05-05  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/main.c
		- Fix session management so the applet is actually managed now

	* gnome/applet/passphrase-dialog.c
		- (nmi_passphrase_dialog_show): bash focus-stealing prevention in the face

2005-05-05  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss:
	* gnome/libnm_glib/libnm_glib.c
		- Fix for dbus-0.33

2005-05-05  Dan Williams  <dcbw@redhat.com>

	Suggestion from Bill Moss:
	* src/NetworkManagerSystem.c
		- (nm_system_device_set_up_down_with_iface): ignore ENODEV


	* src/NetworkManager.c
		- (nm_data_free): move destruction of the various managers after
			release of device list, because deactivating and freeing a device
			requires at least the named manager
		- (nm_poll_and_update_wireless_link_state):
		  (nm_device_link_activated):
		  (nm_device_link_deactivated):
			don't grab the device list lock when actually updating device
			link status or strength, since nm_device_set_link_active()
			needs to call nm_get_active_device(), which also locks the device list.

	* src/NetworkManagerDevice.c
		- (nm_device_set_link_active): if a device's link switches from off->on,
			and it's wired, and the active device is wireless (or there is no
			active device), activate the new device whose link just came on
		- (link_to_specific_ap): try to smooth over intermittency in wireless links
			my only calling the link to the current ap "failed" when more than 2
			consecutive link checks have failed

2005-05-04  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_probe_wireless_link_state): don't lock the scan mutex here
			but let link_to_specific_ap() do the locking where it needs

	Patch from Bill Moss:
	* src/NetworkManagerSystem.c
		- Set MTU of VPN devices to 1412

2005-05-04  Dan Williams  <dcbw@redhat.com>

	* Remove NM_STATE_SCANNING from NetworkManager.h and applet code

	* Fix some holes in device activation and retaining the currently connected
		access point

2005-05-03  Dan Williams  <dcbw@redhat.com>

	* Kill dhcpcd.  We now use "dhcdbd", a dbus daemon that controls dhclient.
	  This means that NetworkManager shouldn't have DHCP issues anymore.  It also
	  means you need dhcdbd, which you can get here (get the latest one):

		http://people.redhat.com/jvdias/dhcdbd/

	  Technically NetworkManager can use any DHCP daemon that uses the same DBUS
	  interface as dhcdbd.

	* Rewrite device activation to facilitate the new DHCP infrastructure and
	  future improvements.  Its now "activation request" based, ie there is a single
	  activation request composed of the device, access point, and other info which
	  follows the entire activation process.  There are 5 stages of the activation
	  process which correspond to:

		1) Device preparation
		2) Device configuration (bring it up, set ESSID/Key/etc)
		3) IP Config Start (fire off DHCP if we're using it)
		4) IP Config Get (grab config from DHCP or static config files)
		5) IP Config Commit (set device's IP address, DNS, etc)

	  Note that there is no longer a "scanning" step, since the access point must
	  be known _before_ activation starts.  If the access point drops out or does
	  not exist for some reason, the entire activation process fails and must be
	  restarted for a different access point or device.

	Patch from Bill Moss:
	* gnome/applet/applet.c
		- Fix type of vpn_failure dialog -> vpn_banner dialog

2005-04-27  Dan Williams  <dcbw@redhat.com>

	* gnome/applet/applet-dbus-vpn.c
	  gnome/applet/applet.c
	  gnome/applet/applet.h
		- Fix up active VPN handling so that we reliably know when a VPN
			connection has been deactivated

	* src/vpn-manager/nm-vpn-manager.c
		- Remove duplicate VPNConnectionChange signal

2005-04-27  Dan Williams  <dcbw@redhat.com>

	Patch from Peter Jones:
	* Remove usage of varargs to fix crashes on PPC (RH #154336)

	Patch from Bill Moss:
	* src/NetworkManagerSystem.c
		- Fix checking of return value from ioctl()

2005-04-27  Dan Williams  <dcbw@redhat.com>

	* Fix choosing of wireless networks and "Other wireless network..." from the applet
	* Warn and exit if icons cannot be found

2005-04-27  Dan Williams  <dcbw@redhat.com>

	Patch from Tom Parker:
	* Update debian backend

2005-04-27  Dan Williams  <dcbw@redhat.com>

	* Merge the applet and the info-daemon, and move the converged
		applet under gnome/applet
	* Move libnm_glib to gnome/libnm_glib
	* Convert most dbus calls between the applet, info-daemon, and NM
		into async calls
	* Fix a few things valgrind noticed
	* Make NM broadcast state more reliably

2005-04-22  Pawan chitrakar  <pawan@nplinux.org>

	* configure.in: Added ne in ALL_LINGUAS

2005-04-15  Dan Williams  <dcbw@redhat.com>

	* libnm_glib/libnm_glib: Fix up for dbus-0.32, and remove
		code for dbus 0.2x versions

2005-04-15  Dan Williams  <dcbw@redhat.com>

	Patches from Tom Parker:
	- Fix memleaks
	- Join with worker thread rather than polling for its exit

	Patch from Bill Moss:
	- Cull duplicate ESSIDs from the scan list, taking highest strength AP

2005-04-15  Dan Williams  <dcbw@redhat.com>

	- Fixes to pass 'make distcheck'

2005-04-15  Dan Williams  <dcbw@redhat.com>

	Initial VPN Support
		- supports 'vpnc'
		- reworks device IP configuration, backend files have changed and will need
			to be updated for all distributions.  I will try to do what I can for
			them, but I cannot test them.

	- Move named directory to src/named-manager
	- Make backends directory self-contained

2005-04-06  Dan Williams  <dcbw@redhat.com>

	Add debug code for socket/file descriptor leaks.  We register every socket
	that we open (except for stuff in dhcpcd/) for tracking, and print out the
	list of sockets that we forgot to close on shutdown.  This also consolidates
	about 4 places where we opened sockets into 1 function in NetworkManagerUtils.c

2005-04-06  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/dhcpcd.c
		- (dhcp_interface_free): fix a file descriptor leak that may have
			caused network drivers to not unload due to refcounts > 0

2005-04-04  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- (nmwa_dbus_call_nm_method): remove some commented code

	* src/NetworkManagerAPList.[ch]
		- (nm_ap_list_remove_ap_by_essid): new function

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_force_use): remove access points from the ignore list
			when the user forces them

	* src/nm-dbus-device.c
		- (nm_dbus_device_get_active_network): fix up escaping of object paths

2005-04-04  Dan Williams  <dcbw@redhat.com>

	Patch from Tom Parker: include "nm-utils.h" for backend files that need it

2005-04-04  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDevice.c:
		- (nm_completion_scan_has_results): restore pre-completion-patch behavior
			of only erroring after the second consecutive scan times out.  Also
			don't exit when the card requires more time than we can give it, just
			log the event and continue.

2005-04-01  Steve Murphy  <murf@e-tools.com>

        * configure.in: Added "rw" to ALL_LINGUAS.

2005-04-01  Dan Williams <dcbw@redhat.com>

	Perform scans during device activation, if needed.  Both activation 
	and scans run in the same GMainContext.  Therefore, if an access point
	is not found by the time the device starts activation, it will not
	be available until after activation.  We now try to scan during
	activation (in nm_wa_test) every 15s so that all available access
	points are more likely to be found and available for the activation
	procedure.

	Also change nm_wireless_link_state_handle() to only update the "best"
	AP if we are not forcing a device and if we are not about to change
	state.  This attempts to work around a race when forcing a device,
	where the forced AP would get cleared out too soon by the link state
	checking timeout in the main thread, and the activation attempt with
	that AP would fail.

2005-04-01  Dan Williams <dcbw@redhat.com>

	* po/POTFILES.in
		- Update with new translatables

2005-03-31  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- Fix device names now that hal has changed device parenting for
			network devices.

2005-03-31  Dan Williams <dcbw@redhat.com>

	Tighten up handling of wireless devices that don't support wireless
	scanning (ie, Orinoco).  Due to restructuring of code, these devices
	hadn't been doing pseudo-scanning for a while either and would just
	spin waiting for an access point.  They are now manual devices where
	the user must choose the access point from the menu every time.  All
	"allowed" access points are listed in the applet's menu regardless
	of whether or not they can be seen by the card, since it can't scan
	anyway.

	* src/NetworkManager.c
		- (nm_wireless_link_state_handle): new function, but only update
			the "best" ap for non-scanning devices when its not activating,
			and when no device is being forced on the card
		- (nm_link_state_monitor): split wireless link state handling out
			into separate function

	* src/NetworkManagerDevice.c
		- (nm_device_copy_allowed_to_dev_list): new function
		- (nm_device_new): populate non-scanning cards' AP lists with
			access points from the "allowed" list
		- (nm_device_new): don't start a scanning timeout for devices that
			can't scan
		- (nm_device_activation_schedule_finish): new parameter, should be
			the AP that failed to be connected to, pass it on to the
			activation finish function in NetworkManagerPolicy.c
		- (nm_device_activate_wireless): don't ever try to get a new AP
			for non-scanning devices, just fail.  The user must choose
			a new access point manually.
		- (nm_device_activate): grab the AP that failed connection and
			pass it on
		- (nm_device_update_best_ap): Clear the best AP if we don't have
			a link to it, user must manually choose a new one
		- (nm_device_do_pseudo_scan): remove function
		- (nm_device_wireless_process_scan_results): remove bits for non-
			scanning cards since they never get here
		- (nm_device_wireless_scan): remove bits for non-scanning devices,
			and fake the scan list for test devices a bit earlier

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): use the failed_ap that we get
			passed rather than getting the best_ap from the card, which
			may have changed since we were scheduled
		- (nm_policy_allowed_ap_list_update): for non-scanning devices,
			update their scan list directly from the allowed list when
			we get updates to the allowed list from NetworkManagerInfo

	* src/NetworkManagerPolicy.h
		- New member for failed access point in NMActivationResult

  -------------------------------------

	Driver Notification patch: notifies the user when their driver
		sucks.  Gives them the option to ignore further insertions
		of the card that has the sucky driver.

	* NetworkManager.h
		- Remove the SEMI_SUPPORTED member from the NMDriverSupportLevel
			enum and replace it with NO_CARRIER_DETECT and
			NO_WIRELESS_SCAN

	* panel-applet/NMWirelessApplet.[ch]
		- Merge essid.glade -> wireless-applet.glade
		- Implement the "Your driver sucks" notification dialog

	* panel-applet/NMWirelessAppletDbus.c
		- Change stuff from getSupportsCarrierDetect->getDriverSupportLevel
		- Grab hardware address for each device from NM too
		- Check whether the driver for each device sucks or not whenever
			a new device is noticed

	* panel-applet/NMWirelessAppletOtherNetworkDialog.c
		- Deal with stuff being in wireless-applet.glade now rather than essid.glade

	* src/NetworkManager.c
		- Fix a double-unref on device removal

	* src/NetworkManagerUtils.c
		- Set appropriate driver support level on a device that doesn't
			support scanning or carrier detection

	* src/nm-dbus-device.c
		- New "getHWAddress" dbus method on devices
		- getSupportsCarrierDetect -> getDriverSupportLevel

2005-03-31  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_scan): Fix leak of scan results in some
			instances

2005-03-29  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- (nm_poll_and_update_wireless_link_state): make code less indented

	Patch from Bill Moss:
	* src/NetworkManager.c
		- (nm_device_update_link_state): Update signal strength on wireless
			devices every time we update link state too.

2005-03-29  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_set_essid): Work around Orinoco cards which need
			extra time after setting the ESSID

2005-03-29  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Merge one more bit of Peter Jones' completion patch

2005-03-29  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_force_use): Fix possible segfault

2005-03-29  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Use iw_get_ext() where we should rather than iw_set_ext()

2005-03-29  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_set_up_down): remove check for unsupported devices
			that caused NM to not bring devices up when they were
			added to the device list.

2005-03-28  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (mdio_read): Fix two bugs that caused all devices to fail
			the MII carrier detection support checks

2005-03-26  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_scan): Remove duplicated scanning code

2005-03-25  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- (nmwa_about_cb): Add some more contributors
		- (nmwa_update_state): show the applet when there's no connection
		- Enable the "Stop/Resume all wireless devices" option in the
			context menu
		- New "no connection" icon

	* src/NetworkManager.c
		- (nm_poll_and_update_wireless_link_state): don't do anything if
			wireless is disabled or we're asleep

	* src/NetworkManagerDHCP.c
		- Remove trailing "\n" on debug messages

	* src/NetworkManagerDbus.c
		- (nm_dbus_network_status_from_data): new state "asleep"

	* src/NetworkManagerDevice.c
		- Merge most of Peter Jones' "completion" patch that greatly reduces
			latency and wait times for most operations
		- (nm_device_wireless_scan): Don't scan when asleep

	* src/NetworkManagerPolicy.c
		- (nm_policy_get_best_device): return no device when asleep
		- (nm_policy_allowed_ap_list_update): From Bill Moss: merge properties
			for all wireless devices on update, not just active device

	* src/NetworkManagerUtils.c
		- Merge Peter Jones' "completion" patch

	* src/nm-dbus-nm.c
		- (nm_dbus_nm_set_wireless_enabled): bring down wireless devices when
			we're told to disable them
		- (nm_dbus_nm_sleep, nm_dbus_nm_wake): new functions for sleep/wake

	* utils/nm-utils.h
		- New variants of the warn/info/error/debug print functions that can take
			variables rather than static strings

2005-03-24  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerUtils.c
		- (nm_get_device_driver_name): driver names are now on the parents of
			"Network Interface" objects, so look for them there

2005-03-24  Dan Williams <dcbw@redhat.com>

	* test/nmtest.c
		- Escape some forgotten object paths before we shove them through dbus

2005-03-24  Dan Williams <dcbw@redhat.com>

	* dhcpcd/dhcpcd.[ch]
	  src/NetworkManagerDHCP.c
		- Switch names from "*_record_*" -> "*_element_*" to clarify things a bit
			(ie, dhcp_option_record_len -> dhcp_option_element_len)

	* src/NetworkManagerDbus.c
		- spacing cleanups

	* src/nm-dbus-dhcp.c
		- Make the API suck less.  There is now only 1 type of each function,
			ie only "getInteger" and no longer also "getIntegerv".  All types
			are returned encapsulated in a DBUS_TYPE_ARRAY, even for options
			that will never have more than 1 element.  This should simplify
			things greatly.

	* test/nm-dhcp-opt-test.c
		- Make the tool not segfault
		- adapt to new DHCP Options API

2005-03-22  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- (nm_wired_link_deactivated): actually ignore netlink events from
			wireless devices.

2005-03-22  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- (nm_wired_link_activated): actually ignore netlink events from
			wireless devices.

2005-03-17  Dan Williams <dcbw@redhat.com>

	Patch from Tom Parker:
	* src/nm-netlink-monitor.c
		- Include unistd.h
	* info-daemon/NetworkManagerInfoDbus.c
		- (nmi_dbus_update_network_auth_method): free GConf values

	Patch from Nathaniel McCallum <npmccallum@gentoo.org>:
	* src/NetworkManagerDevice.c
		- (nm_device_set_wireless_config): wait for successful
			association longer for some cards (Atheros a/b/g)

2005-03-15  Ray Strode  <rstrode@redhat.com>

	* src/NetworkManager.c:
	(sigterm_pipe_handler):
	remove bogus FIXME

2005-03-15  Ray Strode  <rstrode@redhat.com>

	* src/NetworkManagerDbus.c:
	Fix some sign weirdness that gcc4 doesn't like,
	and add a header file so PPC can hopefully find
	SIGTRAP

2005-03-14  Ray Strode  <rstrode@redhat.com>
	
	Fourth (probably working) cut at porting to
	dbus 0.30 api and new hal. This cut adds
	some new logging macros to make debugging
	easier.

	* dispatcher-daemon/NetworkManagerDispatcher.c:
	* info-daemon/NetworkmanagerInfo.c:
	* info-daemon/NetworkManagerInfoPassphraseDialog.c:
	* info-daemon/NetworkManagerInfoVPN.c:
	* src/NetworkManager.c:
	* src/NetworkManagerAP.c:
	* src/NetworkManagerAPList.c:
	* src/NetworkManagerDHCP.c:
	* src/NetworkManagerDbus.c:
	* src/NetworkManagerDevice.c:
	* src/NetworkManagerPolicy.c:
	* src/NetworkManagerSystem.c:
	* src/NetworkManagerUtils.c:
	* src/NetworkManagerWireless.c:
	* src/autoip.c:
	* src/nm-dbus-nm.c:
	* src/backends/NetworkManagerDebian.c:
	* src/backends/NetworkManagerGentoo.c:
	* src/backends/NetworkManagerRedHat.c:
	* src/backends/NetworkManagerSlackware.c:
	use new logging macros.

	* dispatcher-daemon/NetworkManagerDispatcher.c:
	(nmd_dbus_filter): s/dbus_free/g_free/

	* info-daemon/Makefile.am: link in utils library.
	* info-daemon/NetworkmanagerInfo.c: use new logging 
	macros.
	(nmi_dbus_get_network): don't assume enumerations
	are 32-bit.
	(nmi_dbus_nmi_message_handler): don't free what 
	doesn't belong to us.

	* libnm_glib/libnm_glib.c:
	(libnm_glib_get_nm_status): 
	(libnm_glib_init): don't free what doesn't
	belong to us.
	(libnm_glib_dbus): strdup result, so it doesn't get
	lost when message is unref'd.

	* panel-applet/NMWirelessAppletDbus.c:
	(nmwa_dbus_update_devices): s/dbus_free/g_free/

	* src/NetworkManager.c:
	(nm_monitor_wired_link_state): request initial status 
	dump of all cards when we start up, instead of relying
	on /sys/.../carrier.
	(nm_info_handler), (nm_set_up_log_handlers): 
	log handlers to specify what syslog priorites 
	the logging macros default to.

	* src/NetworkManagerAPList.c: 
	(nm_ap_list_populate_from_nmi):
	s/dbus_free_string_array/g_strfreev/

	* src/NetworkManagerDbus.c:
	(nm_dbus_get_network_object):
	validate d-bus message argument types.
	Advance message iterator after reading argument,
	prepend instead of append to GSList.

	* src/NetworkManagerDevice.c:
	(nm_device_probe_wired_link_status):
	remove redundant /sys in /sys path. remove wrong
	contents == NULL means has carrier assumption.

	* src/nm-netlink-monitor.c 
	(nm_netlink_monitor_request_status): implement
	function to ask kernel to dump interface link
	status over netlink socket.

	* test/*.c: s/dbus_free/g_free/

	* utils/nm-utils.h:
	(nm_print_backtrace): new macro to print backtrace.
	(nm_get_timestamp): new macro to get sub-second precise
	unix timestamp.
	(nm_info), (nm_debug), (nm_warning), (nm_error):
	new logging functions. nm_info just prints,
	nm_debug includes timestamp and function,
	nm_warning includes function, nm_error includes
	backtrace and sigtrap.

2005-03-11  Ray Strode  <rstrode@redhat.com>

	Third (unfinished, partially working) cut at porting to 
	dbus 0.30 api and new hal.

	* info-daemon/NetworkManagerInfoDbus.c:
		don't free null arrays.

	* panel-applet/NMWirelessAppletDbus.c: 
	* src/nm-dbus-device.c:
	* src/nm-dbus-net.c: 
	* src/NetworkManagerDbus.c: more 
 	STRING -> OBJECT_PATH fun
	* src/NetworkManagerDevice.c:
	* src/NetworkManagerDevice.h:
	(rename nm_device_get_link_active): rename to 
	nm_device_has_active_link
	(nm_device_wireless_link_active): rename to
	nm_device_probe_wireless_link_state
	(nm_device_wired_link_active): rename to
	nm_device_probe_wired_link_state.  Rewrite to
	use carrier file since hal doesn't maintain
	link state anymore.
	(nm_device_update_link_active): rename to
	nm_device_update_link_state
	* src/NetworkManagerPolicy.c 
	  (nm_policy_activation_finish): check for NULL
	  MAC address.

	* src/Makefile.am:
	* src/NetworkManagerMain.h: 
	* src/NetworkManager.c:
	* src/nm-netlink-monitor.c:
	* src/nm-netlink-monitor.h: New class to support
	monitoring wired ethernet link status, since HAL
	doesn't export that information anymore.

2005-03-09  Ray Strode  <rstrode@redhat.com>

	Second (unfinished, unworking) cut at porting to 
	dbus 0.30 api.

	* dispatcher-daemon/NetworkManagerDispatcher.c:
	* info-daemon/NetworkManagerInfoDbus.c:
	* panel-applet/NMWirelessAppletDbus.c:
	* src/NetworkManagerDbusUtils.c:
	* src/NetworkManagerDbusUtils.h:
	* src/nm-dbus-device.c:
	* src/nm-dbus-nm.c:
	* test/nmtest.c: support dbus "object path" type

	* configure.in: 
	* Makefile.am:
	* info-daemon/Makefile.am:
	* libnm_glib/Makefile.am:
	* panel-applet/Makefile.am:
	* dispatcher-daemon/Makefile.am
	* src/Makefile.am:
	* test/Makefile.am:
	* utils/Makefile.am: 
	* utils/nm-utils.c: 
	* utils/nm-utils.h: new utils static lib

2005-03-07  Ray Strode  <rstrode@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c:
	* libnm_glib/libnm_glib.c:
	* panel-applet/NMWirelessAppletDbus.c:
	* src/NetworkManager.c:
	* src/NetworkManagerDbus.c:
	* src/NetworkManagerDevice.c:
	* src/NetworkManagerUtils.c:
	* src/nm-dbus-device.c:
	* src/nm-dbus-dhcp.c:
	* src/nm-dbus-net.c:
	* src/nm-dbus-nm.c:
	* test/nminfotest.c:
	First (unfinished, unworking) cut at porting to dbus 0.30 api.

2005-03-04  Dan Williams  <dcbw@redhat.com>

	* configure.in
		- Mark HEAD as 0.4

2005-03-04  Dan Williams  <dcbw@redhat.com>

	Patch from Peter Jones:
	- Make stuff work with gcc 4.0

2005-02-28  Maxim Dziumanenko <mvd@mylinux.com.ua>

	* uk.po: Added "uk" (Ukrainian) to ALL_LINGUAS.

2005-02-27  Jim Huang  <jserv@kaffe.org>

	* configure.in: Added "zh_TW" (Traditional Chinese) to ALL_LINGUAS.

2005-02-27  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss:
	* panel-applet/NMWirelessAppletDbus.c
		- Make sure strength for current access point is up-to-date when we
			update the gui data model

2005-02-27  Alessio Frusciante  <algol@firenze.linux.it>

	* configure.in: Added "it" (Italian) to ALL_LINGUAS.

2005-02-27  Dan Williams  <dcbw@redhat.com>

	* src/backends/NetworkManagerRedHat.c
		- (nm_system_init): Kill any dhclient processes lying around as well
			as stopping 'nifd' if its already been started.  NetworkManager
			subsumes the functions of nifd (kicking mDNSResponder, autoip)

2005-02-27  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- (nmwa_destroy): Really mean to destroy GUI data model first, then
			dbus data model, not the GUI data model twice.

2005-02-27  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
	  panel-applet/NMWirelessAppletDbus.[ch]
		- Move to incremental network updates.  Instead of blowing away our list
			of devices every time we get a signal from NetworkManager, we now
			incrementally add/remove networks when NetworkManager notifies us that
			a new network has appeared or disappered.  Strength updates now happen
			on-the-fly for each access point as well.  There are now two copies of
			data from NetworkManager: one for the dbus side, and one for the gui side.
			When the dbus side data is modified, it is copied over to the gui side
			so we don't have to hold the data_mutex for long periods of time (and
			therefore block animation of the applet's icon).
		- Clean up some memleaks too

	* panel-applet/NMWirelessAppletOtherNetworkDialog.c
		- Minor code beautification

	* src/NetworkManagerAPList.c
		- (nm_ap_list_merge_scanned_ap): return whether or not the access point is
			completely new and whether or not an existing one's strength was updated.
			Try to fix multiple access points and signal strength by using the highest
			signal strength in each scan for any given ESSID.

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_signal_wireless_network_change): consolidate signals that deal with
			wireless networks; now we have only WirelessNetworkUpdate which includes
			a UINT32 for Appeared, Disappeared, or StrengthChanged (see NetworkManager.h).
		- Kill usage of DbusMessageIter

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_process_scan_results): Use the same timestamp for all APs
			in the same scan result list.  Copy ESSIDs-by-address earlier on, for each
			AP rather than all-at-once.  Also don't ever remove the AP a card is
			currently associated with from the network list.
		- Update for new signals during scan, send out Appeared, Disappeared, or
			StrengthChanged when necessary.

2005-02-25  Dan Williams  <dcbw@redhat.com>

	* README
		- Line break the README

2005-02-25  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletOtherNetworkDialog.c
		- Remove usage of gtk_window_set_default_size()

	* panel-applet/essid.glade
		- Stick default size here
		- Add in random crap that current glade wants to add in now

2005-02-25  Dan Williams  <dcbw@redhat.com>

	* src/backends/NetworkManagerRedHat.c
		- For non-caching-nameserver/non-named case, ensure that nscd is running
			and that we actually tell nscd to reload the hosts cache when it changes

2005-02-25  Dan Williams  <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
		- (nmi_dbus_get_network_properties): whack usage of DbusMessageIter

	* test/nminfotest.c
		- Whack usage of DbusMessageIter
		- Clean up DbusError and DbusMessage handling and freeing
		- Remove unused unregister handler

	* test/nmtest.c
		- Whack usage of DbusMessageIter

	* test/nmtestdevices.c
		- Whack usage of DbusMessageIter

2005-02-25  Dan Williams  <dcbw@redhat.com>

	* NetworkManager.h
		- New signal type NMNetworkStatus in preparation for the "WirelessNetworkUpdate"
			signal

2005-02-25  Dan Williams  <dcbw@redhat.com>

	* named/nm-named-manager.c
		- Ensure that pid and watch variables for child named process get cleared out
			when the child goes away.

2005-02-22  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): Deactivate a device if its activation fails,
			and NULL out data->active_device so that we have to choose another one.
			This may make NetworkManager keep attempting to connect to a wired network
			if it fails, but if it keeps failing the wired network has more problems than
			just NetworkManager.

	* src/backends/NetworkManagerRedHat.c
		- (nm_system_update_dns): fix to actually run nscd -i hosts when nscd
			is already running

	* named/nm-named-manager.c
		- (rewrite_resolv_conf): Call nm_system_update_dns() when not using
			named so that the distro can flush whatever name service caching
			daemon it uses

2005-02-21  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDHCP.[ch]
		- (nm_device_dhcp_remove_timeouts): new function

	* src/NetworkManagerDevice.c
		- Use nm_device_dhcp_remove_timeouts() everywhere that we need to
			remove the DHCP timeouts.

2005-02-21  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
	  panel-applet/menu-info.[ch]
		- Give the panel applet some major love: menu items are no longer
			subclasses of GtkCheckMenuItem, they are actual GtkCheckMenuItems.
			This allows the applet to actually reflect theme changes correctly,
			since themeing of subclassed items in GTK _sucks_.

2005-02-18  Dan Williams  <dcbw@redhat.com>

	* libnm_glib/libnm_glib.[ch]
	  test/libnm_glib_test.c
		- Clean up libnm_glib API a bit, callback is now passed a libnm_glib_ctx
			and its data, and doesn't have to free the callback data anymore

2005-02-18  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Revert 2005-02-18 William Jon McCann fix for standard
			copyright string until it passes 'make distcheck'.
			With standard copyright string, xgettext complains
			about "Non-ASCII string at ...".

2005-02-18  Dan Williams  <dcbw@redhat.com>

	* panel-applet/essid.glade
	  panel-applet/NMWirelessAppletOtherNetworksDialog.c
		- Correct spelling of "adaptor"->"adapter"

2005-02-18  William Jon McCann  <mccann@jhu.edu>

	* panel-applet/NMWirelessApplet.c: Use GTK_CHECK_VERSION() macro.
	(nmwa_about_cb): Use standard copyright string.  Update comment
	text to reflect that it is a notification area applet.  Remove
	leading newline in authors list.
	(nmwa_menu_show_cb, nmwa_setup_widgets): Populate menu on show
	instead of on parent menu item activation.  Fixes #167550.

2005-02-18  William Jon McCann  <mccann@jhu.edu>

	* panel-applet/essid.glade: Capitalize items as per HIG.
	  Fixes #167632

2005-02-16  William Jon McCann  <mccann@jhu.edu>

	* panel-applet/gtkcellrendererprogress.[ch]: Only compile these
	files for GTK 2.4 or lower, since now public in GTK 2.6.

	* panel-applet/essid.glade: Don't specify window size.
	
2005-02-17  Dan Williams  <dcbw@redhat.com>

	Caught by Bill Moss:
	* dhcpcd/client.c
		- Time remaining for DHCP transaction calculation was incorrectly
			inside a #ifdef DEBUG

2005-02-15  Christophe Merlet  <redfox@redfoxcenter.org>

	* configure.in: Added fr (French) to ALL_LINGUAS.

2005-02-14  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDHCP.c
		- (set_domain_searches): Fix free of invalid pointer

2005-02-14  Dan Williams  <dcbw@redhat.com>

	Patch from Peter Jones:
	* dhcpcd/client.c
		- Ensure we return RET_DHCP_CEASED everywhere we should
	* dhcpcd/udpipgen.c
		- Use faster TOS for IP packets
		- Don't set ip_id since we're UDP

	Patch from Tomislav Vujec:
	* src/nm-dbus-dhcp.c
	  test/nm-dhcp-opt-test.c
		- Clean up warnings to enable cvs tree compilation.

2005-02-14  Tomislav Vujec  <tvujec@redhat.com>

	* configure.in
	  po/hr.po
		- Add the Croatian locale.

2005-02-14  Colin Walters  <walters@verbum.org>

	* src/NetworkManagerDHCP.c (set_domain_searches): Handle space-separated
	list of domains to search.
	
	* src/NetworkManagerMain.h (NMData): Handle multiple domain searches.

2005-02-13  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/client.c
		- Debug output cleanups of DHCP option printing and parsing.

2005-02-13  Dan Williams  <dcbw@redhat.com>

	Patch from Dan Reed:  DHCP options D-BUS API
		Exposes the DHCP options that a device receives to clients over D-BUS.

	* configure.in
		- A few cleanups

	* dhcpcd/client.h
		- Correct names, option length, and types for DHCP options

	* dhcpcd/dhcpcd.[ch]
		- Clarify function names that access DHCP options & data

	* src/NetworkManagerDHCP.c
		- Use new DHCP data access functions

	* src/NetworkManagerDbus.c
		- Message handler for DHCP functions

	* src/nm-dbus-dhcp.[ch] (new)
		- DHCP dbus methods

	* test/nm-dhcp-opt-test.c
		- Test DHCP D-BUS API and return all present DHCP options

2005-02-12  Dan Williams  <dcbw@redhat.com>

	* test/Makefile.am
	  test/nmclienttest.c
	  test/nmtest.c
		- Move nmclienttest.c -> nmtest.c

2005-02-12  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/buildmsg.c
		- Pad DHCP packets until they are at least 300 bytes in size.

2005-02-11  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/client.c
		- (dhcp_init): only print out client ID and class ID if they are specified

	* src/NetworkManagerDbus.[ch]
	  src/nm-dbus-nm.[ch]
	  src/nm-dbus-device.[ch]
	  src/nm-dbus-net.[ch]
		- Move NM, Device, and Net functions to separate files and use the
			dbus method list stuff in NetworkManagerDbusUtils.c to do
			method dispatching

	* src/NetworkManagerDbusUtils.c
		- Add new validate_method called before each dispatch (if present)
			that can validate the method call

	* src/NetworkManagerWireless.c
		- (nm_wireless_qual_to_percent): Fix misplaced "!" that caused signal
			levels never to be evaluated

	Patch from j@bootlab.org
	* src/NetworkManagerDevice.c
		- Add typedef for "u64"

	* src/backends/NetworkManagerDebian.c
		- Copy in Dave Woodhouse's fixes for IPv6

2005-02-11  Dan Williams  <dcbw@redhat.com>

	Patch from Dave Woodhouse for IPv6:
	* src/NetworkManagerUtils.c
		- (nm_ethernet_address_is_valid): Check for prism54 dummy MAC address
			and multicast addresses

	* src/NetworkManagerDevice.c
		- (nm_device_set_up_down): make sure our cached MAC address is up-to-date
			after bringing up a card.

2005-02-10  Dan Williams  <dcbw@redhat.com>

	Patch from Dave Woodhouse:
	* src/NetworkManagerSystem.h
	  src/backends/NetworkManagerDebian.c
	  src/backends/NetworkManagerGentoo.c
	  src/backends/NetworkManagerSlackware.c
		- New nm_system_device_add_ip6_link_address() function to add link-local
			address on an interface.  Stubbed in Debian, Gentoo, and Slackware.

	* src/backends/NetworkManagerRedHat.c
		- (nm_system_device_add_ip6_link_address): implement
		- (nm_system_device_flush_addresses): revert to previous behavior of
			flushing all addresses

2005-02-10  Dan Williams  <dcbw@redhat.com>

	Patch from Tom Parker:
	* src/NetworkManagerDevice.c
		- Remove the "#include <pci/types.h>" since both the ethtool.h and
			mii.h headers are broken, and instead use our own typedefs

2005-02-10  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/buildmsg.c
		- (fill_host_and_class_id): only fill in client and class IDs if
			they are set by callers.

	* dhcpcd/client.c
		- (class_id_setup): don't autogenerate a class ID, only use one
			we're given, if any.
		- (client_id_setup): don't autogenerate a client ID, only use one
			we're given, if any.

	* dhcpcd/dhcpcd.c
		- (dhcp_interface_init): ensure that client options are correctly
			NULL terminated

	* src/NetworkManagerDHCP.c
		- (nm_device_dhcp_request): pass hostname to dhcp library

2005-02-10  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/client.c
		- #rh147661# Don't send kernel version in DHCP requests

	* src/NetworkManagerSystem.h
	  src/backends/NetworkManagerDebian.c
	  src/backends/NetworkManagerGentoo.c
	  src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerSlackware.c
		- Remove the nm_system_device_run_dhcp() and nm_system_device_stop_dhcp()
			functions, they are no longer used anyway

	* src/backends/NetworkManagerRedHat.c
		- (nm_system_device_flush_addresses): only flush "scope global" and "scope site"
			addresses in an attempt to keep IPv6 local-scope addresses around

2005-02-10  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManager.c
		- (nm_create_device_and_add_to_list): change the add message slightly

	* src/NetworkManagerUtils.c
		- (nm_get_wireless_driver_support_level, nm_get_wired_driver_support_level):
			Return driver name to calling function
		- (nm_get_driver_support_level): print out the driver a device is using
			during the support check

	Patch from Dave Woodhouse:
	* dhcpcd/udpipgen.c
		- (in_cksum): copy last byte of odd-sized packets into a
			'u_short' rather than a 'u_char', should fix wrong checksums
			on big-endian platforms

2005-02-09  Dan Williams  <dcbw@redhat.com>

	* Clean up usage of GSList objects and looping through their members
	* Clean up DHCP rebind/renew timeouts, hopefully they will work correctly
		now.
	* Fix problem where even if scanning was turned off, card would still
		cycle through frequencies.

2005-02-08  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Fix for gtk 2.4

2005-02-08  Dan Williams  <dcbw@redhat.com>

	Patch from Bill Moss
	* panel-applet/NMWirelessApplet.c
		- Restore correct ESSID in tooltips

2005-02-07  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
		- Add a context menu that contains:
			Pause/Resume Wireless Scanning
			Stop/Start All Wireless Devices
			About...
		- Grab active device strength off active device,
			not its network

	* panel-applet/NMWirelessAppletDbus.[ch]
		- Add DBUS accessors for "getSupportsCarrierDetect", "setScanningEnabled",
			"getScanningEnabled", "setWirelessEnabled", and "getWirelessEnabled"
		- Update active device strength every 2 seconds, not every 1 second

	* panel-applet/menu-info.c
		- Only disable wired devices in the menu when they support carrier detection,
			and don't currently have a link.  Non-carrier-detect devices will always
			remain choosable

	* src/Makefile.am
	  src/NetworkManagerDbusUtils.[ch]
		- Add new new dbus utils sources

	* src/NetworkManager.c
		- Fixes for new link detection, we no longer need to call nm_device_update_link_active()
			with the boolean parameter
		- Set scanning_enabled & wireless_enabled to TRUE

	* src/NetworkManagerDbus.c
		- Use new dbus util method dispatcher functions for org.freedesktop.NetworkManager methods
		- Implement scanning & wireless enable/disable calls
		- Remove the dbus vtable unregister handlers, weren't doing anything with them anyway

	* src/NetworkManagerDevice.c
		- New link detection stuff again...
			o  Create device's mainloop earlier (but don't run it earlier)
			o  Hook up new carrier-detect support stuff
			o  Add in the ethtool & mii support detection code
		- Don't scan if scanning is disabled

	* src/NetworkManagerPolicy.c
		- Never automatically choose a device that doesn't support carrier detection
		- Don't automatically choose a wireless device if wireless is disabled

2005-02-07  Dan Williams  <dcbw@redhat.com>

	* libnm_glib/libnm_glib.c
		- Small cleanup in element list iteration

2005-02-07  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerWireless.c
		- (nm_wireless_qual_to_percent): Fix up wireless quality calculations
			to be in line with the WEXT quality specification

2005-02-02  Dan Williams  <dcbw@redhat.com>

	Patch from Nathan Fredrickson <nathan@silverorange.com>
	* Fix up compile for deprecation of libgnomeui
		- Switch to <glib/gi18n.h> from <libintl.h>
		- Remove <libgnomeui/libgnomeui.h> includes
		- Use gtk_window_set_default_icon_from_file() rather than
			gnome_window_set_default_icon_from_file()

	* named/nm-named-manager.c
		- (generate_named_conf): Fix return-nothing in non-void
			function

2005-02-02  Dan Williams  <dcbw@redhat.com>

	* Clean up unused variables and the like

2005-02-02  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerAPList.c
		- (nm_ap_list_merge_scanned_ap): merge strength too

	* src/NetworkManagerUtils.c
		- (nm_lock_mutex, nm_register_mutex_desc): new calls to facilitate debugging
			of locking issues by printing out prettier information than g_mutex_lock
		- Print out names of mutexes registered with nm_register_mutex_desc()
		- (nm_try_lock_mutex): don't do the waiting thing when trying to lock, causes
			us to seemingly block here for too long

	* src/NetworkManager.c
	  src/NetworkManagerAPList.c
	  src/NetworkManagerDevice.c
		- Convert to using nm_lock_mutex/nm_unlock_mutex rather than the glib variants
			so we get better debug information printed

	* src/NetworkManagerDbus.c
		- (nm_dbus_devices_handle_request): reduce usage of nm_device_need_ap_switch()
			since it sometimes has locking side effects
		- (nm_device_get_association_pause_value): Reduce 802.11a card pause value to 8s
			from 10s
		- (nm_device_need_ap_switch): If we can't acquire the scan lock, return saying
			we don't need a switch.  This gets called often enough that we can't block
			until the scan mutex is acquired, because we'll block on device activation
			and a few other things, which hangs main thread for too long.

	* src/NetworkManagerPolicy.c
		- (nm_policy_auto_get_best_device): reduce the possiblity that
			nm_device_need_ap_switch() will be called		

2005-02-02  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Display name of wireless network we are connecting to or connected to
			in the tooltip of the applet

2005-02-02  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDHCP.c
		- Hopefully fix double-default-route problem by cleaning up the default
			route added by DHCP code right before the DHCP transaction begins

2005-02-02  Dan Williams  <dcbw@redhat.com>

	* named/nm-named-manager.c
		- Write out valid resolv.conf when we exit

2005-02-01  Dan Williams  <dcbw@redhat.com>

	Patch from Colin Walters:
	* named/nm-named-manager.c
		- Make multi-domain search options work

2005-01-31  Dan Williams  <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
		- (nmi_dbus_nmi_message_handler): make sure 'dialog' exists before using it

	* src/NetworkManagerDevice.c
		- (nm_device_new): Don't store the entire range struct, use only what we need
			(which is currently avg_quality, max_quality, and frequencies).  Also
			zero device structure when we've free'd it to maybe expose errors down
			the line.
		- (nm_device_update_signal_strength): grab the scan mutex before getting
			quality data from the card since quality will be useless during a scan.
			Call updated wireless qual-to-percent function with values stored in
			nm_device_new() earlier.
		- Remove some unused functions (nm_device_get_max_quality(), nm_device_get_noise(),
			nm_device_get_bad_crypt_packets())
		- (nm_device_activate_wireless_adhoc): use new frequency values we go in
			nm_device_new()
		- (get_initial_auth_method): always use the Auth method that's in the allowed
			list if available.  Problem was this: when the WEP key is wrong, NM will
			try OS then SK modes, and then get stuck in SK mode after that.  This
			should reset it.
		- (nm_device_wireless_process_scan_results): work with new qual-to-percent
			function

	* src/NetworkManagerWireless.c
		- (nm_wireless_qual_to_percent): try to make this function actually work and
			mimic iwlib behavior.  Use card's idea of quality divided by max_qual
			if that's all present, otherwise fall back to signal-to-noise ratios.

2005-01-29  Dan Williams  <dcbw@redhat.com>

	* initscript/RedHat/NetworkManager
		- Don't spit out sysctl stuff to console

	* libnm_glib/libnm_glib.c
		- (libnm_glib_init): call dbus_g_thread_init()

	* panel-applet/NMWirelessAppletDbus.c
		- (nmwa_dbus_worker): call dbus_g_thread_init()

	* src/NetworkManager.c
		- (main): call dbus_g_thread_init()

	* src/NetworkManagerAPList.c
		- (nm_ap_list_print_members): use LOG_ERR instead of LOG_DEBUG
			so we can actually see what's there in a normal syslog

	* src/NetworkManagerDevice.c
		- (nm_device_activate_wireless): print out the "waiting for access point"
			message only once, then say what access point we actually got after
			the wait.
		- (nm_device_need_ap_switch): If a scan is in progress when we're in this
			function, wait until the scan is done.  Scans may change the ESSID of
			the card, making this function think we need to switch access points
		- (nm_device_wireless_process_scan_results): for artificial access points
			don't check against the card's ESSID, but the best_ap's ESSID.  This
			prevents collisions with the scanning code, which may change the card's
			ESSID and cause the access point to get dropped from the device's AP
			list.  Also increase the keep-around time to 2m from 60s since the max
			scan interval could be 60s in some cases.

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): Don't add invalid MAC addresses to GConf
		- (nm_policy_allowed_ap_list_update): When we update, make sure we copy over
			the new properties and ESSIDs to the device's AP list.  Fixes some races
			between NM and NMI.

2005-01-27  Dan Williams  <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
		- (nmi_dbus_add_network_address): if the network doesn't yet exist in
			GConf, make a minimal entry for it (essid & timestamp)

	* src/NetworkManagerAPList.c
		- (nm_ap_list_populate_from_nmi): Don't try to grab network data if
			NetworkManagerInfo isn't running

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_nmi_is_running): new function

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_force_use): Don't set the created AP's MAC
			address to garbage.

	* src/NetworkManagerPolicy.c
		- (nm_policy_activation_finish): On successful activation, make sure
			the "best" AP has a MAC address, and don't tell NMI to add the
			current AP's MAC address to GConf if the AP is an Ad-hoc AP.
		- (nm_policy_allowed_ap_list_update): Update a wireless card's "best"
			access point after refreshing our allowed list if it doesn't already
			have a "best" access point.

2005-01-25  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- (nmwa_dbus_filter): Fix dbus 0.23 ServiceOwnerChanged checks
			so we check for NM_DBUS_SERVICE rather than not for it

	* libnm_glib/libnm_glib.c
		- (libnm_glib_dbus_filter): Fix for dbus 0.23, trapping
			ServiceOwnerChanged signal

2005-01-25  Dan Williams  <dcbw@redhat.com>

	* configure.in
		- Check DBUS version in configure, and set the C macros
			DBUS_VERSION_[MAJOR,MINOR,MICRO]

	* info-daemon/NetworkManagerInfoDbus.c
		- Remove #if 0-d section of code that quit NMI if NM went away.

	* panel-applet/NMWirelessAppletDbus.c
		- Trap the "ServiceOwnerChanged" signal that's new in dbus-0.23

	* src/NetworkManager.c
	  src/NetworkManagerMain.h
	  src/NetworkManagerDbus.c
		- Trap the "ServiceOwnerChanged" signal that's new in dbus-0.23
		- Make updating of our Allowed Wireless Network lists from NMI
			an idle function in the main thread now, with a high priority.

2005-01-24  Dan Williams  <dcbw@redhat.com>

	* panel-applet/gtkcellview.[ch]
	  panel-applet/menu-info.c
		- Fix GTK version checks to be <= rather than <

	* test/Makefile.am
		- Include the libtool archive of libnm_glib rather than
			trying to pull in the .so

2005-01-24  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
	  src/NetworkManagerDevicePrivate.h
		- Block nm_device_new() until our device's worker thread has had a
			chance to start up.  Fixes a race between main thread and worker
			thread starting that caused activation requests to get lost.

2005-01-24  Dan Williams  <dcbw@redhat.com>

	* initscript/RedHat/NetworkManager
		- Remove the ### BEGIN INIT INFO section, which caused chkconfig
			to add the NM startup script at priority 50, which was
			way too early

2005-01-24  Colin Walters  <walters@redhat.com>

	* named/named.conf: Use any port for query source instead of
	restricting to port 53.

2005-01-24  Dan Williams  <dcbw@redhat.com>

	* initscript/RedHat/NetworkManager
		- Remove the ### BEGIN INIT INFO section, which caused chkconfig
			to add the NM startup script at priority 50, which was
			way too early

2005-01-24  Dan Williams  <dcbw@redhat.com>

	Patch from Tom Parker <palfrey@tevp.net>
	* Fix up compile warnings & errors in the wireless applet

2005-01-24  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Convert 24x24 icons back to 22x22 and use the 22x22 ones

2005-01-24  Dan Williams  <dcbw@redhat.com>

	* panel-applet/gtkcellview.[ch]
		- Only compile these files for GTK 2.4 or lower, since 
			GtkCellView is now public in GTK 2.6.  Fixes crasher
			when choosing "Other Wireless Networks" from the panel
			applet menu

2005-01-21  Dan Williams  <dcbw@redhat.com>

	* src/NetworkManager.c
		- Daemonize earlier so that glib doesn't get confused (?)

2005-01-21  Dan Williams  <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
	  panel-applet/NMWirelessAppletDbus.c
	  panel-applet/menu-info.c
	  src/NetworkManagerDevice.c
		- Disable wired devices in the menu when they have no link.

2005-01-21  Dan Williams  <dcbw@redhat.com>

	* Cache last-known-good wireless authentication method in
		NetworkManagerInfo, and use that method first during
		wireless device activation.  Should speed up devices that
		need Shared Key authentication method since Open System is
		now the default.

	* Remove the hack to not do full activation on wired connections
		that are active when we launch, it causes too many problems
		with name resolution and was a hack in the first place.

	* Re-work wireless device activation again somewhat to have a
		clearer chain of events and to use last-known-good
		authentication method of the access point.  Also provide
		better status throughout activation to ensure the applet
		can tell the user exactly what's going on.

	* Remove the "find wireless network" code and now simply attempt
		to activate with that access point.  This reduces the delay
		between selecting "Other wireless Network" and actually
		connecting to that network.

	* Correctly stop the device's worker thread when its removed.

2005-01-21  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/client.c
		- Clean up some of the debug messages

2005-01-21  Dan Williams  <dcbw@redhat.com>

	* Add new icons, more frames of animation
	* Remove some hacks to get the panel applet to display correct
		status, an NM update will soon follow that will fix the
		real issue.

2005-01-19  Kjartan Maraas  <kmaraas@gnome.org>

	* panel-applet/NMWirelessApplet.c: #include <config.h> must be
	the first include for working i18n. Also, don't include it in .h files
	* panel-applet/NMWirelessApplet.h: Same
	* panel-applet/NMWirelessAppletOtherNetworkDialog.c: Same
	* panel-applet/menu-info.c: Same

2005-01-18  Dan Williams <dcbw@redhat.com>

	* dhcpcd/client.c
		- Remove some debug messages
		- Wrap others in #ifdef DEBUG/#endif

	* src/NetworkManager.c
		- Remove some debug messages
		- Clarify some debug messages
		- Remove code related to old single-thread wireless scanning

	* src/NetworkManagerAP.[ch]
		- New AP property "last_seen" to track how recently an AP was
			found in a scan
		- Start using 'const' more in function arguments

	* src/NetworkManagerAPList.[ch]
		- (nm_ap_list_merge_scanned_ap): new, selectively update attributes
			of an AP found in an AP list from a source AP, or if not found
			in the list add the source AP
		- (nm_ap_list_combine): remove, no longer needed

	* src/NetworkManagerDevice.c
		- Each device now has a "worker" thread from start to end of its life.
			Scanning for wireless devices now happens in that thread,
			not in a single "wireless scanning thread" for all devices as
			previously.  Activation consists of adding an idle handler to the
			thread's main loop/context, which gets run at the next available
			opportunity.
		- Wireless scanning is also simplified, there is now only one list of
			access points per wireless device, and APs older than 60s are
			removed from the list.  Previously, we kept results for the last
			3 scans and merged whole lists, which was complicated.
		- Cleaned up activation debug messages.
		- Wireless activation and access-point search routines now use Open System
			authentication before trying Shared Key.
		- Removed some code in nm_device_update_best_ap() that could cause cards
			to loose their link to the access point.
		- Scanning now uses a backoff algorithm, where the inverval becomes
			progressively longer between scans when the list of scanned access
			points doesn't change.  A change will revert to the shortest scan
			interval (20s).

	* src/NetworkManagerWireless.[ch]
		- Remove code related to old single-thread wireless scanning

2005-01-18  Colin Walters  <walters@redhat.com>

	* src/NetworkManagerDHCP.c (set_nameservers): Free and clear list
	of older nameservers.

2005-01-18  Colin Walters  <walters@redhat.com>

	* named/nm-named-manager.c (generate_named_conf): Many fixes
	to config file generation.
	(safer_kill): Remove, was too much trouble for little gain.
	(nm_named_manager_start): Run named as NM_NAMED_USER.

	* configure.in: Add option --with-named-user.

2005-01-14  Colin Walters  <walters@redhat.com>

	Patch from ed@catmur.co.uk (Ed Catmur)

	* named/nm-named-manager.c: Add "context" property.
	Use it to add child watch source in specific GMainContext.

	* src/NetworkManager.c (nm_data_new): Initialize
	named with correct main context.  Start named only
	after forking.

2005-01-14  Colin Walters  <walters@redhat.com>

	* named/nm-named-manager.c (generate_named_conf): Write config
	and pid files into NM_NAMED_DATA_DIR; this allows things to
	work better with FC3 named SELinux policy.  Also fix up silly
	format error.

	* configure.in: Add --with-named-dir option.

2005-01-14  Colin Walters  <walters@redhat.com>

	* configure.in: Make named support require passing --with-named.

	* named/nm-named-manager.c: Support writing resolv.conf directly
	without running named.

2005-01-13  Dan Williams <dcbw@redhat.com>

	* named/nm-named-manager.c
		- Use syslog(LOG_WARNING) rather than g_warning() (gnome.org #163961)

	* src/NetworkManagerDevice.c
		- Rework wireless link detection code to be more reliable

2005-01-12  Dan Williams <dcbw@redhat.com>

	* initscripts/RedHat/NetworkManager
		- Change initial level to "-" rather than "345" so that
			we don't activate ourselves by default on install

2005-01-12  Dan Williams <dcbw@redhat.com>

	* libnm_glib/
		- Client library for applications using glib

	* configure.in
	  various Makefiles
		- Split NM_CFLAGS and NM_LIBS into separate variables
			like DBUS_*, HAL_* and GLIB_*

	* src/NetworkManager.c
	  src/NetworkManagerMain.h
		- (nm_schedule_status_signal_broadcast): at the earliest convenience,
			broadcast a status changed signal over DBUS from the main thread.
			Still unused anywhere for the moment.

	Patch from j@bootlab.org
	* panel_applet/NMWirelessAppletDbus.c
	  src/NetworkManagerDbus.c
		- Correct INT32->UINT32 mistmatch between NM and the panel applet
			for the "getMode" method call

2005-01-10  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Minor fixups & corrections to "auto" frequency mode, make it
			less chatty with syslog

2005-01-10  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Implement "auto" frequency/channel support, since cards like Atheros
			can't use other frequencies at all when you've told it to use a
			specific one, even for scanning.
		- Grab the scan mutex around places where we can't tolerate wireless
			settings changing underneath us, like nm_device_wireless_network_exists()
			and nm_device_activate_wireless()

	* src/NetworkManagerWireless.c
		- Back scan interval off to 20s instead of 14s

2005-01-09  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Don't set mode/freq/bitrate if that mode/freq/bitrate is
			already set.  Stops some drivers like Atmel from continually
			reloading the firmware, which they do upon every configuration
			change.

2005-01-09  Dan Williams <dcbw@redhat.com>

	* dhcpcd/client.c
		- Use correct timeout value

	* info-daemon/NetworkManagerInfoDbus.c
	  src/NetworkManagerDbus.c
		- Consolidate communication between NM and NMI by doing only 1 dbus
			method call to get Wireless Network info from NMI instead of 6

	* src/NetworkManager.c
		- Make sure to cancel activation when we receive a SIGTERM, otherwise
			when we didn't have an AP to use, we'd wait for one forever without
			quitting

	* src/NetworkManagerDevice.c
		- nm_device_activation_cancel(): Fix a race between dhcp and quitting
			activation, dhcp might not have started yet but we don't quit activation
			before starting it, so the quit signal gets lost

2005-01-07  Dan Williams <dcbw@redhat.com>

	* dhcpcd/client.c
		- Rework the DHCP client code to be much less chatty when
			it receives non-DHCP UDP packets during the DHCP run
			(reported by and preliminary patches from Bill Moss)

	* Move wireless scanning to a separate thread.  This thread forwards the
		results to the main thread when done where they are integrated into
		the device's access point lists.  This keeps the main thread (which
		does all the DBUS communication) from being blocked for long periods
		of time by wireless scanning.

	* Make state modification an idle routine in the main loop, and trigger
		state changes rather than polling for them.

	* src/backends/NetworkManagerGentoo.c
		- Fix up invalid C90 code (reported by Christoph Ruessler)

	* src/NetworkManagerDevice.c
		- Revert IPv6 patch for wired devices from 2004-12-22 for
			router advertisements, causing problems and infinite loop
			during "best" device determination due to link going up/down
			(reported by Bill Moss)

	Apply patch from Peter Jones
	* src/NetworkManagerDevice.c
		- Shortcut for link-checking for ipw2x00 cards
		- Split out association check into separate routine

2004-01-05  Colin Walters  <walters@redhat.com>

	* named/named.conf: Add PID_FILE.

	* named/nm-named-manager.c: Always generate a pid
	file, since older BIND versions don't support
	"pid-file none".

2005-01-01  Satoru SATOH <ss@gnome.gr.jp>

	* configure.in (ALL_LINGUAS): Added ja (Japanese).

2004-12-22  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Silently fail when setting bitrate doesn't work


	Patches from j@bootlab.org:
	* src/backends/NetworkManagerDebian
		- Update backend to match functionality in RedHat backend
	* src/NetworkManagerDevice.c
		- Take down then bring up wired devices after connection so
		they send out ipv6 router advertisements

2004-12-21  Colin Walters  <walters@verbum.org>

	* panel-applet/NMWirelessAppletDbus.c (nmwa_dbus_update_devices): Correctly
	test for NETWORK_MODE_ADHOC; spotted by: Greg <gonufer@gmail.com>.

2004-12-21  Colin Walters  <walters@redhat.com>

	* configure.in: Correct named detection.

2004-12-21  Colin Walters  <walters@redhat.com>

	* src/NetworkManager.c (nm_data_new): Initialize named.
	Also, set up a signal handler for SIGINT/SIGTERM, and exit
	the mainloop when these signals are received.
	(nm_data_free): Unref named.
	(sigterm_handler, sigterm_pipe_handler): New functions for
	exiting mainloop.
	
	* src/NetworkManagerMain.h (NMData): Add signal handling and
	nameserver bits.

	* src/NetworkManager.c (nm_device_unref): Quit device mainloop on
	unref.

	* src/NetworkManagerDHCP.c (set_nameservers): New function;
	set nameservers from DHCP response data.
	(set_domain_search): Set domain search from DHCP response.
	(nm_device_dhcp_configure): Invoke them.

	* src/NetworkManagerSystem.c
	(nm_system_device_update_resolv_conf): Delete.  Deleting
	code is totally sweet.

	* src/Makefile.am (NetworkManager_LDADD): Add libnamed.

	* named/nm-named-manager.h, named/nm-named-manager.c: New files;
	implements an object which controls a nameserver.  Currently
	uses bind 9.

	* configure.in: Check for named.

	* Makefile.am (SUBDIRS): Add named dir.

	* named/named.conf: New template config file.

2004-12-20  Colin Walters  <walters@redhat.com>

	* src/NetworkManagerPolicy.c (nm_policy_get_best_device): Fix usage of '=='
	instead of '='.

2004-12-17  Dan Williams  <dcbw@redhat.com>

	* Ad Ad-Hoc networking mode support.  In Ad-Hoc mode, we only try to get
		link-local addresses instead of doing DHCP.

	* In the panel applet, there's a new "Create new Wireless Network..." item

	* The panel applet also sticks around now even if NetworkManager dies, but
		it doesn't hide its icon when NM isn't around.  Not hiding the icon is
		a bug, I'll fix that later.

	* We also don't use 'nscd' anymore in the RH backend, it was impeding name
		lookups after a switch rather than actually doing them.

	* Clean up some of those warnings in nm_ap_list_* functions

	* Delay between scans changed to 15s instead of 10s

2004-12-15  Dan Williams  <dcbw@redhat.com>

	Patch from Tom Parker
	* Add autoip/Link Local Addressing support when we fail to get a DHCP
		address

	* Longer pause after setting ESSID on cards that support a larger number
		of channels to give the card time to find the right channel

	* Add system hook to restart mDNSResponder (or whatever the local implementation
		of Multicast DNS is) when we activate interfaces

2004-12-15  Dan Williams  <dcbw@redhat.com>

	* Rework the DHCP code again to revert to sending full ethernet frames
		rather then relying on the kernel to do the right thing with our
		packets.

2004-12-06  Dan Williams  <dcbw@redhat.com>

	* dhcpcd/client.c
		- Fix some minor errors in dhcp_handle_transaction() that caused
			unexpected early timeouts of DHCP transactions

	* dhcpcd/client.h
		- DHCP retransmit time from 4s -> 5s

2004-12-05  Dan Williams  <dcbw@redhat.com>

	* Major rework of the DHCP code, taking some cues from pump.  We don't
		write raw Ethernet packets anymore, which simplifies the code quite
		a bit.  The new code should be more robust, not hang in recvfrom()
		as much, and generally work better.  This also means that we need
		to force HAL/dbus to use a created GMainContext rather than the
		default context, since having the DHCP renew/rebind thread using
		its own GMainContext seemed to give dbus a fit.  There is also more
		debugging information printed from the DHCP loop to help with future
		problems.

	* Also, if the DHCP server doesn't give us the "routersOnSubnet" option,
		assume that the default gateway should be the DHCP server.

	Patch from Matthew Schick <matt oss-institute org>
	* src/backends/NetworkManagerGentoo.c
		- Fix compilation error due to missing "ip4_broadcast"

2004-12-03  Dan Williams  <dcbw@redhat.com>

	* initscript/Makefile.am
	* initscript/Debian/NetworkManager
	* initscript/Gentoo/NetworkManager
	* initscript/RedHat/NetworkManager
	* initscript/NMLaunchHelper.c
		- Remove NMLaunchHelper, if you need to wait until the network
			comes up, use the dead code from CVS.

2004-12-01  Colin Walters  <walters@redhat.com>
	
	* configure.in: Suck in gcc warnings code from Rhythmbox,
	but use fewer default flags, and in particular add -Wno-unused,
	since the codebase has a lot of unused variables.

	* test/nmtestdevices.c (create_device): 
	* test/nminfotest.c (get_network_string_property) 
	(get_networks_of_type): 
	* test/nmclienttest.c (main): 
	* src/NetworkManagerDbus.c (nm_dbus_create_error_message): 
	* initscript/NMLaunchHelper.c (get_nm_status): 
	* info-daemon/NetworkManagerInfoPassphraseDialog.c (update_button_cb): 
	* info-daemon/NetworkManagerInfoDbus.c (nmi_dbus_create_error_message): 
	Fix declarations after statements.

2004-12-01  Colin Walters  <walters@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c (nmi_dbus_return_vpn_password): New method.
	(nmi_dbus_get_vpn_userpass): New method.
	(nmi_dbus_nmi_message_handler): Invoke it.

	* info-daemon/NetworkManagerInfoDbus.h (nmi_dbus_return_vpn_password): Prototype.

	* info-daemon/NetworkManagerInfoVPN.h,
	info-daemon/NetworkManagerInfoVPN.c: New files; responds
	to requests for VPN passwords.

	* configure.in (GNOME_KEYRING_LIBS): Check for gnome-keyring.

2004-12-01  Colin Walters  <walters@redhat.com>

	* test/nmtestdevices.c, test/nmclienttest.c: Add missing
	includes.

2004-12-01  Colin Walters  <walters@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
	(nmwa_dbus_update_active_device_strength): Fix missing
	return value.

2004-12-01  Colin Walters  <walters@redhat.com>

	* panel-applet/NMWirelessApplet.c: Add missing include.

2004-12-01  Colin Walters  <walters@redhat.com>

	* src/NetworkManagerWireless.c (nm_wireless_qual_to_percent):
	Remove useless CLAMP (); the value is unsigned, and the case tests
	qual->qual < 100, so the value must always be between 0 and 100.

2004-12-01  Colin Walters  <walters@redhat.com>

	* dhcpcd/buildmsg.c, dhcpcd/dhcp_test.c: Add missing includes.

2004-11-22  Colin Walters  <walters@verbum.org>

	* src/backends/NetworkManagerRedHat.c (nm_system_update_dns): Run
	"nscd -i hosts" to invalidate the host cache instead of restarting nscd,
	which is essentially a noop since nscd caches hosts on disk too.
	
2004-11-22  Colin Walters  <walters@redhat.com>

	* src/Makefile.am (NetworkManager_SOURCES): Add
	NetworkManagerDevicePrivate.h.

2004-11-22  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevicePrivate.h
		- Split out the NMDevice struct to a different file so that stuff like
			NetworkManagerDHCP.c and NetworkManagerSystem.c can use it

	* dhcpcd/client.c
		- fprintf->syslog
		- (dhcpSendAndRecv): do non-blocking sends and receives, and check to see if we
			need to cancel the dhcp request during the send and recv

	* dhcpcd/client.h
		- Move the DHCP option enum to dhcpcd.h

	* src/NetworkManagerDHCP.c
		- Split out the actual IP/netmask/etc setting code
		- New Renew/Rebind functions
		- New timer setup function for renew/rebind operations

	* src/NetworkManagerDevice.c
		- For device activation, if we are using DHCP then keep the activation thread
			alive until device deactivation.  We need to renew/rebind the DHCP address
			after the T1 (renew) and T2 (rebind) times have expired.
		- Increase some timeouts after bringing wireless cards up/down

2004-11-17  Dan Williams <dcbw@redhat.com>

	* Cache access point MAC addresses in NetworkManagerInfo after you've explicitly
		connected to them.  Then, after a scan, match up non-ESSID-broadcasting access
		points with any cached MAC addresses from NetworkManagerInfo.  Allows us to
		show known access points that don't broadcast their ESSID in the menus without
		any user intervention whatsoever.

	* info-daemon/NetworkManagerInfoDbus.c
		- (nmi_dbus_get_network_addresses, nmi_dbus_add_network_address): new functions
			for dbus method calls "getNetworkAddresses" and "addNetworkAddress"

	* src/NetworkManagerAP.[ch]
		- Add a "user_addresses" data member to the NMAccessPoint structure
		- (nm_ap_get_user_addresses, nm_ap_set_user_addresses): new functions for accessing
			the user_addresses data member

	* src/NetworkManagerAPList.c
		- (nm_ap_list_get_ap_by_address): check user_addresses list too, instead of just
			the AP's reported address
		- (nm_ap_list_update_network): grab the user_addresses list from NetworkManagerInfo

	* src/NetworkManagerDHCP.c
		- Increase DHCP timeout from 25s -> 30s

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_get_network_addresses, nm_dbus_add_network_address): have NMI get/set
			user addresses

	* src/NetworkManagerDevice.c
		- (nm_device_set_wireless_config): bring down the interface, wait 4s, bring it up,
			wait 2s, then configure it.  Sometimes Prism54 cards will freeze up with
			"mgnt tx queue full", seemingly in response to NM controlling the card too much.
			So, we take the card down to clear it out.
		- (nm_device_do_normal_scan): Copy over AP ESSIDs from the allowed access point list
			too, since that's where the user_addresses are

	* src/NetworkManagerPolicy.c
		- (nm_state_modification_monitor): Tell NMI to add an AP's hardware address to
			that wireless networks' user_addresses list upon successful activation

2004-11-16  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.[ch]
		- (nm_device_clear_activation_fail): new function

	* src/NetworkManagerPolicy.c
		- (nm_state_modification_monitor): clear the activation_failed flag on devices
			when we've dealt with the failure so the user doesn't get failure-dialog-spammed

2004-11-16  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_activate_wireless): Unref best_ap upon success so we don't
			leak the structure, better updating of now_scanning status
		- (nm_device_wireless_network_exists): Rewrite for better/faster checking

2004-11-15  Dan Williams <dcbw@redhat.com>

	Major rework of link detection code.  We now use DHCP
	as part of the link detection which proves to be much more robust,
	and also supports Open System authentication for wireless networks.

	We no longer use external DHCP client programs.  Instead, we use 
	our own DHCP client, based on substantially reworked bits of 'dhcpcd'
	which was written by:
		Yoichi Hariguchi <yoichi@fore.com>
		Sergei Viznyuk <sv@phystech.com>
		http://www.phystech.com/download/
	It resides in the "dhcpcd" directory and was refactored into a general
	purpose DHCP client library by me.

	Also misc fixes (CPPFLAGS->AM_CPPFLAGS, move some stuff around),
	move src/backends/NetworkManagerSystem.h -> src/NetworkManagerSystem.h

2004-11-15  Dan Williams <dcbw@redhat.com>

	Patch from Tom Parker <palfrey@tevp.net>:

	* src/NetworkManagerDevice.c
		- Less output to console when no access
			points are found during a scan

2004-11-15  Dan Williams <dcbw@redhat.com>

	Patch from Tom Parker <palfrey@tevp.net>:

	* src/backends/interface_parser.c
		- Use g_strdup ()
		- Check for inp == NULL
		- use syslog ()

2004-11-13  Colin Walters  <walters@redhat.com>

	Patch from Tom Parker <palfrey@tevp.net>:

	* src/Makefile.am (CPPFLAGS): Switch to AM_CPPFLAGS.
	
	* src/backends/NetworkManagerRedHat.c: Switch to
	including shvar.h instead of shvar.c.

	* src/backends/NetworkManagerDebian.c: Don't include
	interface_parser.c in source file.

	(libnmbackend_la_SOURCES): Don't include shvar.[ch]
	and interface_parser.[ch].
	* src/Makefile.am (libnmbackend_la_SOURCES) <TARGET_REDHAT>:
	Include shvar.c and shvar.h here.
	(libnmbackend_la_SOURCES) <TARGET_DEBIAN>: Include
	interface_parser.c and interface_parser.h here.

2004-11-12  Colin Walters  <walters@redhat.com>

	* configure.in: Strip out TARGET_DISTRO and
	SYSTEM_BACKEND_FILE variables.  Switch to Automake
	conditionals.

	* src/Makefile.am (noinst_LTLIBRARIES): Add libnmbackend.la.
	(libnmbackend_la_SOURCES): Use Automake conditionals
	to add distro-specific files.

	* initscript/Makefile.am (SUBDIRS): Update to
	use conditionals.

2004-11-12  Colin Walters  <walters@redhat.com>

	Patches from j bootlab org

	* src/Makefile.am (EXTRA_NetworkManager_SOURCES): 
	Add interface_parser.[ch].

	* src/backends/NetworkManagerDebian.c (nm_system_device_run_dhcp): Invoke
	dhclient with "-lf /var/lib/dhcp/dhclient-%s.leases".

2004-11-12  Colin Walters  <walters@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c (nmi_dbus_service_init): Delete
	call to nmi_dbus_is_running too, not necessary anymore.
	* info-daemon/NetworkManagerInfoDbus.c: Include stdlib.h to
	pick up exit().

2004-11-11  Colin Walters  <walters@verbum.org>

	* info-daemon/NetworkManagerInfoDbus.c (nmi_dbus_is_running):
	Delete.
	(nmi_dbus_service_init): Call dbus_bus_acquire_service with
	the DBUS_SERVICE_FLAG_PROHIBIT_REPLACEMENT flag, and
	then check the result for DBUS_SERVICE_REPLY_SERVICE_EXISTS.
	This avoids a race condition that made it pretty easily
	possible to get two NetworkManagerInfo daemons running.

2004-11-11  Colin Walters  <walters@verbum.org>
	
	* src/NetworkManager.c (main): Use daemon(3).

	* info-daemon/NetworkManagerInfo.c (main): Ditto.

	* dispatcher-daemon/NetworkManagerDispatcher.c (main): Ditto.

2004-11-10 Dan Williams <dcbw@redhat.com>

	Patches from j bootlab org
	* src/NetworkManagerDevice.c
		- (nm_device_activate_wireless): wait 5 seconds before attempting to detect
			whether the card has a link or not, some cards are slow
		- (nm_device_activation_configure_ip): make ipv6 work a bit better

	* info-daemon/NetworkManagerInfoPassphraseDialog.c
		- Disable the "Login" button on the passphrase dialog until the user
			enters a valid passphrase or key

	Patches from Tom Parker <palfrey tevp net>
	* src/backends/NetworkManagerDebian.c
		- Add static IP support to the debian backend

	* src/backends/interface_parser.[ch]
		- Parse debian interface config files

2004-11-08 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Some random fprintf->syslog conversions
		- (nm_device_wireless_network_exists): double-check for network
		- (nm_device_find_and_use_essid): Copy over encryption key no matter what

	* src/NetworkManagerWireless.[ch]
		- (nm_wireless_[128|64]bit_ascii_to_hex): make "ascii" argument unsigned again
			so that the binary->ascii conversion works (if unsigned, the bitshift
			will fill with zeros, which is what's required).  Also mask bitshift
			result with 0xF for futher assurance.

2004-11-06 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerUtils.c
		- (nm_get_wireless_driver_support_level): default to
			FULLY_SUPPORTED rather than UNSUPPORTED, forgot to
			flip this when changing from whitelist->blacklist of
			wireless drivers

2004-11-05 Dan Williams <dcbw@redhat.com>

	Patch from Robert Paskowitz:
	* src/backends/NetworkManagerGentoo.c
		- Update static IP config code

2004-11-05 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
	  src/NetworkManagerDbus.[ch]
	  src/NetworkManagerDevice.c
		- Keep track of the # of attempts to get the WEP key
			from the user and pass that along to the info daemon

2004-11-05 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerUtils.c
		- Blacklist wireless cards rather than whitelisting them.
		- Grab driver name from HAL rather than trying to find it
			ourselves.

2004-11-03 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletOtherNetworkDialog.c,
		- Disable OK button until valid data is entered
			for encryption stuff too

	* panel-applet/NMWirelessApplet.c
		- Report card strength for current AP if the card
			doesn't report strength data for scanned access
			points

	* src/NetworkManagerDevice.c
		- Smooth out cards reported quality, Atmel card was
			intermittently reporting no quality data but soon
			recovers

	* src/NetworkManagerWireless.c
		- Better quality data percentage calculation.  Atmel
			cards (mine at least) seem to report the quality
			in percentage format already, so honor that

	Patch from <j@bootlab.org>
	* NetworkManager.h
	  info-daemon/NetworkManagerInfoPassphraseDialog.c
	  info-daemon/passphrase.glade
	  panel-applet/NMWirelessAppletOtherNetworkDialog.c
	  panel-applet/essid.glade
	  src/NetworkManagerAP.c
	  src/NetworkManagerDevice.c
	  src/NetworkManagerWireless.[ch]
		- Support ASCII WEP keys, in both 40/64 bit and 104/128 bit

2004-11-03 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.[ch]
		- (nm_device_set_enc_key): Add parameter to set Authentication
			Mode (Open System, Shared Key, or None).  We're still using
			Shared Key for now though.

2004-11-02  Bryan Clark  <clarkbw@cvs.gnome.org>

	* panel-applet/menu-info.c: change from bold text to light
	colored, may cause problems with some themes, i've tested a lot
	and they seem fine. 

	* panel-applet/NMWirelessApplet.c: fix strength tooltip

2004-11-01  Colin Walters  <walters@verbum.org>

	* src/NetworkManagerWireless.h, src/NetworkManagerWireless.c
	(nm_wireless_128bit_key_from_passphrase): Add const.

	* src/NetworkManagerAP.h, src/NetworkManagerAP.c
	(nm_ap_set_enc_key_source): Add const.
	
2004-11-01  Colin Walters  <walters@verbum.org>

	* .cvsignore: Update.

2004-10-29 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_wireless_network_exists): Actually use the encryption
			key we got from the applet when attempting to find a wireless network
		- Don't bring devices down so much since on some cards it triggers
			firmware hotplugs each time

	* src/NetworkManagerDbus.c
		- (nm_dbus_nm_set_active_device): free the passphrase we may have gotten
			from the caller

2004-10-29 Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- (nm_hal_device_property_modified): unlock a locked active
			wireless device when a wired connection gets a link.
			(Means you'll switch to wired whenever you plug in no
			matter what).

2004-10-29 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletOtherNetworksDialog.[ch]
		- New files, implement the "Other wireless network" dialog

	* panel-applet/NMWirelessApplet.c
		- Move "other wireless network" dialog to separate file

	* panel-applet/NMWirelessAppletDbus.[ch]
		- Take key and key_type paramaters for the set_device function

	* panel-applet/essid.glade
		- Add UI bits for encryption settings

	* src/NetworkManagerDbus.c
		- Retrieve key and key_type params for "setActiveDevice" method call
			and pass them on
		- unref AP returned from nm_device_get_best_ap() when needed

	* src/NetworkManagerDevice.c
		- (nm_device_get_best_ap): ref the ap before returning it
		- unref AP returned from nm_device_get_best_ap() when needed
		- (nm_device_activate_wireless): add "ap" parameter so we don't
			need to call nm_device_get_best_ap() here, it was pretty much
			redundant anyway
		- (AP_NEED_KEY): break second link check condition out into separate
			function, and fix segfault when ap->enc_key_source was NULL
		- (nm_device_find_and_use_essid): take key and key_type parameters and
			pass them along to nm_device_wireless_network_exists().  If the
			network does exist, set the passed-in key+key_type on the AP

	* src/NetworkManagerPolicy.c
		- unref AP returned from nm_device_get_best_ap() when needed

2004-10-28 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerUtils.c
		- (nm_spawn_process): Fix a potential dereference of NULL

	Patches from Peter Jones:

	* src/NetworkManagerDevice.c
		- (nm_device_test_wireless_extensions): Better check for
			wireless devices

	* src/NetworkManagerUtils.c
		- (nm_spawn_process): Pass in valid stdout and stderr so
			executed programs don't randomly SIGPIPE and fail
		- (nm_get_wired_driver_support_level): quash hal warning
			when checking for USB ethernet device

2004-10-27 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.c
	  info-daemon/NetworkManagerInfoDbus.c
	  info-daemon/NetworkManagerInfoPassphraseDialog.c
	  panel-applet/NMWirelessApplet.c
		- Properly escape gconf keys

	* src/NetworkManager.c
		- remove unused variables

	* src/NetworkManagerAP.c
		- (nm_ap_new_from_ap): Don't redundantly set new APs
			refcount since it got set in nm_ap_new()

	* src/NetworkManagerAPList.c
		- (nm_ap_list_combine): Give up ownership of newly created
			access points to the ap list, fixes memleak

	* src/NetworkManagerDevice.c
		- Remove cached_ap_list4 member since its not really needed
		- (nm_device_wireless_network_exists): Try to get correct
			encryption status of a found AP if its already in our
			device list
		- (nm_device_do_normal_scan): Clean up scanning a bit, make
			memory allocs/deallocs a bit clearer and shorter-lived

2004-10-26 Ray Strode <rstrode@redhat.com>

	* panel-applet/NMWirelessApplet.c:
	  (custom_essid_item_selected):  kill some compiler
	warnings 

2004-10-26 John (J5) Palmieri <johnp@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
		- (nmi_dbus_is_running): New function for determining if nmi is already running
		- (nmi_dbus_service_init): exit if another instance of nmi is already running

2004-10-23 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
		- Trap the "DeviceActivationFailed" signal

	* docs/NetworkManager DBUS API.txt
		- Add "DeviceActivationFailed" signal

	* panel-applet/NMWirelessAppletDbus.c
		- Quash the "NetworkManager service not available" message

	* src/NetworkManagerDbus.[ch]
		- Add the "DeviceActivationFailed" signal

	* src/NetworkManagerDevice.c
		- Add support for activation_failed flag
		- Fix deadlock where activation thread didn't clean itself up, making
			main thread still believe it was alive forever (didn't reset activation
			flags like activating, just_activated, etc when IP configuration
			failed)

	* src/NetworkManagerPolicy.c
		- Implement logic for DeviceActivationFailed signal, and when activation fails
			for wireless networks, try to fall back to some other access point

2004-10-23 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
		- Place the GtkMenuBar inside a GtkEventBox, and add the Event Box
			to the applet object, so we can get tooltips
		- Add tooltips (RH #136866)

	* src/NetworkManagerDevice.c
		- When trying to find a wireless network, try to connect with encryption
			turned on first, so that we can more accurately detect whether or not
			we need to use encryption for the actual association later on

2004-10-21 Dan Williams <dcbw@redhat.com>

	* Add some support for telling NetworkManagerInfo to tell the user
		that they are using a device that's not fully supported

	* Fix some assertions in debug messages due to null access point args

2004-10-21 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Don't try to activate/bring up/down unsupported
			devices

	* src/NetworkManagerUtils.c
		- Fix case of PCI ID checks for driver support levels

2004-10-21 Dan Williams <dcbw@redhat.com>

	* NetworkManager.h
		- New file, now contains commonly used structures and bits
			for the dbus API of NetworkManager

	* Makefile.am
		- Deliver NetworkManager.h to ${includedir}/NetworkManager

	* src/NetworkManager.h
		- Rename -> src/NetworkManagerMain.c

	* Various fixups all around to use NetworkManager.h and new
		src/NetworkManagerMain.h, remove redundant bits that got
		moved into NetworkManager.h

	* src/NetworkManagerDevice.[ch]
	  src/NetworkManagerUtils.[ch]
	  src/NetworkManagerPolicy.c
	  src/NetworkManagerDbus.c
		- Whitelist wireless drivers, and blacklist some wired
			drivers.  Also blacklist cipsec and ethernet-over-usb
			devices at this time (RH #135722, RH #135648)
		- Don't leak unsupported devices out over dbus, or allow
			them to be set as the active device.  Skip over them
			during automatic device picking

	* test/nmclienttest.c
		- Clean up the dbus code a lot

Tue Oct 19 14:20:29 2004  Jonathan Blandford  <jrb@redhat.com>

	* configure.in: post release bump.

Tue Oct 19 14:19:24 2004  Jonathan Blandford  <jrb@redhat.com>

	* configure.in:
	* NEWS: Released NetworkManager-0.3.1

2004-10-18 Dan Williams <dcbw@redhat.com>

	Patches from Thom May:
	* test/nmtestdevices.c
		- Include <string.h>
	* src/backends/NetworkManagerDebian.c:
		- (nm_system_device_run_dhcp, nm_system_device_stop_dhcp)
			(nm_system_device_flush_routes, nm_system_device_flush_addresses)
			Move to using g_strdup_printf rather than arbitrary buffers
		- (nm_system_device_setup_static_ip4_config) Implement function.
		- (nm_system_kill_all_dhcp_daemons) Use killall -q rather than killall

2004-10-17 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
		- Display name of network in the "network not found" dialog

	* panel-applet/NMWirelessAppletDbus.c
		- (nmwa_dbus_call_nm_method): new function replaces all other
			nmwa_dbus_get_[string|string_array|int|boolean] methods
		- nmwa_dbus_get_network_name() and nmwa_dbus_get_device_name()
			consolidated into nmwa_dbus_get_object_name()

2004-10-15 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDbus.c
	  info-daemon/NetworkManagerInfoDbus.c
		- Display an error dialog when the user tries to use an
			"Other wireless network" that's not found.

2004-10-15 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
		- Fix up corner cases in applet state, making it
			look more responsive.  Change state to "connecting" when
			the user is forcing a device too.

2004-10-15 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerAPList.c
		- (nm_ap_list_update_network): Disown AP after the list takes ownership

	* src/NetworkManagerDbus.c
		- (nm_dbus_nm_set_active_device): Simplify the device setting logic

	* src/NetworkManagerDevice.c
		- Disown APs after the device's AP list takes ownership

2004-10-15 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Update our applet state from the GUI thread

	* panel-applet/NMWirelessAppletDbus.c
		- Greatly simplify the locking to make the GUI thread
			smoother.  Update a private copy of the device list
			and active device and only when done talking to
			NetworkManager turn it over to the GUI thread.

2004-10-15 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerAP.[ch]
		- Add "artificial" get/set functions, set for APs that
			aren't discovered as part of a scan but instead
			discovered by force-setting the ESSID

	* src/NetworkManagerDevice.[ch]
		- (nm_device_wireless_network_exists): pass back whether
			or not the discovered AP was encrypted.  Also, try
			falling back to encrypted mode on the card if unencrypted
			association doesn't work
		- (nm_device_find_and_use_essid): If the network requested
			did in fact exists, but it wasn't in our scan list, add
			an "artificial" entry for it.  Some Cisco cards don't
			see non-ESSID-broadcasting APs in their scan but can still
			associate with them if you know the ESSID, this works around
			that behavior
		- (nm_device_do_normal_scan): Carry "artificial" APs over from scan
			to scan if the card is currently associated with that AP

2004-10-15 Dan Williams <dcbw@redhat.com>

	---- We have a website ----
	http://people.redhat.com/dcbw/NetworkManager

	Patch from Robert Paskowitz:
	* src/NetworkManager.c
		- (main): Make sure we are run as root
	* src/NetworkManagerDevice.c
		- Fix type in ad-hoc setting function

	Patch from Thom May:
	* src/backends/NetworkManagerDebian.c
		- Make Debian backend compile again

2004-10-14 Dan Williams <dcbw@redhat.com>

	* Tagged NetworkManager-0_3

2004-10-14 Dan Williams <dcbw@redhat.com>

	Patch from Robert Paskowitz:
	* NEWS
	  src/NetworkManagerDevice.[ch]
	  src/backends/NetworkManagerDebian.c
	  src/backends/NetworkManagerGentoo.c
	  src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerSlackware.c
		- Add support for grabbing and using a broadcast address
			from system config files
		- Some Gentoo backend fixes for grabbing network config
		- Fix LOG_WARN->LOG_WARNING

2004-10-14 Dan Williams <dcbw@redhat.com>

	* NEWS: a few small fixes in the credits

Thu Oct 14 19:12:58 2004  Jonathan Blandford  <jrb@redhat.com>

	* NEWS: prep for release.

Thu Oct 14 16:47:12 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
	(nmwa_dbus_update_device_wireless_networks): remove warnings.

Thu Oct 14 16:40:39 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c (animation_timeout): Make
	applet->state == APPLET_STATE_NO_NM animation.

	* panel-applet/NMWirelessApplet.c (custom_essid_item_selected):
	set the text correctly.

2004-10-14 Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- Only accept and manager 802.3 and 802.11 devices

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_nm_set_active_device): move most of the actual activation
			logic into NetworkManagerDevice.c
		- (nm_dbus_network_status_from_data): new function
		- (nm_dbus_signal_network_status_change): new function, unused for now
		- (nm_dbus_nm_message_handler): use nm_dbus_network_status_from_data () now

	* src/NetworkManagerDevice.[ch]
		- (nm_device_find_and_use_essid): new function.  Search for, and if found use,
			a random ESSID.

2004-10-14 John (J5) Palmieri <johnp@redhat.com>

	* info-daemon/NetworkManagerInfo.c 
		- (main): Added session management

2004-10-14 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.[ch]
		- Expose network_device_[un]ref()
		- Expose wireless_network_[un]ref()
		- (wireless_network_new_with_essid): new function, create and return
			a wireless network with a particular essid

	* panel-applet/NMWirelessApplet.c
		- Hook up the "other network" dialog to do something

Wed Oct 13 19:31:53 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c: Add an essid dialog.  It
	doesn't work yet, but it looks okay.

	* panel-applet/icons/*png: Resize to 22x22 and install in the
	right place.

2004-10-13 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Add function to print out applet_state in a readable
			manner

	* src/NetworkManager.c
		- (main): Don't segfault when nm_dbus_init() fails, we had
			a left-over call to hal_shutdown() into which we passed NULL

	* src/NetworkManagerAP.c
		- (nm_ap_set_essid): Allow NULL essids

	* src/NetworkManagerAPList.[ch]
		- More use of nm_ap_list_[un]lock ()
		- (nm_ap_list_get_ap_by_essid): don't warn when looking for a NULL
			network/essid, just return nothing.  Also skip over NULL
			essid access points in the list when searching
		- (nm_ap_list_get_ap_by_address): new function
		- (nm_ap_list_update_network): set the access point's key source to
			NULL when the key returned from NetworkManagerInfo is NULL or
			of 0 length
		- nm_ap_list_update_keys() -> nm_ap_list_update_properties(), and
			copy timestamp over too
		- (nm_ap_list_copy_essids_by_address): new function, attempt to
			find the correct ESSID for a blank-essid access point by searching
			through another list and matching access point MAC addresses
		- (nm_ap_list_diff): exclude blank-essid access points from the diffs

	* src/NetworkManagerDbus.c
		- (nm_dbus_nm_set_active_device): deal with random networks the user
			may specify.  This is mainly for access points that don't
			broadcast their essid.  So if the user tells us to associate with
			some random ESSID that's not in our access point list, we find
			out if the access point does in fact exist (by attempting association
			and then matching that access point's MAC address with the essid the
			user gave us) and then we switch to it.
		- (nm_dbus_devices_handle_request): don't add blank-essid access points
			to the returned list of networks for the "getNetworks" method

	* src/NetworkManagerDevice.[ch]
		- Extra debugging info for link detection
		- (nm_device_ap_list_get_ap_by_address): new function, return an AP
			based on MAC address
		- (nm_device_get_path_for_ap): ignore blank-essid access points
		- (nm_device_wireless_network_exists): new function, find out whether
			a random ESSID exists by attempting to associate with it
		- (nm_device_do_normal_scan): allow blank-essid access points in our
			device list as long as they have an AP MAC address we can use.
			Also send WirelessNetwork[Dis]Appeared signals for non-active
			devices too.  Lets the applet update more frequently.

	* src/backends/NetworkManagerGentoo.c
		- Patch from: Robert Paskowitz
			- Update backend code for Gentoo
			- Implement nm_system_device_update_config_info ()

	* test/nmclienttest.c
		- (set_network_device): new function, takes a command-line argument
			and tells NetworkManager to use that wireless network

Wed Oct 13 John (J5) Palmieri <johnp@redhat.com>

	* info-daemon/NetworkManagerInfo.c (nmi_spawn_notification_icon): Stop respawning
	if the notification icon crashes 5 times within 5 seconds of each respawn 

Tue Oct 12 22:53:04 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c (nmwa_update_state): remove
	g_print.

Tue Oct 12 22:44:15 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.h: Change the name of the icons.

	* panel-applet/NMWirelessApplet.c: (animation_timeout),
	(nmwa_update_state), (nmwa_destroy), (nmwa_setup_widgets),
	(nmwa_icons_free), (nmwa_icons_load_from_disk), (nmwa_icons_init):
	Change the name of the icons.

	* panel-applet/menu-info.c: (nm_menu_wired_class_init),
	(nm_menu_wired_expose_event), (nm_menu_network_class_init),
	(nm_menu_wireless_class_init), (nm_menu_wireless_new),
	(nm_menu_wireless_expose_event): Really bad hack to get the style
	to draw in the right color.

Tue Oct 12 John (J5) Palmieri <johnp@redhat.com>

	* info-daemon/NetworkManagerInfo.c (main):  Add child watch to respawn
	Notification if it crashes

Fri Oct  8 07:19:55 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c (nmwa_dbus_get_double): 
	(nmwa_dbus_get_string): remove unused functions

	* panel-applet/NMWirelessApplet.c (nmwa_about_cb):
	(nmwa_cancel_timeout), (nmwa_get_menu_pos), (nmwa_factory):
	remove unused functions

	* panel-applet/NMWirelessApplet.c: Rewrite icon code.

2004-10-12 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- New functions:
			wireless_network_new
			wireless_network_copy
			network_device_new
			network_device_copy

	* src/NetworkManagerDevice.[ch]
		- New functions:
			nm_device_set_mode_managed
			nm_device_set_mode_adhoc
		- Use these functions where appropriate
		- When creating a new wireless device, force the card
			to managed/Infrastructure mode as soon as possible

2004-10-12 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- Force wireless cards into Infrastructure mode before we use them

2004-10-12 Dan Williams <dcbw@redhat.com>

	* TODO
		- Remove bit about static IP address support

	* src/NetworkManagerUtils.c
		- (nm_spawn_process): Add some error reporting

	* src/NetworkManagerDevice.c
		- (nm_device_activation_configure_ip): hook up to the static config
			routines in the backends

	* src/backends/NetworkManagerRedHat.c
		- (nm_system_device_update_config_info): use shvar.c routines to
			parse the config file iformation, not our own
		- (nm_system_device_setup_static_ip4_config): new function, based
			heavily on 'ifup' script and 'ipcalc' tool code.  Set up a device
			with a static IP address and gateway

	* src/backends/shvar.[ch]
		- Parser (filched from initscripts package) for ifcfg-* files

	* src/backends/NetworkManagerSystem.h
	  src/backends/NetworkManagerGentoo.c
	  src/backends/NetworkManagerDebian.c
	  src/backends/NetworkManagerSlackware.c
		- Stub nm_system_device_update_config_info() and nm_system_device_setup_static_ip4_config()

2004-10-11 Dan Williams <dcbw@redhat.com>

	* TODO
		- Remove bit about more robust AP diffing since I just implemented it

2004-10-11 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerAP.c
		- (nm_ap_new, nm_ap_new_from_ap): Don't crash when we don't have
			enough RAM to allocate new AP structures, but return NULL instead

	* src/NetworkManagerAPList.[ch]
		- (nm_ap_list_is_empty): new function
		- (nm_ap_list_combine): new function, combine two access point lists
		- (nm_ap_list_copy_keys): new function, copy keys from one list
			into another

	* src/NetworkManagerDevice.[ch]
		- Rename some functions to be clearer:
			nm_device_get_best_ap_frozen -> nm_device_is_best_ap_frozen
			nm_device_just_activated     -> nm_device_is_just_activated
			nm_device_activating         -> nm_device_is_activating
			nm_device_now_scanning       -> nm_device_is_scanning
		- Cache the last 4 scans so that the access point list is more stable.
			We combine the lastest two scans and use that as the AP list,
			and diff that combined list against the combination of the earliest
			two cached scans for the WirelessNetworkAppeared/Dissappeared signals

2004-10-08 John (J5) Palmieri <johnp@redhat.com>

	* info-daemon/NWManagerInfo.h
		- (struct NetworkManagerInfo): add shutdown_timeout GSource

	* info-daemon/NWManagerInfoDbus.c
		- (shutdown_callback): new function
		- (nmi_dbus_filter): Create a 30 second timeout until shutdown
			if NetworkManager goes away.  Kill the timeout
			if NetworkManager restarts before the 30 seconds
			are up.
		- (nmi_dbus_service_init): 
			- call gtk_main_quit if NetworkManager is not running
			- add filters to monitor dbus service creations and
				deletions
	
2004-10-08 John (J5) Palmieri <johnp@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- (nmwa_update_state): Hide notification icon if we are only
			showing one wired card and no wireless interfaces 
			(Red Hat Bug #134895)

	* panel-applet/NMWirelessAppletDbus.c
		- (nmwa_dbus_filter): changed exit to gtk_main_quit ()

	* info-daemon/NWManagerInfo.c
		- (main): Terminated the notification_icon_cmd array with a NULL

2004-10-08  Hendrik Brandt  <hebra@cvs.gnome.org>

	* configure.in (ALL_LINGUAS): Added de (German).

2004-10-08 Dan Williams <dcbw@redaht.com>

	* src/NetworkManagerDevice.c
		- Be a bit more robust about link checking, ie make sure that
			the WEP key we were given actually has some data in it

2004-10-08 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.c (main):
		- Initialize GError object to NULL

2004-10-08 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- Die if NetworkManagerInfo dies, since it manages our lifetime

2004-10-08 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.[ch]
	  info-dameon/NetworkManagerInfoDbus.[ch]
	  info-daemon/NetworkManagerInfoPassphraseDialog.[ch]
		- Preserve original label text in the passphrase dialog so that
			it actually gets updated with the new network name the next
			time around.  Previously, we were overwriting it so you'd get
			the wrong network name to enter a key for
		- Add a "Key Type" combo to the passphrase dialog, user selects
			encryption key type now, type is stored in GConf too
		- Adjust NM<->NMI DBUS protocol to pass the key type back to NM too

	* src/NetworkManagerAP.[ch]
		- Remove all the encyption method magic.  It's now set by the user
			and NetworkManager retrieves the type of encryption key from
			NetworkManagerInfo

	* src/NetworkManagerAPList.[ch]
	  src/NetworkManagerDbus.[ch]
		- Adjust to new way of setting encryption key and method
		- Pull encryption method down from NMI along with key

	* src/NetworkManagerDevice.[ch]
		- Removed encryption method fallback magic as the method is now
			determined by the user.  This greatly simplifies the connection
			logic.
		- More robust connection/link logic.  Besides removing the encryption
			method fallback magic, check whether or not the card is receiving
			invalidly encrypted packets, which usually indicates that we have
			a bad WEP key set.
		- Don't blindly forge ahead when DHCP fails (still not completely fixed)

	* test/nminfotest.c
		- Test out new "Key Type" stuff in the NMI passphrase dialog

2004-10-07 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.conf
		- Allow root user to run NMI too

2004-10-06 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.[ch]
	  src/NetworkManagerDbus.c
	  doc/NetworkManager DBUS API.txt
		- Add a new status tag "scanning", which is set when there
			is no active network connection, but NetworkManager is
			looking for an access point to associate with

	* panel-applet/main.c
		- Cast the applet appropriately for gtk_widget_show_all ()

Mon Oct  4 12:55:41 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/eggtrayicon.[ch]:
	* panel-applet/main.c: Add missing file

2004-10-04 Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.[ch]
		- Add a slightly more robust method of determining if the WEP key
			is correct or not, by checking the WEP-discarded packet count
			on the card

	* info-daemon/NetworkManagerInfo.c
		- (nmi_gconf_notify_callback): Fix GConf essid escaping, should
			un-escape values we pull out rather than escaping them

2004-10-03  Marcel Telka  <marcel@telka.sk>

	* configure.in (ALL_LINGUAS): Added sk.

Fri Oct  1 18:26:03 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/menu-info.c (nm_menu_wired_class_init): update look
	and feel.  We should be back to working, and have a good, clean
	look.

2004-09-30 Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.c
	  info-daemon/NetworkManagerInfoDbus.c
	  test/nminfotest.c
		- Escape ESSIDs in gconf

	* src/NetworkManagerDevice.c
		- Fix pseudo-scanning to use netowrk list from info daemon

Wed Sep 29 18:18:24 2004  Jonathan Blandford  <jrb@redhat.com>

	* configure.in: Add a temporary --enable-notification-icon.  This
	will prolly go away.

	* info-daemon/Makefile.am:
	* info-daemon/NetworkManagerInfo.c:
	* info-daemon/NetworkManagerInfo.h: Use a notification icon.

	* panel-applet/Makefile.am:
	* panel-applet/NMWirelessApplet.c: Turn into a notification icon
	* panel-applet/NMWirelessApplet.h:

Tue Sep 28 16:35:20 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c: Fix deadlock.  Add a separator
	before 'select custom ESSID'.

	* panel-applet/menu-info.c: Start rewrite for better headers.  Not
	fully complete, but syncing in prep for merge.

	* panel-applet/icons/*png: New images

2004-09-28 Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
	  src/NetworkManagerDevice.c
	  src/NetworkManagerPolicy.c
		- Don't blow away an active wired connection on startup

2004-09-28  Bryan Clark  <clarkbw@cvs.gnome.org>

	Changes from J5
	
	* info-daemon/NetworkManagerInfo.conf: fixed own permissions

	* info-daemon/NetworkManagerInfoDbus.c: added service name to
	syslog output

Wed Sep 22 14:19:48 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c: Only add essid's if we actually
	have a wireless card.

Wed Sep 22 14:05:48 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c: move the custom essid item.
	Also, get the right device strings.

Wed Sep 22 13:51:45 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/menu-info.c (nm_menu_network_draw_indicator): Flip
	the logic to make this right.

	* panel-applet/NMWirelessApplet.c (sort_networks_function): sort
	devices so that wired networks are always first.

2004-09-22    <clarkbw@cvs.gnome.org>

	* initscript/Debian/.cvsignore:
	* initscript/Slackware/.cvsignore:
	Added new cvsignores for Makefile, Makefile.in
	
	* test/.cvsignore:
	Added nmtestdevices
	
	* src/NetworkManagerDevice.c: 
	* src/NetworkManager.c: 
	Updated the wireless/wired HAL device strings from net.ethernet to
	net.80203 or net.80211 depending on wired or wireless respectively
	
	* examples/python/NetworkManager.py: 
	s/Quality/Strength/

	* examples/python/systray/network_tray.py:
	Lots of little changes and fixes.  been rotting for a while so I
	figured I'd finally sync them all with CVS

Tue Sep 21 18:05:34 2004  Jonathan Blandford  <jrb@redhat.com>

	* configure.in: Add graphics

	* panel-applet/Makefile.am: Add graphics

	* panel-applet/icons/*: Add graphics

	* panel-applet/NMWirelessApplet.c: Use new menu times to display
	the icons fully lined up.

	* panel-applet/menu-info.c: 
	* panel-applet/menu-info.h: Add another menu type.

Fri Sep 17 14:04:34 2004  Jonathan Blandford  <jrb@redhat.com>

	* panel-applet/NMWirelessApplet.c: Redo the menu item code.

	* panel-applet/menu-item.[ch]: Wireless menu item.

2004-09-15  John (J5) Palmieri <johnp@redhat.com>

	* info-daemon/NetworkManagerInfo.conf
		- Created a more robust security policy for the DBus service
			- everything is denied by default
			- root can own and send to the service
			- users logged in at the console can send to the service

2004-09-13  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_get_essid): use iw_get_basic_config() rather than
			iw_get_ext (SIOCGIWESSID) since prism54 cards don't like
			the latter

2004-09-13  Dan Williams <dcbw@redhat.com>

	* TODO: fix typo

	* docs/NetworkManager DBUS API.txt
		- Update for new signal strength changes

	* panel-applet/NMWirelessApplet.c
		- Make panel icon show strength of the current connection
		- Cleanups and memleak fixes

	* panel-applet/NMWirelessApplet.h
		- Add data members for signal strength on devices and networks

	* panel-applet/NMWirelessAppletDbus.c
		- Free more DBusErrors
		- Update for new signal strength changes
		- Make devices and networks more like real objects, use ref/unref methods
		- Actually unlock the mutex when updating the active device

	* src/NetworkManagerAP.c
		- Change AP functions and data members from "quality"->"strength"

	* src/NetworkManagerDbus.c
		- Kill "getMaxQuality" and "getQuality" methods
		- Add "getStrength" methods for Networks and Devices

	* src/NetworkManagerDevice.[ch]
		- Add accessors for device strength
		- Add functions to update strength for a device.  Note that not all drivers
			actually support signal strength for scanned access points (Atmel drivers
			being one)
		- Calculate signal strength for each AP during scan

	* src/NetworkManagerWireless.[ch]
		- Add function to return signal strength % from a device and a raw quality struct

	* test/nmclienttest.c
		- Update for new signal strength changes

2004-09-11  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- Fix race condition between initscripts and NM on card insertion
			which could cause a card to keep an IP address and routes around
			even when it was not the active device

	* src/NetworkManagerDbus.c
		- Fix compile errors, free more DBusErrors

2004-09-11  Dan Williams <dcbw@redhat.com>

	* docs/NetworkManager DBUS API.txt
		- Add an explanation of NM's API

	* src/NetworkManagerDbus.c
		- Free some more DBusErrors if needed

2004-09-11  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
	  panel-applet/NMWirelessAppletDbus.c
		- Start using NetworkDevice/WirelessNetwork structures in more places
		- Update for unified device/network forcing in NetworkManager

	* src/NetworkManager.c
		- some code consolidation

	* src/NetworkManagerDbus.c
		- (nm_dbus_nm_set_active_device): "setActiveDevice" now takes either one
			or two arguments:  the first is the NM ID of the device to switch to,
			and the second (optional) argument is the ESSID of a wireless network
			to use as well.
		- Get rid of "setNetwork" method due to above change

	* src/NetworkManagerDevice.c
		- (nm_device_new): perform scan and update best AP on device creation
		- nm_device_activation_cancel_if_needed()->nm_device_activation_should_cancel()
		- nm_device_activation_signal_cancel()->nm_device_activation_cancel(), and
			spin waiting for cancellation to finish before returning

	* src/NetworkManagerPolicy.c
		- Changes here clarify the situations in which a device switch occurs, and 
			make sure to keep using a forced device and network if the user gives
			us one
		- Remove old unused code

2004-09-11  Martin Willemoes Hansen  <mwh@sysrq.dk>

	* configure.in: Added Danish (da) to ALL_LINGUAS.

2004-09-09  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- Pull fresh devices and networks from NM when wireless networks
			change.  Provides faster feedback of a forced wireless network

	* src/NetworkManagerDbus.c
		- Return error when "getMaxQuality" is called on a wired device
		- Make best_ap freezing actually work again, and signal cancellation
			of activation if there's already a device activation when the user
			freezes the best_ap

	* src/NetworkManagerDevice.c
		- Don't clear out the best_ap for wireless devices when the link goes
			down, that's done elsewhere
		- Kill any dhcp daemons when cancelling device activation since they
			may be stuck waiting for a DHCP address, and since we're cancelling
			activation we don't care about that anymore

	* src/NetworkManagerPolicy.c
		- Make sure to unref the device we ref earlier (we refed it to make sure
			it stuck around during device activation and such)
		- If we were going to change the best device, but its activating currently
			(and therefore the change didn't occur due to the check earlier)
			we mark the state changed to we come back to it later when device
			activation has canceled and its no longer activating

	* src/backends/NetworkManagerRedHat.c
		- SIGKILL dhcp daemons rather than SIGTERM-ing them

2004-09-09  Bryan Clark  <clarkbw@cvs.gnome.org>

	* info-daemon/passphrase.glade: 
	set passphrase input to activates_default : True

	* examples/python/systray/network_tray.py
	(network_tray.sort_networks):

	Added support for having wireless always scanning

2004-09-09  Dan Williams <dcbw@redhat.com>

	NOTE: this commit changes the behavior of wireless devices in
	NetworkManager.  They are now up all the time, scanning all
	the time.  Only the active device has an IP address and routing
	information set up however.  Also, NetworkManager will no longer
	opportunistically switch wireless networks when a better one
	comes in range, it will remain associated with one wireless network
	until that one drops out.

	* panel-applet/NMWirelessApplet.c
	  panel-applet/NMWirelessAppletDbus.c
		- List all wireless cards and their respective networks

	* src/NMLoadModules
		- Use full path to /sbin/ip

	* src/NetworkManager.c
		- Keep wireless devices up all the time so they can scan

	* src/NetworkManagerDbus.c
		- On a WirelessNetworkUpdate signal from NMI, don't update
			the "best" AP

	* src/NetworkManagerDevice.c
		- (nm_device_set_link_active): clear out the best ap for
			wireless devices when the link is set to FALSE
		- Scan on all wireless cards, all the time
		- (nm_device_activation_worker): split out the wireless card
			link-waiting code to a separate function
		- Keep wireless cards up even if device activation fails
		- Don't update the "best" ap as much

	* src/NetworkManagerPolicy.c
		- Don't update the best ap when checking if its frozen,
			let link checking clear out a frozen best ap for us

	* src/NetworkManagerWireless.c
		- Scan on all wireless cards, all the time

2004-09-09  Francisco Javier F. Serrador  <serrador@cvs.gnome.org>

	* configure.in: Added 'es' (Spanish) to ALL_LINGUAS.

2004-09-09  Ankit Patel <ankit@redhat.com>

	* configure.in: Added 'gu' (Gujarati) to ALL_LINGUAS.

2004-09-09  Pablo Saratxaga  <pablo@mandrakesoft.com>

	* configure.in: Added Walloon (wa) to ALL_LINGUAS.

2004-09-08  Bryan Clark  <clarkbw@cvs.gnome.org>

	* examples/python/NetworkManager.py: 
	added CONNECTED, CONNECTING, and DISCONNECTED states
	added methods to return number of devices of a single type

	* examples/python/systray/network_tray.py: 
	did some tweaks to get the menu looking near what it is supposed
	to look like.  Also did a Airo card hack to make it show the
	correct AP quality

2004-09-08  Dan Williams <dcbw@redhat.com>

	* panel-applet/no-networkmanager.png
	  panel-applet/Makefile.am
	  panel-applet/NMWirelessApplet.c
		- Add a "NetworkManager not running" icon and use it
		- Use new consolidated GConf keys rather than Preferred/Trusted

	* TODO: update

	* info-daemon/NetworkManagerInfo.c
	  info-daemon/NetworkManagerInfoDbus.[ch]
	  info-daemon/NetworkManagerInfoPassphraseDialog.c
		- There are now no longer two separate lists of wireless networks,
			but one list where each network is "trusted" or not trusted
		- Add a "getNetworkTrusted" dbus method
		- "WirelessNetworkUpdate" signal now sent rather than
			"PreferredNetworkUpdate/TrustedNetworkUpdate" signals
		- Start freeing some dbus errors (not completed yet)

	* info-daemon/passphrase.glade
		- Remove the "don't show" hints for pager and taskbar
		- Add a title since its going to be in the taskbar

	* src/NetworkManager.[ch]
	  src/NetworkManagerAPList.[ch]
		- There are now no longer two separate lists of wireless networks,
			but one list where each network is "trusted" or not trusted

	* src/NetworkManagerAP.[ch]
		- Add get/set "trusted" accessors and data bit

	* src/NetworkManagerDbus.[ch]
		- Add function to get "trusted" status of a network from NetworkManagerInfo
		- Trap new WirelessNetworkUpdate signal rather than old separate signals

	* src/NetworkManagerDevice.[ch]
		- Add per-device config data (ip4 addr, gateway, netmask) and accessors
		- (nm_device_new): Get device config from backend when initializing devices
		- (nm_device_activation_worker): Split out device configuration on
			activation to deal with static/dynamic IP differences, and try encryption
			fallbacks on a device if the encryption method for the best AP is not good
		- (nm_device_update_best_ap): convert to new consolidated access point lists from
			NetworkManagerInfo, and copy over latest NMI info to best_ap when setting it

	* src/NetworkManagerWireless.c
		- libgcrypt code wasn't converting the MD5 digest to an ascii string, fix it

	* src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerSystem.h
		- (nm_system_device_update_config_info): Add function to get device configuration
			from system data in ifcfg-* files

	* src/backends/NetworkManagerDebian.c
	  src/backends/NetworkManagerGentoo.c
	  src/backends/NetworkManagerSlackware.c
		- Add stub functions for getting device configuration

2004-09-07  Dan Williams <dcbw@redhat.com>

	* src/backends/NetworkManagerRedhat.c
	  src/backends/NetworkManagerSlackware.c
		- Use full path to /sbin/ip everywhere

2004-09-07  Dan Williams <dcbw@redhat.com>

	Patch from: Narayan Newton <narayan_newton@yahoo.com>

	* configure.in
	  initscript/Makefile.am
	  initscript/Slackware/Makfile.am
	  initscript/Slackware/rc.networkmanager
	  src/Makefile.am
	  src/backends/NetworkManagerSlackware.c
		- Add Slackware support

2004-09-07  Dan Williams <dcbw@redhat.com>

	Patches below from:
		<j@bootlab.org>
		Mark Roach <mrroach@okmaybe.com>
		Thom May <thom@debian.org>

	* configure.in
	  initscript/Debian/NetworkManager
	  initscript/Debian/Makefile.am
		- Initscript for Debian

	* src/backends/NetworkManagerDebian.c
		- Add missing system init function to allow compilation
			on Debian

2004-09-03  Raphael Higino <raphaelh@cvs.gnome.org>

	* configure.in: Added 'pt_BR' to ALL_LINGUAS.

2004-09-03  Akagic Amila <bono@linux.org.ba>

	* configure.in: Added 'bs' to ALL_LINGUAS.

2004-09-02  Colin Walters  <walters@verbum.org>

	* src/backends/NetworkManagerRedHat.c (nm_system_device_run_dhcp)
	(nm_system_device_stop_dhcp, nm_system_device_flush_routes): Use
	g_strdup_printf instead of arbitrarily sized buffers.

2004-09-01  Colin Walters  <walters@verbum.org>

	* NetworkManager.pc.in: New file.

	* Makefile.am, .cvsignore, configure.in: Add NetworkManager.pc.

2004-09-01  Amanpreet Singh Alam  <aalam@redhat.com>
	
	* configure.in: Punjabi(pa) is added to po/.

2004-08-31  Dan Williams <dcbw@redhat.com>

	* Remove 'debug' extern global from all files since we now
		use syslog()

	* src/NetworkManager.[ch]
		- Break out routine that get the net.interface property from HAL,
			removing that logic from nm_create_device_and_add_to_list()
		- (nm_create_device_and_add_to_list): make this a bit more general so
			it doesn't do the talking to HAL.  Also add arguments to facilitate
			the create of test devices.
		- (nm_data_mark_state_changed): rename from nm_data_set_state_modified()
		- (nm_data_new, main, nm_print_usage): add new argument "--enable-test-devices"
			which makes NetworkManager listen for dbus commands to create test
			devices, which have no backing hardware.  Use when you're on a plane
			for example, and/or forgot your wireless card at home.  Test devices
			_cannot_ be created unless NM is started with --enable-test-devices.

	* src/NetworkManagerDbus.[ch]
		- New "getLinkActive" method for devices
		- New "setLinkActive" method for devices (only works on test devices)
		- New "createTestDevice" method on NetworkManager object to create a test
			device of a specified type (ie wired, wireless).  UDI is created from
			scratch, as is the interface name.  Only works when NM is started with
			--enable-test-devices switch.
		- New "removeTestDevice" method on NetworkManager object which removes a
			test device.  Only works when NM is started with --enable-test-devices

	* src/NetworkManagerDevice.[ch]
		- Logic to facilitate test devices.  Add variables to NMDevice struct to indicate
			whether a device is a test device or not, and what its link status is.
		- Deal with test devices in most functions.  For those that work directly on hardware
			special-case test devices.
		- (nm_device_new): don't create a test device if test devices weren't enabled on the
			command-line.
		- (nm_device_update_link_active): split out logic for wired and wireless device link
			checking to separate functions to facilitate test device link checking.
		- (nm_device_set_enc_key): Since some drivers for wireless cards are daft and
			don't make a distinction between System Authentication and Encryption
			(namely Cisco aironet), we use Open System auth when setting a WEP key
			on the card.  We don't deal with Shared Key auth yet.
		- (nm_device_activation_worker): split the activation cancel check logic out into
			a separate routine nm_device_activation_cancel_if_needed()
		- (nm_device_activation_signal_cancel): rename from nm_device_activation_cancel()
		- (nm_device_fake_ap_list): Test wireless devices obviously cannot scan, so create
			a list of fake access points that they can "see"
		- (nm_device_is_test_device): return whether or not a device is a test device

	* src/NetworkManagerPolicy.c
		- (nm_policy_get_best_device): attempt to deal with wireless network selection,
			previously if you "locked"/forced NM to use a wireless device but then
			selected a wireless network for NM to use, it would switch to a wired device.
			So, if the active device is wireless and it has a "forced" best AP, use it
			if the "forced" best AP is still valid
		- (nm_state_modification_monitor): deal with NULL best devices, for example
			there were no usable network devices, or the last one was removed

	* src/backends/NetworkManager*.c
		- Deal with test devices, mostly just return success for operations like getting
			a DHCP address

	* test/nmtestdevices.c
		- Test tool to create/remove/link-switch test devices

2004-08-30  Bryan Clark  <clarkbw@cvs.gnome.org>

	* examples/python/NetworkManager.py: 
	added convience functions has_wired_device and has_wireless_device

	* examples/python/systray/network_tray.py: 
	cleaned up a bunch of cruft, added support for listing wireless
	networks just like the real applet.  This is probably all I'm
	going to work on this applet from now on.
	TODO: add support for actually changing networks and devices

	* examples/python/NetworkManager.py (NetworkManager.get_device): 
	changed "nm.networks" into a dict from a list so I can store all
	the cool information about networks in there

	* examples/python/systray/network_tray.py: 
	Added nice message when you try to run without running make first

	* examples/python/NetworkManager.py: 
	Bug fixes to the code so we get all the device information
	that we need in get_device()
	
	* examples/python/NMTester.py: 
	Fixed _print_device_list to print_device_list

2004-08-29  Seth Nickell  <seth@gnome.org>

	* configure.in:

	Actually properly setup the Debian backend in configure.
	
2004-08-29  Colin Walters  <walters@verbum.org>

	* test/nminfotest.c: Include string.h and stdlib.h.
	(get_network_string_property, get_networks_of_type): Return NULL.

	* test/nmclienttest.c (get_device_name, get_active_device): Return
	NULL.

	* src/backends/NetworkManagerRedHat.c (nm_system_device_stop_dhcp): Just
	use strlen, fgets always NULL-terminates the string.

	* src/NetworkManagerDbus.c (nm_dbus_nmi_filter,
	dbus_message_get_member): Remove /* in comment.

	* src/NetworkManagerUtils.c (LOCKING_DEBUG): Ditto.

	* src/NetworkManager.c (quit): Unused, delete.
	(nm_data_free): Cast arg to GFunc.

	* panel-applet/NMWirelessAppletDbus.c: Need to include
	string.h, and dbus-glib-lowlevel.h (the latter is needed
	for dbus_connection_setup_with_g_main at present).
	(nmwa_dbus_update_wireless_network_list): Parenthesize
	assignment in conditional.
	(nmwa_dbus_worker): Return NULL.

	* panel-applet/NMWirelessApplet.c (nmwa_redraw)
	(nmwa_get_menu_pos, nmwa_toplevel_menu_activate)
	(nmwa_menu_add_text_item, nmwa_setup_widgets): Kill unused variables.
	(nmwa_populate_menu): Return NULL on failure, instead of just
	return;

	* initscript/NMLaunchHelper.c (g_timeout_add): Cast arg to GSourceFunc.

	* info-daemon/NetworkManagerInfoNetworksDialog.c (nmi_networks_dialog_init): Kill unused
	variables.

	* info-daemon/NetworkManagerInfo.c (nmi_print_usage): Unused,
	delete.
	
2004-08-29  Colin Walters  <walters@verbum.org>

	* src/NetworkManagerDbus.c (nm_dbus_get_network_timestamp): Return
	a GTimeVal instead of time_t.  This is easier to work with,
	since time_t may be a long or double, we don't know.

	* src/NetworkManagerDbus.h: Update prototype.
	
	* src/NetworkManagerAP.c (struct NMAccessPoint): Store a GTimeVal
	instead of time_t.
	(nm_ap_get_timestamp): Update to return GTimeVal.
	(nm_ap_set_timestamp): Update to take GTimeVal.
	
	* src/NetworkManagerDevice.c (nm_device_update_best_ap): Update
	to handle GTimeVal.

	* src/NetworkManagerAPList.c (nm_ap_list_update_network): Handle
	GTimeVal change.
	(nm_ap_list_print_members): Fix warnings in printf format.

2004-08-29  Colin Walters  <walters@verbum.org>
	
	* panel-applet/NMWirelessApplet.c: Include config.h.

2004-08-29  Colin Walters  <walters@verbum.org>

	* configure.in: Generate config.h.

	* configure.in: Dump dependency on OpenSSL; we can't
	use it since this package is GPL:
	http://www.gnome.org/~markmc/openssl-and-the-gpl.html
	Instead, check for libgcrypt, use it if available,
	otherwise use included MD5 code.

	* src/gnome-keyring-md5.h, src/gnome-keyring-md5.c:
	Suck in from gnome-keyring, munge a bit.
	
	* src/Makefile.am (NetworkManager_SOURCES) <!WITH_GCRYPT>: Include
	gnome-keyring-md5.h gnome-keyring-md5.c.
	(NetworkManager_LDADD) <WITH_GCRYPT>: Add dep on LIBGCRYPT_LIBS.

	* src/NetworkManagerWireless.c (nm_md5): New function, uses
	libgcrypt or included gnome-keyring md5 bits.
	(nm_wireless_128bit_key_from_passphrase): Use nm_md5.

2004-08-28  Kjartan Maraas  <kmaraas@gnome.org>

	* configure.in: Add «nb» and «no» to ALL_LINGUAS.

2004-08-27  Bryan Clark  <bclark@redhat.com>

	* examples/python/systray/Makefile: 

	Updated the clean section
	
	* examples/python/systray/trayiconmodule.c: 
	* examples/python/systray/trayicon.override: 
	* examples/python/systray/network_tray.py: 
	* examples/python/systray/eggtrayicon.h: 
	* examples/python/systray/eggtrayicon.c: 
	* examples/python/systray/Makefile: 
	* examples/python/README: 
	* examples/python/NetworkManager.py: 
	* examples/python/NMTester.py: 

	Initial commit of these python example files

Fri Aug 28 2004 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Make current device bold
		- Show more user-friendly device name if we got one from hal

	* panel-applet/NMWirelessAppletDbus.c
		- Grab "info.product" key from hal for network devices
		- Cache the current active device

2004-08-27  Adam Weinberger  <adamw@gnome.org>

	* configure.in: Added en_CA to ALL_LINGUAS.

2004-08-27  Christian Rose  <menthos@menthos.com>

	* configure.in: Added "sv" to ALL_LINGUAS.

Thu Aug 26 2004 Dan Williams <dcbw@redhat.com>

	* Tag NetworkManager-0.2

Thu Aug 26 17:23:16 2004  Jonathan Blandford  <jrb@redhat.com>

	* initscripts/Makefile.am
	* configure.in: Make pass distcheck

	* po/ChangeLog: added

Thu Aug 26 2004 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Remove debugging code
		- Enable device switching from menus

	* panel-applet/NMWirelessAppletDbus.[ch]
		- Method for asking NM to switch devices

	* src/NetworkManagerDevice.c
		- Set dev->activating earlier, avoids race between
			the dbus signal of "DeviceActivating" and setting
			dev->activating (which is what NM's "status" method call
			looks at)

Thu Aug 26 2004 Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
		- Rework menu code to add devices to menu, and to show
			signal strength for each access point.  Code cleanups
			too.

	* panel-applet/NMWirelessAppletDbus.c
		- Grab network devices from NetworkManager too
		- Grab quality information from NM for wireless networks

	* src/NetworkManagerDbus.[ch]
		- Add dbus methods for getting the HAL UDI from a device and
			for getting its base quality, if its wireless
		- Consolidate some functions (wireless network notifications,
			device notifications)
		- Add method for requesting NM to use a particular device

	* src/NetworkManager.c
		- Change for function consolidations from NetworkManagerDbus.c
		- Implement active device locking and user-requested devices
			(ie, tell NM to use a particular device instead of the one
			it autochose)

	* src/NetworkManagerDevice.c
		- Add method for getting the base quality of a device, if its
			wireless
		- Grab device base quailty info from iwlib during scans

	* src/NetworkManagerPolicy.c
		- Use a user-requested device rather than the auto-chosen device
			if we are told to

Thu Aug 26 15:12:36 2004  Jonathan Blandford  <jrb@redhat.com>

	* Makefile.am: add po as a supdir

	* autogen.sh: use gnome-autogen.sh

	* initscript/Gentoo/.cvsignore:
	* initscript/RedHat/.cvsignore: Shut up cvs

	* panel-applet/Makefile.am: Define GNOMELOCALEDIR for bonobo.

	* panel-applet/NMWirelessApplet.c: (nmwa_populate_menu),
	(nmwa_fill): Use gettext.

	* configure.in: add gettext support
	* po/.cvsignore:
	* po/NetworkManager.pot:
	* po/POTFILES.in:

2004-08-26  Seth Nickell  <seth@gnome.org>

	* panel-applet/NMWirelessApplet.c: (nmwa_destroy),
	(nmwa_menu_item_activate), (nmwa_toplevel_menu_activate),
	(nmwa_add_menu_item), (nmwa_menu_item_data_free),
	(nmwa_dispose_menu_items), (nmwa_populate_menu),
	(nmwa_setup_widgets), (do_not_eat_button_press), (nmwa_new):
	* panel-applet/NMWirelessApplet.h:

	Use a menu bar instead of a button for the main clickable
	thingy.
	
2004-08-25  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDevice.c
		- (nm_device_set_enc_key): always set device to "open" mode instead of
			turning encryption off, because the Cisco driver doesn't associate
			with WEP-enabled access points unless we are in "open"

2004-08-25  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerWireless.c
		- Don't try to defererence blank passphrases

2004-08-25  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Rebuild the menu whenever a user clicks

2004-08-25  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- (nmwa_udpate_state): Set panel icon to "wired" (for lack of better ones)
			when NM isn't around or when its not connected

	* src/NetworkManagerDevice.c
		- (nm_device_activation_worker): Make sure to reset dev->activating if we get
			canceled.

2004-08-25  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessAppletDbus.c
		- (nmwa_dbus_get_bool, nmwa_dbus_get_network_encrypted): correct method name
			for getting encryption, and don't stop on "val" once we've gotten it
			from NetworkManager.  Short form:  encryption should now show up.

2004-08-25  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Set ESSID on a gconf trusted network too when force-setting the wireless
			network to associate with

2004-08-25  Dan Williams <dcbw@redhat.com>

	* panel-applet/*
		- Rework the panel applet to do all DBUS communication in a separate
			thread

2004-08-25  Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.[ch]
		- Remove "get_next_priority" function

	* info-daemon/NetworkManagerInfoDbus.[ch]
		- Convert "priority" functions to "timestamp"

2004-08-25  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerAP.[ch]
		- Add a "enc_method_good" member and accessors to an Access Point
			to signal when we've found the correct encryption method
			for an access point
		- Add a "timestamp" member and accessors, remove "priority" member
			and accessors (use timestamps instead)
		- Rename "wep_key"->"enc_key"
		- (nm_ap_get_enc_key_hashed): new, return the correct mangled key
			for a specified encryption method using the access points
			source encryption key/passphrase

	* src/NetworkManagerAPList.c
		- When updating a network with dbus, grab timestamp now instead of
			priority

	* src/NetworkManagerDBus.[ch]
		- Add signal for "DeviceActivating"
		- Switch priority->timestamp

	* src/NetworkManagerDevice.c
		- Change references of "wep_key" -> "enc_key" or "key"
		- Signal DeviceActivating when starting activation
		- When activating a wireless device, if the access point we are connecting
			to is encrypted, and we have a source key, try to generate a mangled
			key and use that (ie, generate real WEP key from a passphrase)
		- Rework device activation to fallback to other encryption methods if
			a previous one didn't work (ie, try mangling a key as a 104-bit passphrase
			first, then if that doesn't work fall back to direct hex key).
		- (nm_device_update_best_ap): fix a deadlock, and use timestamps instead of
			priority.  We now prefer the latest access point used, rather than using
			a priority scheme
		- (nm_device_do_normal_scan): make the encryption method "unknown" on access
			points we've just discovered, and merge in correct info from the global
			access point lists

2004-08-25  Seth Nickell  <seth@gnome.org>

        Patch from Matthew Garrett <mjg59@srcf.ucam.org> for adding
	Debian support.
	
	* src/Makefile.am:
	* src/backends/NetworkManagerDebian.c: (nm_system_device_run_dhcp),
	(nm_system_device_stop_dhcp), (nm_system_device_flush_routes),
	(nm_system_device_flush_addresses), (nm_system_enable_loopback),
	(nm_system_delete_default_route),
	(nm_system_kill_all_dhcp_daemons), (nm_system_update_dns),
	(nm_system_load_device_modules):

2004-08-24  Dan Willemsen <dan@willemsen.us>

	* src/NetworkManager.c
	  src/backends/NetworkManagerGentoo.c
	  src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerSystem.h
		- Implement preliminary Gentoo support, adding a
			nm_system_init function to the backend specification

	* configure.in
		- Distribution auto-detection, lowercase any user-fed
			distribution names

	* initscript/.cvsignore
	  initscript/Makefile.am
	  initscript/RedHat/Makefile.am
	  initscript/RedHat/NetworkManager
	  initscript/Gentoo/Makefile.am
	  initscript/Gentoo/NetworkManager
		- Refactored initscript code separately for each
			distribution

2004-08-23  Dan Williams <dcbw@redhat.com>

	* configure.in
	  src/Makefile.am
	  src/NetworkManagerDevice.c
	  src/NetworkManager.c
	  src/NetworkManagerUtils.[ch]
	  src/backends/NetworkManagerSystem.h
	  src/backends/NetworkManagerRedHat.c
	  src/backends/NetworkManagerGentoo.c
		- Refactor system-specific code into separate backends for
			each distribution

2004-08-23  Dan Willemsen <dan@willemsen.us>

	* dispatcher-daemon/NetworkManagerDispatcher.c
	  info-daemon/NetworkManagerInfo.[ch]
	  info-daemon/NetworkManagerInfoDbus.c
	  info-daemon/NetworkManagerInfoPassphraseDialog.c
	  src/NetworkManager.c
	  src/NetworkManagerAP.c
	  src/NetworkManagerAPList.c
	  src/NetworkManagerDbus.c
	  src/NetworkManagerDevice.c
	  src/NetworkManagerPolicy.c
	  src/NetworkManagerUtils.[ch]
	  src/NetworkManagerWireless.c
		- Used syslog functions for logging instead of NM_DEBUG_DISPLAY & fprintf

	* src/NetworkManager.c
		- Fixed usage wording for --no-daemon

2004-08-23  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.c
		- Update our state every second to get more responsive panel icon
		- (nmwa_update_state): remove bogus applet->pix_state = PIX_WIRED that
			was causing our marching ants status blips to never move when
			looking for a wireless network

	* src/NetworkManagerDevice.c
		- (nm_device_activation_begin): return if activation has already begun
		- (nm_device_do_normal_scan): merge WEP key and priority from the
			trusted/preferred network into the device's access point when the
			scan list is processed

2004-08-23  Dan Williams <dcbw@redhat.com>

	* initscript/NetworkManager
		- Use NMLaunchHelper rather than sleeping

	* initscript/NMLaunchHelper.c
	  Makefile.am
		- Add helper program that exits only when NM activates a device,
			or 10 seconds have passed, whichever happens first.  This
			stops the boot processes until we have a network connection,
			which NM can't do because it daemonizes and brings the connection
			up in the background.  Allows stuff like NFS to not die.

2004-08-20  Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoPassphraseDialog.c
		- (nmi_passphrase_dialog_ok_clicked): when updating the wep key
			for a network, set the essid as well since it may not exist yet
		- (nmi_passphrase_dialog_init): don't star out the passphrase field,
			since WEP keys/passphrases are long and prone to entry-error

	* panel-applet/Makefile.am
	  panel-applet/wired.png
		- Add (pulled from system-config-network temporarily)

	* panel-applet/NMWirelessApplet.[ch]
		- Show wired picture when a wired connection is used
		- Rename wireless icon enums, adding WIRELESS

	* src/NetworkManagerDevice.c
		- (nm_device_activate_wireless): unset encryption before bringing
			down the card and setting the essid
		- (nm_device_activatin_worker): request a key from the user if the
			AP we are connecting to is encrypted but we don't have a key
			for it yet
		- (nm_device_set_user_key_for_network): fix missing '== 0' for a
			strcmp() that prevented a user-entered key from actually getting
			used

2004-08-16  Dan Williams <dcbw@redhat.com>

	* initscript/NetworkManager
		- Check for /sbin/ip
		- Do sysctl magic that network service does
		- sleep 4s after start to allow network time to come up [hack]

	* src/Makefile.am
	  src/NMLoadModules
		- Load all network device kernel modules (hal doesn't know devices
			are ethernet until the module is loaded, and therefore we don't know)

	* src/NetworkManager.c
		- (main): daemonize later, launch NMLoadModules to alert HAL of our
			network devices, and bring up the loopback device explicitly

	* src/NetworkManagerUtils.[ch]
		- (nm_enable_loopback): new function

2004-08-13  Dan Williams <dcbw@redhat.com>

	* configure.in
	  panel-applet/Makefile.am
		- Fix up cleanfiles and server_DATA/server_in_files

	* README
		- Update with some comments on theory of operation

	* CONTRIBUTING
	  Makefile.am
		- Add CONTRIBUTING

2004-08-12  Dan Williams <dcbw@redhat.com>

	* info-daemon/passphrase.glade
		- Set window title to " "

	* panel-applet/Makefile.am
	  panel-applet/keyring.png
		- Deliver to correct place

	* panel-applet/NMWirelessApplet.[ch]
		- Add comments
		- Remove applet->have_active_device as its no longer used
		- (nmwa_load_theme): load keyring.png too
		- (error_dialog): remove
		- (show_warning_dialog): subsume functionality of error dialog too
		- (nmwa_destroy, nmwa_new): create and dispose of an application-wide GConfClient
		- (nmwa_handle_network_choice): add to deal with user clicking on an item from
			the networks menu
		- (nmwa_menu_item_activated): GtkMenuItem "activate" signal handler
		- (nmwa_button_clicked, nmwa_setup_widgets): create and populate the menu on startup
			and when we get broadcasts of changed wireless access points only, not when the
			user clicks on the button to display the menu (too long of a wait)
		- (nmwa_add_menu_item): Make active network bold, and place a keyring icon beside
			networks that are encrypted
		- (nmwa_dispose_menu, nmwa_menu_item_data_free): dispose of the data we place on each
			menu item with g_object_set_data()

	* panel-applet/NMWirelessAppletDbus.[ch]
		- (nmwa_dbus_get_bool): add method to return boolean value from dbus message
		- (nmwa_dbus_get_active_network): add (nmwa_dbus_get_string() wrapper to get active network)
		- (nmwa_dbus_add_networks_to_menu): clean up, only show one instance of each ESSID in the menu
		- (nmwa_dbus_set_network): force NetworkManager to use a particular network for wireless cards
		- (nmwa_dbus_init, nmwa_dbus_filter): Trap network appear/disappear and device
			activation/deactivation signals and rebuild the menu when they happen

	* src/NetworkManager.c
		- (main): use new nm_spawn_process() rather than system()

	* src/NetworkManagerDbus.c
		- (nm_dbus_devices_handle_request): don't compare AP structure addresses directly, but essids
			instead.  Since we can now force best_aps to stick around, the AP structure to which
			dev->options.wireless.best_ap points to won't necessarily be in the device's device list
			if a scan has happened since the best_ap was frozen.  Also add "setNetwork" method
			to freeze the best_ap.

	* src/NetworkManagerDevice.[ch]
		- (nm_device_activation_worker): Use new nm_spawn_process() call rather than system()
		- (nm_device_*_best_ap): add freeze/unfreeze/get_frozen functions, and don't really update
			the best_ap in nm_device_update_best_ap() if the best_ap is frozen AND in the device's
			ap list

	* src/NetworkManagerUtils.[ch]
		- (nm_spawn_process): add replacement for system() usage

2004-08-11  Dan Williams <dcbw@redhat.com>

	* panel-applet/NMWirelessApplet.[ch]
		- Fix up copyright and credits to include Bastien and Eskil,
			who created the gnome-applets wireless applet, from whose
			skeleton this one was created
		- Rework nmwa_update_state()/nmwa_draw() so that state and which
			pixmap to draw is computed during nmwa_update_state()
		- Applet now shows itself all the time due to panel packing issues
			which caused the applet to previously never come back after hiding.
			When a wired device is the active device, the applet shows "not connected"

	* panel-applet/NMWirelessAppletDbus.[ch]
		- Clean up error messages and show what function they are from
		- nmwa_dbus_get_active_wireless_device()->nmwa_dbus_get_active_device()
		- Add new device type getters, and a status getter

	* src/NetworkManagerDbus.c
		- (nm_dbus_devices_handle_request): Don't return an active network unless that
			network is actually in the device's ap list
		- (nm_dbus_nm_message_handler): Fix silly mistake returning status

	* src/NetworkManagerDevice.c
		- (nm_device_update_best_ap): If the best AP is NULL, clear out the ESSID of the
			card

	* test/nmclienttest.c
		- Report status of NetworkManager too

2004-08-11  Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.c:
		- (main): clean up Seth's code style

	* info-daemon/NetworkManagerInfoDbus.c:
		- Use the more aptly-named path/service/interface constants from NetworkManager
		- Don't return empty strings ("") as object paths ever, instead return errors

	* panel-applet/NMWirelessApplet.c:
		- Clean up Seth's code style

	* src/NetworkManager.[ch]
		- (nm_remove_device_from_list): remove anything having to do with pending_device
		- (main, nm_print_usage): change --daemon=[yes|no] -> --no-daemon

	* src/NetworkManagerAPList.[ch]
		- Move Iter struct right above the iter functions to preserve opacity
		- (nm_ap_list_remove_ap): implement
		- (nm_ap_list_update_network): deal with errors returned from nm_dbus_get_network_priority(),
			remove AP if NetworkManagerInfo doesn't know anything about it
		- (nm_ap_list_diff): user NMAPList iterators
		- (nm_ap_list_print_members): implement debugging function

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_nm_get_active_device): remove anything to do with pending_device
		- (nm_dbus_get_user_key_for_network): remove DBusPendingCall stuff (unused),
			and move the actual key setting stuff into NetworkManagerDevice.c
		- (nm_dbus_get_network_priority): return -1 now on errors
		- (nm_dbus_nmi_filter): fix strcmp() error that caused PreferredNetworkUpdate signals to
			get lost, and force the active device to update its "best" ap when AP lists change
		- (nm_dbus_nm_message_handler): Update conditions for returning "connecting" for a "status"
			method call due to pending_device member removal

	* src/NetworkManagerDevice.[ch]
		- Move NMDevice structure to the top
		- Add a wireless scan mutex and a best_ap mutex to the Wireless Options structure
		- Remove Pending Action stuff from everywhere
		- (nm_device_activation_*): We now "begin" activation and start a thread to do the
			activation for us.  This thread blocks until all conditions for activation have
			been met (ie for wireless devices, we need a valid WEP key and a "best" ap), and
			then setup up the interface and runs dhclient.  We have to do this because there
			is no guaruntee how long dhclient takes, and while we are blocking on it, we cannot
			run our main loop and respond to dbus method calls or HAL device removals/inserts
		- (nm_device_set_user_key_for_network): Move logic here from NetworkManagerDbus.c so we
			can tell nm_device_activation_worker() that we've got a key
		- (nm_device_*_best_ap): lock access to best_ap member of Wireless Options structure
		- (nm_device_get_path_for_ap): dumb it down so the list doesn't lock against itself when
			diffing (AP appear/disappear signal functions make sure the AP is actually in the device's list)
		- (nm_device_update_best_ap): move logic from nm_wireless_is_ap_better() here

	* src/NetworkManagerPolicy.c
		- Remove anything to do with pending_device
		- Adjust device activation to deal with activation-in-worker-thread

	* src/NetworkManagerUtils.c
		- Clean up locking debugging a bit

	* src/NetworkManagerWireless.[ch]
		- (nm_wireless_is_ap_better): remove, stick logic in nm_device_update_best_ap().  This function
			was badly named and is better as a device function

	* panel-applet/.cvsignore: add

2004-08-09  Seth Nickell  <seth@gnome.org>

	* panel-applet/NMWirelessApplet.c: (nmwa_timeout_handler),
	(nmwa_button_clicked), (nmwa_populate_menu), (nmwa_setup_widgets),
	(nmwa_new):
	* src/NetworkManagerDbus.c: (nm_dbus_nmi_filter):

	Don't load the menus until clicked on (also removes a call outside
	normal code paths at first load).

	Hide applet when NM is not present.
	
	Improve printf debugging stuff.
	
2004-08-09  Dan Williams <dcbw@redhat.com>

	* dispatcher-daemon/NetworkManagerDispatcher.c:
		- Covert uses of dbus_message_iter_* over to dbus_message_get_args
		- Use constants for NetworkManager interface, service, and path

2004-08-09  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDbus.c:
		- (nm_dbus_nm_get_active_device, nm_dbus_nm_get_devices): Never return an empty object path,
			instead return an error message
		- (nm_dbus_devices_handle_request): Return error when getActiveNetwork/getNetworks is called
			on a wired device.  Also never return an empty object path, instead return an error message

2004-08-06  Seth Nickell  <seth@gnome.org>

	* panel-applet/NMWirelessApplet.c: (nmwa_new):

	Check the error code when getting a connection.
	
	* panel-applet/NMWirelessAppletDbus.c: (nmwa_dbus_init):

	Check if the NM service exists when initializing (rather than
	assuming it does not).
	
	* src/NetworkManagerDbus.c: (nm_dbus_init):

	Don't acquire the well-known service name until we have
	registered object/path handlers and can actually receive
	calls.
	
2004-08-06  Dan Williams <dcbw@redhat.com>

	* panel-applet/*
		- Add panel applet

	* src/NetworkManagerPolicy.c
	  src/NetworkManager.c
		- Get access point lists from NetworkManagerInfo on-demand,
			and look for ServiceCreate/ServiceDeleted signals to see when
			we should query NMI for lists
	* src/NetworkManagerAPList.c
		- Make sure to init the list's mutex
		- Convert traversals of the list over to the list iter functions

	* src/NetworkManagerDbus.[ch]
		- Use more aptly-named path/service/interface constants
		- Treat both active and pending devices the same for "getActiveDevice"
		- Add a "status" method returning "connected", "connecting", or "disconnected"

	* src/NetworkManagerDevice.c
		- Honor "ignored" network list when picking best ap to use

2004-08-06  Seth Nickell  <seth@gnome.org>

	* aclocal.m4:

	Autogenerated, remove from CVS.
	
	* autogen.sh:

	Don't hardcode automake version.
	
	* configure.in:
	* info-daemon/Makefile.am:
	* info-daemon/NetworkManagerInfo.c: (main):

	Use GnomeProgram et al. for doing session management.
	Use popt stuff for argument parsing rather than doing
	it manugally.
	
2004-08-05  Dan Williams <dcbw@redhat.com>

	* test/nminfotest.c
		- Update to new NMI dbus API, check different network types

	* info-daemon/NetworkManagerInfoDbus.c
		- Update to new NM dbus API, ie network type sent in query message

2004-08-05  Dan Williams <dcbw@redhat.com>

	* An assload of changes

2004-08-02  Dan Williams <dcbw@redhat.com>

	* TODO
		- new task: proper logging support

	* info-daemon/NetworkManagerInfo.c
		- Correct spelling of "canceled"
		- Correct casting of objects for g_signal_connect()

	* info-daemon/NetworkManagerInfoDbus.c
		- Add defines for NetworkManager namespace and object path, and use them
		- Add filter function to trap new signals from NetworkManager:
			WirelessNetworkAppeared, WirelessNetworkDisappeared

	* info-daemon/passphrase.glade
		- Change name of "ok" button to "Login to Network..."
		- Mark invisible

	* src/NetworkManager.c
		- Code and debug message cleanups
		- Rename "nm_add_current_devices"->"nm_add_initial_devices"
		- (nm_add_initial_devices) Check returned string array of devices
			and don't try to add devices if array is NULL
		- (main) Initialize libhal a bit later, make code a bit clearer

	* src/NetworkManagerAP.[ch]
		- New accessor and data member "matched": used to speed up AP list
			diffing
		- New accessor and data member "enc_method": will be used during key
			fallback to cache which passphrase->key conversion actually works
			so we don't have to do it every time

	* src/NetworkManagerAPList.[ch]
		- (nm_ap_list_find_ap_in_list) New: find an AP by essid in an AP list
		- (nm_ap_list_diff) New: given two lists of access points, find the differences
			between them, and send WirelessNetworkAppeared/Disappeared signals over
			dbus in response to those differences

	* src/NetworkManagerDbus.[ch]
		- (nm_dbus_get_object_path_from_ap) New: given a device and an access point,
			make an object path for that access point (NOTE that we don't yet check to
			make sure that access point is actually in the device's AP list yet)
		- (nm_dbus_get_ap_from_object_path) Renamed from nm_dbus_get_network_from_object_path
		- (nm_dbus_signal_wireless_network_appeared, nm_dbus_signal_wireless_network_disappeared)
			New: signal appearance/disappearance of wireless networks
		- (nm_dbus_set_user_key_for_network) Mark the network/ap as invalid if the user cancelled
			key entry

	* src/NetworkManagerDevice.[ch]
		- (nm_device_ap_list_clear) Use nm_ap_list_free rather than doing it ourselves
		- (nm_device_ap_list_get) New: return the AP list (static function)
		- (nm_device_do_normal_scan) Destroy old AP list later, so that we can diff the
			new one resulting from the scan with the old one

	* src/NetworkManagerWireless.c
		- (nm_wireless_is_most_prefered_ap) "invalid" access points cannot be "best" access points

	* test/nminfotest.c
		- #define object paths and namespaces and use the #defines rather than static strings
		- Test out user-key functionality of NetworkManagerInfo too

2004-07-29  Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfoDbus.c
	  src/NetworkManagerDbus.c
		- Update to current DBus (ie don't use decomposed paths when registering
			object paths/fallbacks)

2004-07-27  Dan Williams <dcbw@redhat.com>

	* Remove various Makefile.in files

	* TODO
		- Add some more items

	* configure.in
		- Add checks for OpenSSL/md5 headers and libs

	* src/Makefile.am
		- Use OpenSSL CFLAGS

	* src/NetworkManagerAP.[ch]
		- Remove 'stamp' functions, replace with 'invalid' functions
			to support user cancelling WEP key entry

	* src/NetworkManagerDbus.c
		- Remove 'stamp' return functions
		- Treat returned user key as a passphrase and convert to a WEP key,
			but don't actually use the WEP key yet.  We use the returned user
			key as a hexadecimal WEP key until we can figure out a UI for
			passphrase-vs-hex key

	* src/NetworkManagerWireless.[ch]
		- Add passphrase-to-128bit-key function

2004-07-27  Dan Williams <dcbw@redhat.com>

	* TODO
		- Add a couple of items

2004-07-27  Dan Williams <dcbw@redhat.com>

	* info-daemon/NetworkManagerInfo.c
		- Update allowed network's GConf key when user enters a WEP key explicitly

	* info-daemon/NetworkManagerDbus.c
		- Fix some comments
		- nmi_dbus_get_allowed_networks(): kill warning

2004-07-27  Dan Williams <dcbw@redhat.com>

	* initscript/Makefile.in
		- Remove

	* initscript/Makefile.am
		- Add correct rules to install the init.d initscript

	* info-daemon/NetworkManagerInfoDbus.c
		- Remove debug fprintf

	* src/NetworkManagerDbus.[ch]
		- Remove debug fprintfs
		- Add macros for NetworkManagerInfo object path/namespace
		- Use said macros instead of constant strings

2004-07-27  Dan Williams <dcbw@redhat.com>

	* initscript/.cvsignore
		- Add

	* info-daemon/Makefile.am
		- Install .glade files and keyring.png
		- Fix stupid omission of a \ that caused half the flags not to be
			passed to gcc

	* info-daemon/NetworkManagerInfo.c
		- gtk_signal_connect->g_signal_connect
		- Alert NetworkManagerInfo to new glade file location

2004-07-27  Dan Williams <dcbw@redhat.com>

	* test/nmclienttest.c
	  test/nminfotest.c
		- Add missing <dbus/dbus.h> headers
		- Add GPL message at top

2004-07-27  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerAPList.[ch]
	  src/Makefile.am
		- Add.  Deal with allowed network list additions, deletions, and updates

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- Add missing <dbus/dbus.h> header

	* info-daemon/NetworkManagerInfo.[ch]
		- Add missing <dbus/dbus.h> header
		- Implement the GConf notify callback to signal NetworkManager of an allowed
			network change
		- Better error checking

	* info-daemon/NetworkManagerInfoDbus.[ch]
		- Add missing <dbus/dbus.h> header
		- Convert to using dbus_message_append_args/dbus_message_get_args
		- Implement nmi_dbus_signal_update_allowed_network() to signal NetworkManager
			that an allowed network changed.  We don't want to signal on individual
			keys _inside_ an allowed network really, just want NM to query the info
			daemon for updated info on all keys.
		- Better error checking

	* src/NetworkManager.[ch]
		- Add missing <dbus/dbus.h> header
		- Move allowed_ap_list free functions to NetworkManagerAPList.[ch]
		- Zero out NMData structure on free
		- No longer use a thread for allowed_ap_list updating, instead its now done
			through dbus queries against NetworkManagerInfo
		- Populate allowed_ap_list initially before adding existing network devices
			to the device list, so wireless devices can get their "best" AP

	* src/NetworkManagerDbus.[ch]
		- Convert to using dbus_message_append_args/dbus_message_get_args
		- Better error checking
		- Implement Allowed Network info functions to request allowed network
			info from NetworkManagerInfo
		- Implement the filter function to process signals from NetworkManagerInfo
			about changing allowed networks

	* src/NetworkManagerDevice.c
		- Fix file descriptor leak in nm_device_update_ip4_address()

2004-07-27  Dan Williams <dcbw@redhat.com>

	* .cvsignore
	  src/.cvsignore
	  test/.cvsignore
	  dispatcher-daemon/.cvsignore
	  info-daemon/.cvsignore
		- Add .cvsignore files to reduce noise when diffing

2004-07-24  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.[ch]
	  src/NetworkManagerDbus.[ch]
	  src/NetworkManagerDevice.[ch]
	  src/NetworkManagerPolicy.c
	  src/NetworkManagerWireless.[ch]
		- Add many more g_return_if_fail()/g_return_val_if_fail() checks
		- Pass the NMData application data structure through all calls
			that need it so we can get rid of nm_get_global_data()
		- Change deallocation of the allowed_ap_list GSList in preparation
			for not completely clearing it every time we get an update,
			but instead getting incremental updates via GConf/dbus

2004-07-22  Dan Williams <dcbw@redhat.com>

	* configure.in
		- Add checks for GConf libs & headers & flags

	* info-daemon/Makefile.am
		- Add GConf flags & libs to compile/link stages of NetworkManagerInfo

	* info-daemon/NetworkManagerInfo.[ch]
		- Don't use gquarks for data storage, just use normal data storage
		- Add gconf bits to watch /system/networking/wireless/allowed_networks

	* info-daemon/NetworkManagerDbus.[ch]
		- Add method call for getting allowed networks
		- Add method calls for getting an allowed network's essid, priority, and key
		- Hook the method calls up to GConf
		- Split user key dialog code into separate function (nmi_dbus_get_key_for_network)
		- nmi_dbus_nmi_message_handler(): make sure to unref the reply message after sending
		
	* src/NetworkManagerDbus.[ch]
		- Switch for enumeration of networks to using essid instead

	* test/Makefile.am
	  test/nminfotest.c
	  	- Add test program for NetworkManagerInfo

2004-07-19  Dan Williams <dcbw@redhat.com>

	* src/NetworkManagerDbus.c
		- Switch from indexed device paths to names.  Less code, more efficient.
			ie "/org/freedesktop/NetworkManager/0" -> "/org/freedesktop/NetworkManager/eth0"

2004-07-19  Dan Williams <dcbw@redhat.com>

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- (nm_dbus_filter): Remove obsolete response to NeedKeyForNetwork signal

2004-07-19  Dan Williams <dcbw@redhat.com>

	* Makefile.am
		- Add info-daemon directory

	* configure.in
		- Check for glade libs and headers
		- Add info-daemon directory

	* src/NetworkManagerAP.c
		- nm_ap_new_from_ap(): Fix bug that resulted in an APs encryption status not getting
			copied over to the new AP.

	* src/NetworkManagerDbus.c
	  src/NetworkManagerDbus.h
		- Deal with nm_device_ap_list_get_ap()->nm_device_ap_list_get_ap_by_index() change
		- Remove nm_dbus_signal_need_key_for_network()
		- Add disabled code for asynchronous user wep key callbacks
		- Add functions for getting, setting, and cancelling user key operations
		- Remove "setKeyForNetwork" device dbus method call, its on NetworkManager object instead
		- Add "setKeyForNetwork" dbus method call on NetworkManager object

	* src/NetworkManagerDevice.c
	  src/NetworkManagerDevice.h
		- nm_device_update_link_active(): revert changes for wireless link detection, the WEP-key-is-wrong
			logic is in device activation now
		- nm_device_activate(): for wireless devices, if we can't associate with access point (perhaps
			key is wrong) trigger get-user-key pending action
		- Implement get-user-key pending action stuff, tie to dbus messages
		- Rename nm_device_ap_list_get_ap() -> nm_device_ap_list_get_ap_by_index()
		- Add nm_device_ap_list_get_ap_by_essid()
		- Instead of copying "best" access points, ref them instead so that the key we set
			sticks around

	* src/NetworkManagerPolicy.c
		- Deal with wrong WEP key, but right access point (and if so, return link_active = TRUE)
		- Don't cancel pending actions on a device if its the same device as last iteration
		- Only promote pending_device->active_device if activation was successfull

	* src/Makefile.am
		- Rename nmclienttest->nmtest

	* info-daemon/Makefile.am
	  info-daemon/NetworkManagerInfo.c
	  info-daemon/NetworkManagerInfo.h
	  info-daemon/NetworkManagerInfoDbus.c
	  info-daemon/NetworkManagerInfoDbus.h
	  info-daemon/passphrase.glade
	  info-daemon/NetworkManagerInfo.conf
	  info-daemon/keyring.png
	  	- Import sources for info-daemon, which pops up dialog for passphrase/key when
	  		NetworkManager asks for it, and also will (soon) provide "allowed" access point
	  		lists to NetworkManager by proxying user's GConf
	  

2004-07-15  Dan Williams <dcbw@redhat.com>

	* src/Makefile.am
		- Turn on warnings

	* src/NetworkManager.c
		- nm_create_device_and_add_to_list(): call nm_device_deactivate() rather
			that doing the deactivation ourselves
		- Cancel an pending actions on a device if its being removed
		- Break up link state checking a bit, make non-active wireless cards
			deactivated to save power
		- Remove unused variables

	* src/NetworkManager.h
		- Add support for "pending" device

	* src/NetworkManagerAP.h
	  src/NetworkManagerAP.c
		- Add support for determining whether and AP has encryption enabled or not
		- AP address is now "struct ether_addr" rather than a string

	* src/NetworkManagerDbus.h
	  src/NetworkManagerDbus.c
		- Add signal NeedKeyForNetwork, method SetKeyForNetwork (testing only)
		- Changes for AP address from struct ether_addr->string

	* src/NetworkManagerDevice.h
	  src/NetworkManagerDevice.c
		- Remove unused variables, fix warnings
		- Add support for Pending Actions (things that block a device from being "active"
			until they are completed).
		- First pending action:  Get a WEP key from the user
		- Add nm_device_is_wire[d|less](), rename nm_device_is_wireless()
		- Clean up explicit testing of dev->iface_type to use nm_device_is_wireless()
		- Update wireless link checking to try to determine if the AP we are associated
			with is correct, but the WEP key we are using is just wrong.  If its wrong,
			trigger the GetUserKey pending action on the device
		- If dhclient can't get an IP address, it brings the device down.  Bring it back
			up in that case, otherwise we can't scan or link-check on it
		- Add IP address change notifications at appropriate points (still needs some work)
		- Add nm_device_need_ap_switch(), checks whether we need to switch access points or not

	* src/NetworkManagerPolicy.h
	  src/NetworkManagerPolicy.c
		- Split out "best" access point determiniation into separate function
		- Make device activation 2-stage:  first the device is pending, then
			in the next iteration through it becomes "active" unless it has
			pending actions

	* src/NetworkManagerUtils.h
	  src/NetworkManagerUtils.c
		- Clean up unused variables and warnings
		- Wrap our debug macros in {} to prevent possible confusion

	* src/NetworkManagerWireless.c
		- Forgot to return current best priority, which lead to last available AP always
			being chosen no matter what its priority was.  Corrected.

2004-07-15  Dan Williams <dcbw@redhat.com>

	* dispatcher-daemon/Makefile.am
		- Turn on warnings

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- Remove unused variables due to warnings
		- Fix some comments
		- Print message on receipt of NeedKeyForNetwork signal (testing only)

2004-07-06  Dan Williams <dcbw@redhat.com>

	* src/NetworkManager.c
		- Add IPv4 address update for active device during link state check
		- Don't allow wireless cards to be powered up when they are not the
			active device

	* src/NetworkManagerDbus.c
	  src/NetworkManagerDbus.h
		- Add DBUS IPv4 address change signal
		- Add DBUS IPv4 address get method for devices

	* src/NetworkManagerDevice.c
		- Make setting the WEP key actually work
		- Move IP address get/set/update stuff here, per-device
		- Power down/bring down wireless device when deactivated
		- For scanning wireless devices, if first scan returned ENODATA, try again

	* src/NetworkManagerPolicy.c
		- Only set the WEP key for an allowed access point if there is one.
			We were setting it to be blank if one wasn't specified.

	* src/NetworkManagerUtils.h
	  src/NetworkManagerUtils.c
		- Move the IP address stuff to NetworkManagerDevice.c

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- Add device IPv4 address change notification stuff

2004-07-05  Dan Williams <dcbw@redhat.com>

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- A bit more descriptive state message
		- Don't segfault when reading directory

	* src/NetworkManager.h
		- Remove NMData desired_ap member, its now
			per-device rather than global

	* src/NetworkManager.c
		- Remove references to desired_ap
		- Move the allowed AP list refresh stuff into a thread

	* src/NetworkManagerDevice.c
	  src/NetworkManagerDevice.h
		- Each wireless device now has a "best ap"
		- Make device activate/deactivate functions per-device
		- Make wireless scanning per-device
		- Add IPv4 address discover functions, stub IPv6 ones
		- Move ethernet address validation functions to NetworkManagerUtils.c
		- Add wireless access point accessor function
		- Get/Set functions for "best ap"

	* src/NetworkManagerPolicy.c
		- Move activate/deactivate stuff into NetworkManagerDevice.c, per-device
		- Deal with per-device "best ap" rather than data->desired_apa
		- Implement allowed access point worker thread
		- Add nm_policy_essid_is_allowed() function

	* src/NetworkManagerUtils.c
	  src/NetworkManagerUtils.h
	  	- Add nm_ethernet_address_is_valid() function
		- Add IPv4/IPv6 address get functions

	* src/NetworkManagerWireless.c
	  src/NetworkManagerWireless.h
		- Move scanning stuff into NetworkManagerDevice.c, per-device

2004-06-29  Dan Williams <dcbw@redhat.com>

	* dispatcher-daemon/NetworkManagerDispatcher.c
		- Implement script callout functionality

2004-06-24  Dan Williams <dcbw@redhat.com>

	* NetworkManager.c
	    - Spacing cleanups
	    - Flush device routes and ip addresses when added to the device list

	* NetworkManagerDbus.c
	    - Spacing cleanups
	    - Add missing returns in the two signal functions
	
	* NetworkManagerPolicy.c
	    - Spacing and variable cleanups

2004-06-24  Dan Williams <dcbw@redhat.com>

	* Makefile.am
	  Makefile.in
	  configure.in
	  dispatcher-daemon/Makefile.am
	  dispatcher-daemon/Makefile.in
	  dispatcher-daemon/NetworkManagerDispatcher.c
	    - Add a daemon that receives signals from NetworkManager
			and will (eventually) call scripts in /etc/somewhere
			when devices go up or down.
	
	* NetworkManager.c
	    - Spacing cleanups
	    - Flush device routes and ip addresses when added to the device list

	* NetworkManagerDbus.c
	    - Spacing cleanups
	    - Add missing returns in the two signal functions
	
	* NetworkManagerPolicy.c
	    - Spacing and variable cleanups
	    - Rename nm_policy_switch_interface->nm_policy_switch_device
	    - nm_policy_switch_device():
				Use kill (pid) instead of system ("kill <pid>")
	    - nm_state_modification_monitor():
				Add wireless essid to output of debug statements
				Correct typo in device compare to switch or not (should be !=)
				Don't sleep after sending "no longer active" signal, was useless

2004-06-24  Dan Williams <dcbw@redhat.com>

	* Initial import
